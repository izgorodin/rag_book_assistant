2024-10-24 18:33:30,289 - httpx - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 18:33:30,289 - httpx - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 18:33:30,289 - httpx - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 18:33:30,290 - httpx - DEBUG - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 18:33:30,290 - httpx - DEBUG - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 18:33:30,290 - httpx - DEBUG - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 18:33:30,296 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 18:33:30,296 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 18:33:30,296 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 18:33:30,296 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 18:33:30,296 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 18:33:30,296 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 18:33:30,306 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 18:33:30,306 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 18:33:30,306 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 18:33:30,620 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 18:33:30,620 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 18:33:30,620 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 18:33:30,623 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 18:33:30,623 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 18:33:30,623 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 18:33:33,555 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 18:33:33,555 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 18:33:33,555 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 18:33:33,555 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 18:33:33,555 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 18:33:33,555 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 18:33:34,298 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 18:33:34,298 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 18:33:34,298 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 18:33:35,169 - root - INFO - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 18:33:35,169 - root - INFO - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 18:33:35,169 - root - INFO - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 18:33:35,169 - root - INFO - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 18:33:35,172 - root - INFO - Created 199 chunks
2024-10-24 18:33:35,172 - root - INFO - Created 199 chunks
2024-10-24 18:33:35,172 - root - INFO - Created 199 chunks
2024-10-24 18:33:35,172 - root - INFO - Created 199 chunks
2024-10-24 18:33:35,172 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 18:33:35,172 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 18:33:35,172 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 18:33:35,172 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 18:33:35,172 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 18:33:35,172 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 18:33:35,172 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 18:33:35,172 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 18:33:35,173 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 18:33:35,173 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 18:33:35,173 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 18:33:35,173 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 18:33:35,542 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 18:33:35,542 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 18:33:35,542 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 18:33:35,542 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 18:33:35,544 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 18:33:35,544 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 18:33:35,544 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 18:33:35,544 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 18:33:35,857 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 18:33:35,857 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 18:33:35,857 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 18:33:35,857 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 18:33:35,858 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 18:33:35,858 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 18:33:35,858 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 18:33:35,858 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 18:33:35,900 - tests.conftest - INFO - Test test_qa_system[qa_pair0] took 0.00 seconds
2024-10-24 18:33:35,900 - tests.conftest - INFO - Test test_qa_system[qa_pair0] took 0.00 seconds
2024-10-24 18:33:35,900 - tests.conftest - INFO - Test test_qa_system[qa_pair0] took 0.00 seconds
2024-10-24 18:33:35,900 - tests.conftest - INFO - Test test_qa_system[qa_pair0] took 0.00 seconds
2024-10-24 18:33:35,901 - tests.conftest - INFO - Test test_qa_system[\n    {\n        "question": "Who was the executive vice president of Ford who conceived the Pinto project?",\n        "answer": "Lee Iacocca",\n        "context": "Mr. Iacocca, then a Ford vice president, conceived the project and was its moving force."\n    },\n    {\n        "question": "What was the weight target for the Pinto set by Ford?",\n        "answer": "2,000 pounds",\n        "context": "Ford's objective was to build a car at or below 2,000 pounds to sell for no more than $2,000."\n    },\n    {\n        "question": "On what date did the accident involving Lily Gray and Richard Grimshaw occur?",\n        "answer": "May 28, 1972",\n        "context": "On May 28, 1972, Mrs. Gray, accompanied by 13-year-old Richard Grimshaw, set out in the Pinto from Anaheim for Barstow to meet Mr. Gray."\n    },\n    {\n        "question": "What was the speed of the Ford Galaxie at the moment of impact with the Pinto?",\n        "answer": "28 to 37 miles per hour",\n        "context": "The Galaxie had been traveling from 50 to 55 miles per hour but before the impact had been braked to a speed of from 28 to 37 miles per hour."\n    },\n    {\n        "question": "What factors influenced the placement of the fuel tank in the Ford Pinto?",\n        "answer": "Styling decisions that preceded engineering design",\n        "context": "The Pinto's styling, however, required the tank to be placed behind the rear axle leaving only 9 or 10 inches of 'crush space'--far less than in any other American automobile or Ford overseas subcompact."\n    },\n    {\n        "question": "How did Ford's crash tests reveal the Pinto's fuel system vulnerabilities?",\n        "answer": "Tests showed fuel tank punctures and fuel leakage at low speeds",\n        "context": "Mechanical prototypes struck from the rear with a moving barrier at 21 miles per hour caused the fuel tank to be driven forward and to be punctured, causing fuel leakage in excess of the standard prescribed by the proposed regulation."\n    },\n    {\n        "question": "What was the estimated cost to fix the Pinto's fuel tank design, and how did Ford justify not implementing it?",\n        "answer": "$6.40 per vehicle, justified by cost-benefit analysis",\n        "context": "The cost to remedy the defective design of the Pinto gas tank was estimated to be $6.40 per vehicle. Ford used a cost-benefit analysis to determine that it was cheaper to pay for potential lawsuits than to fix the design."\n    },\n    {\n        "question": "How did the court define 'malice' in the context of the Ford Pinto case?",\n        "answer": "Conscious disregard for the safety of others",\n        "context": "The court defined 'malice' as conduct evincing 'conscious disregard of the probability that the actor's conduct will result in injury to others.'"\n    },\n    {\n        "question": "What was the initial punitive damage award for Grimshaw, and how was it later modified?",\n        "answer": "$125 million, reduced to $3.5 million",\n        "context": "Grimshaw was awarded $2,516,000 compensatory damages and $125 million punitive damages; the Grays were awarded $559,680 in compensatory damages. On Ford's motion for a new trial, Grimshaw was required to remit all but $3 1/2 million of the punitive award as a condition of denial of the motion."\n    },\n    {\n        "question": "How did Ford's 'rush' development of the Pinto affect its safety design?",\n        "answer": "Styling preceded engineering, dictating design choices",\n        "context": "Pinto, however, was a rush project, so that styling preceded engineering and dictated engineering design to a greater degree than usual."\n    },\n    {\n        "question": "What evidence suggested that Ford was aware of the Pinto's safety issues before its release?",\n        "answer": "Crash test results and engineer testimonies",\n        "context": "Harley Copp, a former Ford engineer and executive in charge of the crash testing program, testified that the highest level of Ford's management made the decision to go forward with the production of the Pinto, knowing that the gas tank was vulnerable to puncture and rupture at low rear impact speeds."\n    },\n    {\n        "question": "How did the Pinto case impact the legal understanding of corporate responsibility and product liability?",\n        "answer": "Established precedent for punitive damages in product liability cases",\n        "context": "The case set a precedent for awarding punitive damages in product liability cases and highlighted the importance of corporate responsibility in product safety."\n    },\n    {\n        "question": "What was the significance of the 'crush space' in the Pinto's design, and how did it compare to other vehicles?",\n        "answer": "9-10 inches, less than other American cars",\n        "context": "The Pinto's styling, however, required the tank to be placed behind the rear axle leaving only 9 or 10 inches of 'crush space'--far less than in any other American automobile or Ford overseas subcompact."\n    },\n    {\n        "question": "How did Ford's internal memo about the cost-benefit analysis of safety improvements come to light during the trial?",\n        "answer": "Through the testimony of Harley Copp",\n        "context": "Harley Copp's testimony revealed the existence of Ford's internal cost-benefit analysis memo, which compared the cost of improvements to the potential costs of lawsuits from deaths and injuries."\n    },\n    ] took 0.00 seconds
2024-10-24 18:33:35,901 - tests.conftest - INFO - Test test_qa_system[\n    {\n        "question": "Who was the executive vice president of Ford who conceived the Pinto project?",\n        "answer": "Lee Iacocca",\n        "context": "Mr. Iacocca, then a Ford vice president, conceived the project and was its moving force."\n    },\n    {\n        "question": "What was the weight target for the Pinto set by Ford?",\n        "answer": "2,000 pounds",\n        "context": "Ford's objective was to build a car at or below 2,000 pounds to sell for no more than $2,000."\n    },\n    {\n        "question": "On what date did the accident involving Lily Gray and Richard Grimshaw occur?",\n        "answer": "May 28, 1972",\n        "context": "On May 28, 1972, Mrs. Gray, accompanied by 13-year-old Richard Grimshaw, set out in the Pinto from Anaheim for Barstow to meet Mr. Gray."\n    },\n    {\n        "question": "What was the speed of the Ford Galaxie at the moment of impact with the Pinto?",\n        "answer": "28 to 37 miles per hour",\n        "context": "The Galaxie had been traveling from 50 to 55 miles per hour but before the impact had been braked to a speed of from 28 to 37 miles per hour."\n    },\n    {\n        "question": "What factors influenced the placement of the fuel tank in the Ford Pinto?",\n        "answer": "Styling decisions that preceded engineering design",\n        "context": "The Pinto's styling, however, required the tank to be placed behind the rear axle leaving only 9 or 10 inches of 'crush space'--far less than in any other American automobile or Ford overseas subcompact."\n    },\n    {\n        "question": "How did Ford's crash tests reveal the Pinto's fuel system vulnerabilities?",\n        "answer": "Tests showed fuel tank punctures and fuel leakage at low speeds",\n        "context": "Mechanical prototypes struck from the rear with a moving barrier at 21 miles per hour caused the fuel tank to be driven forward and to be punctured, causing fuel leakage in excess of the standard prescribed by the proposed regulation."\n    },\n    {\n        "question": "What was the estimated cost to fix the Pinto's fuel tank design, and how did Ford justify not implementing it?",\n        "answer": "$6.40 per vehicle, justified by cost-benefit analysis",\n        "context": "The cost to remedy the defective design of the Pinto gas tank was estimated to be $6.40 per vehicle. Ford used a cost-benefit analysis to determine that it was cheaper to pay for potential lawsuits than to fix the design."\n    },\n    {\n        "question": "How did the court define 'malice' in the context of the Ford Pinto case?",\n        "answer": "Conscious disregard for the safety of others",\n        "context": "The court defined 'malice' as conduct evincing 'conscious disregard of the probability that the actor's conduct will result in injury to others.'"\n    },\n    {\n        "question": "What was the initial punitive damage award for Grimshaw, and how was it later modified?",\n        "answer": "$125 million, reduced to $3.5 million",\n        "context": "Grimshaw was awarded $2,516,000 compensatory damages and $125 million punitive damages; the Grays were awarded $559,680 in compensatory damages. On Ford's motion for a new trial, Grimshaw was required to remit all but $3 1/2 million of the punitive award as a condition of denial of the motion."\n    },\n    {\n        "question": "How did Ford's 'rush' development of the Pinto affect its safety design?",\n        "answer": "Styling preceded engineering, dictating design choices",\n        "context": "Pinto, however, was a rush project, so that styling preceded engineering and dictated engineering design to a greater degree than usual."\n    },\n    {\n        "question": "What evidence suggested that Ford was aware of the Pinto's safety issues before its release?",\n        "answer": "Crash test results and engineer testimonies",\n        "context": "Harley Copp, a former Ford engineer and executive in charge of the crash testing program, testified that the highest level of Ford's management made the decision to go forward with the production of the Pinto, knowing that the gas tank was vulnerable to puncture and rupture at low rear impact speeds."\n    },\n    {\n        "question": "How did the Pinto case impact the legal understanding of corporate responsibility and product liability?",\n        "answer": "Established precedent for punitive damages in product liability cases",\n        "context": "The case set a precedent for awarding punitive damages in product liability cases and highlighted the importance of corporate responsibility in product safety."\n    },\n    {\n        "question": "What was the significance of the 'crush space' in the Pinto's design, and how did it compare to other vehicles?",\n        "answer": "9-10 inches, less than other American cars",\n        "context": "The Pinto's styling, however, required the tank to be placed behind the rear axle leaving only 9 or 10 inches of 'crush space'--far less than in any other American automobile or Ford overseas subcompact."\n    },\n    {\n        "question": "How did Ford's internal memo about the cost-benefit analysis of safety improvements come to light during the trial?",\n        "answer": "Through the testimony of Harley Copp",\n        "context": "Harley Copp's testimony revealed the existence of Ford's internal cost-benefit analysis memo, which compared the cost of improvements to the potential costs of lawsuits from deaths and injuries."\n    },\n    ] took 0.00 seconds
2024-10-24 18:33:35,901 - tests.conftest - INFO - Test test_qa_system[\n    {\n        "question": "Who was the executive vice president of Ford who conceived the Pinto project?",\n        "answer": "Lee Iacocca",\n        "context": "Mr. Iacocca, then a Ford vice president, conceived the project and was its moving force."\n    },\n    {\n        "question": "What was the weight target for the Pinto set by Ford?",\n        "answer": "2,000 pounds",\n        "context": "Ford's objective was to build a car at or below 2,000 pounds to sell for no more than $2,000."\n    },\n    {\n        "question": "On what date did the accident involving Lily Gray and Richard Grimshaw occur?",\n        "answer": "May 28, 1972",\n        "context": "On May 28, 1972, Mrs. Gray, accompanied by 13-year-old Richard Grimshaw, set out in the Pinto from Anaheim for Barstow to meet Mr. Gray."\n    },\n    {\n        "question": "What was the speed of the Ford Galaxie at the moment of impact with the Pinto?",\n        "answer": "28 to 37 miles per hour",\n        "context": "The Galaxie had been traveling from 50 to 55 miles per hour but before the impact had been braked to a speed of from 28 to 37 miles per hour."\n    },\n    {\n        "question": "What factors influenced the placement of the fuel tank in the Ford Pinto?",\n        "answer": "Styling decisions that preceded engineering design",\n        "context": "The Pinto's styling, however, required the tank to be placed behind the rear axle leaving only 9 or 10 inches of 'crush space'--far less than in any other American automobile or Ford overseas subcompact."\n    },\n    {\n        "question": "How did Ford's crash tests reveal the Pinto's fuel system vulnerabilities?",\n        "answer": "Tests showed fuel tank punctures and fuel leakage at low speeds",\n        "context": "Mechanical prototypes struck from the rear with a moving barrier at 21 miles per hour caused the fuel tank to be driven forward and to be punctured, causing fuel leakage in excess of the standard prescribed by the proposed regulation."\n    },\n    {\n        "question": "What was the estimated cost to fix the Pinto's fuel tank design, and how did Ford justify not implementing it?",\n        "answer": "$6.40 per vehicle, justified by cost-benefit analysis",\n        "context": "The cost to remedy the defective design of the Pinto gas tank was estimated to be $6.40 per vehicle. Ford used a cost-benefit analysis to determine that it was cheaper to pay for potential lawsuits than to fix the design."\n    },\n    {\n        "question": "How did the court define 'malice' in the context of the Ford Pinto case?",\n        "answer": "Conscious disregard for the safety of others",\n        "context": "The court defined 'malice' as conduct evincing 'conscious disregard of the probability that the actor's conduct will result in injury to others.'"\n    },\n    {\n        "question": "What was the initial punitive damage award for Grimshaw, and how was it later modified?",\n        "answer": "$125 million, reduced to $3.5 million",\n        "context": "Grimshaw was awarded $2,516,000 compensatory damages and $125 million punitive damages; the Grays were awarded $559,680 in compensatory damages. On Ford's motion for a new trial, Grimshaw was required to remit all but $3 1/2 million of the punitive award as a condition of denial of the motion."\n    },\n    {\n        "question": "How did Ford's 'rush' development of the Pinto affect its safety design?",\n        "answer": "Styling preceded engineering, dictating design choices",\n        "context": "Pinto, however, was a rush project, so that styling preceded engineering and dictated engineering design to a greater degree than usual."\n    },\n    {\n        "question": "What evidence suggested that Ford was aware of the Pinto's safety issues before its release?",\n        "answer": "Crash test results and engineer testimonies",\n        "context": "Harley Copp, a former Ford engineer and executive in charge of the crash testing program, testified that the highest level of Ford's management made the decision to go forward with the production of the Pinto, knowing that the gas tank was vulnerable to puncture and rupture at low rear impact speeds."\n    },\n    {\n        "question": "How did the Pinto case impact the legal understanding of corporate responsibility and product liability?",\n        "answer": "Established precedent for punitive damages in product liability cases",\n        "context": "The case set a precedent for awarding punitive damages in product liability cases and highlighted the importance of corporate responsibility in product safety."\n    },\n    {\n        "question": "What was the significance of the 'crush space' in the Pinto's design, and how did it compare to other vehicles?",\n        "answer": "9-10 inches, less than other American cars",\n        "context": "The Pinto's styling, however, required the tank to be placed behind the rear axle leaving only 9 or 10 inches of 'crush space'--far less than in any other American automobile or Ford overseas subcompact."\n    },\n    {\n        "question": "How did Ford's internal memo about the cost-benefit analysis of safety improvements come to light during the trial?",\n        "answer": "Through the testimony of Harley Copp",\n        "context": "Harley Copp's testimony revealed the existence of Ford's internal cost-benefit analysis memo, which compared the cost of improvements to the potential costs of lawsuits from deaths and injuries."\n    },\n    ] took 0.00 seconds
2024-10-24 18:33:35,901 - tests.conftest - INFO - Test test_qa_system[\n    {\n        "question": "Who was the executive vice president of Ford who conceived the Pinto project?",\n        "answer": "Lee Iacocca",\n        "context": "Mr. Iacocca, then a Ford vice president, conceived the project and was its moving force."\n    },\n    {\n        "question": "What was the weight target for the Pinto set by Ford?",\n        "answer": "2,000 pounds",\n        "context": "Ford's objective was to build a car at or below 2,000 pounds to sell for no more than $2,000."\n    },\n    {\n        "question": "On what date did the accident involving Lily Gray and Richard Grimshaw occur?",\n        "answer": "May 28, 1972",\n        "context": "On May 28, 1972, Mrs. Gray, accompanied by 13-year-old Richard Grimshaw, set out in the Pinto from Anaheim for Barstow to meet Mr. Gray."\n    },\n    {\n        "question": "What was the speed of the Ford Galaxie at the moment of impact with the Pinto?",\n        "answer": "28 to 37 miles per hour",\n        "context": "The Galaxie had been traveling from 50 to 55 miles per hour but before the impact had been braked to a speed of from 28 to 37 miles per hour."\n    },\n    {\n        "question": "What factors influenced the placement of the fuel tank in the Ford Pinto?",\n        "answer": "Styling decisions that preceded engineering design",\n        "context": "The Pinto's styling, however, required the tank to be placed behind the rear axle leaving only 9 or 10 inches of 'crush space'--far less than in any other American automobile or Ford overseas subcompact."\n    },\n    {\n        "question": "How did Ford's crash tests reveal the Pinto's fuel system vulnerabilities?",\n        "answer": "Tests showed fuel tank punctures and fuel leakage at low speeds",\n        "context": "Mechanical prototypes struck from the rear with a moving barrier at 21 miles per hour caused the fuel tank to be driven forward and to be punctured, causing fuel leakage in excess of the standard prescribed by the proposed regulation."\n    },\n    {\n        "question": "What was the estimated cost to fix the Pinto's fuel tank design, and how did Ford justify not implementing it?",\n        "answer": "$6.40 per vehicle, justified by cost-benefit analysis",\n        "context": "The cost to remedy the defective design of the Pinto gas tank was estimated to be $6.40 per vehicle. Ford used a cost-benefit analysis to determine that it was cheaper to pay for potential lawsuits than to fix the design."\n    },\n    {\n        "question": "How did the court define 'malice' in the context of the Ford Pinto case?",\n        "answer": "Conscious disregard for the safety of others",\n        "context": "The court defined 'malice' as conduct evincing 'conscious disregard of the probability that the actor's conduct will result in injury to others.'"\n    },\n    {\n        "question": "What was the initial punitive damage award for Grimshaw, and how was it later modified?",\n        "answer": "$125 million, reduced to $3.5 million",\n        "context": "Grimshaw was awarded $2,516,000 compensatory damages and $125 million punitive damages; the Grays were awarded $559,680 in compensatory damages. On Ford's motion for a new trial, Grimshaw was required to remit all but $3 1/2 million of the punitive award as a condition of denial of the motion."\n    },\n    {\n        "question": "How did Ford's 'rush' development of the Pinto affect its safety design?",\n        "answer": "Styling preceded engineering, dictating design choices",\n        "context": "Pinto, however, was a rush project, so that styling preceded engineering and dictated engineering design to a greater degree than usual."\n    },\n    {\n        "question": "What evidence suggested that Ford was aware of the Pinto's safety issues before its release?",\n        "answer": "Crash test results and engineer testimonies",\n        "context": "Harley Copp, a former Ford engineer and executive in charge of the crash testing program, testified that the highest level of Ford's management made the decision to go forward with the production of the Pinto, knowing that the gas tank was vulnerable to puncture and rupture at low rear impact speeds."\n    },\n    {\n        "question": "How did the Pinto case impact the legal understanding of corporate responsibility and product liability?",\n        "answer": "Established precedent for punitive damages in product liability cases",\n        "context": "The case set a precedent for awarding punitive damages in product liability cases and highlighted the importance of corporate responsibility in product safety."\n    },\n    {\n        "question": "What was the significance of the 'crush space' in the Pinto's design, and how did it compare to other vehicles?",\n        "answer": "9-10 inches, less than other American cars",\n        "context": "The Pinto's styling, however, required the tank to be placed behind the rear axle leaving only 9 or 10 inches of 'crush space'--far less than in any other American automobile or Ford overseas subcompact."\n    },\n    {\n        "question": "How did Ford's internal memo about the cost-benefit analysis of safety improvements come to light during the trial?",\n        "answer": "Through the testimony of Harley Copp",\n        "context": "Harley Copp's testimony revealed the existence of Ford's internal cost-benefit analysis memo, which compared the cost of improvements to the potential costs of lawsuits from deaths and injuries."\n    },\n    ] took 0.00 seconds
2024-10-24 18:54:57,139 - httpx - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 18:54:57,140 - httpx - DEBUG - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 18:54:57,146 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 18:54:57,146 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 18:54:57,155 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 18:54:57,787 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 18:54:57,787 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 18:54:58,754 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 18:54:58,754 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 18:54:59,336 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 18:55:00,994 - root - INFO - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 18:55:00,999 - root - INFO - Created 199 chunks
2024-10-24 18:55:01,002 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 18:55:01,002 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 18:55:01,002 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 18:55:02,234 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 18:55:02,235 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 18:55:02,760 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 18:55:02,761 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 18:55:02,807 - root - INFO - Test test_qa_system[qa_pair0] took 0.00 seconds
2024-10-24 18:55:02,808 - root - INFO - Test test_qa_system[\n    {\n        "question": "Who was the executive vice president of Ford who conceived the Pinto project?",\n        "answer": "Lee Iacocca",\n        "context": "Mr. Iacocca, then a Ford vice president, conceived the project and was its moving force."\n    },\n    {\n        "question": "What was the weight target for the Pinto set by Ford?",\n        "answer": "2,000 pounds",\n        "context": "Ford's objective was to build a car at or below 2,000 pounds to sell for no more than $2,000."\n    },\n    {\n        "question": "On what date did the accident involving Lily Gray and Richard Grimshaw occur?",\n        "answer": "May 28, 1972",\n        "context": "On May 28, 1972, Mrs. Gray, accompanied by 13-year-old Richard Grimshaw, set out in the Pinto from Anaheim for Barstow to meet Mr. Gray."\n    },\n    {\n        "question": "What was the speed of the Ford Galaxie at the moment of impact with the Pinto?",\n        "answer": "28 to 37 miles per hour",\n        "context": "The Galaxie had been traveling from 50 to 55 miles per hour but before the impact had been braked to a speed of from 28 to 37 miles per hour."\n    },\n    {\n        "question": "What factors influenced the placement of the fuel tank in the Ford Pinto?",\n        "answer": "Styling decisions that preceded engineering design",\n        "context": "The Pinto's styling, however, required the tank to be placed behind the rear axle leaving only 9 or 10 inches of 'crush space'--far less than in any other American automobile or Ford overseas subcompact."\n    },\n    {\n        "question": "How did Ford's crash tests reveal the Pinto's fuel system vulnerabilities?",\n        "answer": "Tests showed fuel tank punctures and fuel leakage at low speeds",\n        "context": "Mechanical prototypes struck from the rear with a moving barrier at 21 miles per hour caused the fuel tank to be driven forward and to be punctured, causing fuel leakage in excess of the standard prescribed by the proposed regulation."\n    },\n    {\n        "question": "What was the estimated cost to fix the Pinto's fuel tank design, and how did Ford justify not implementing it?",\n        "answer": "$6.40 per vehicle, justified by cost-benefit analysis",\n        "context": "The cost to remedy the defective design of the Pinto gas tank was estimated to be $6.40 per vehicle. Ford used a cost-benefit analysis to determine that it was cheaper to pay for potential lawsuits than to fix the design."\n    },\n    {\n        "question": "How did the court define 'malice' in the context of the Ford Pinto case?",\n        "answer": "Conscious disregard for the safety of others",\n        "context": "The court defined 'malice' as conduct evincing 'conscious disregard of the probability that the actor's conduct will result in injury to others.'"\n    },\n    {\n        "question": "What was the initial punitive damage award for Grimshaw, and how was it later modified?",\n        "answer": "$125 million, reduced to $3.5 million",\n        "context": "Grimshaw was awarded $2,516,000 compensatory damages and $125 million punitive damages; the Grays were awarded $559,680 in compensatory damages. On Ford's motion for a new trial, Grimshaw was required to remit all but $3 1/2 million of the punitive award as a condition of denial of the motion."\n    },\n    {\n        "question": "How did Ford's 'rush' development of the Pinto affect its safety design?",\n        "answer": "Styling preceded engineering, dictating design choices",\n        "context": "Pinto, however, was a rush project, so that styling preceded engineering and dictated engineering design to a greater degree than usual."\n    },\n    {\n        "question": "What evidence suggested that Ford was aware of the Pinto's safety issues before its release?",\n        "answer": "Crash test results and engineer testimonies",\n        "context": "Harley Copp, a former Ford engineer and executive in charge of the crash testing program, testified that the highest level of Ford's management made the decision to go forward with the production of the Pinto, knowing that the gas tank was vulnerable to puncture and rupture at low rear impact speeds."\n    },\n    {\n        "question": "How did the Pinto case impact the legal understanding of corporate responsibility and product liability?",\n        "answer": "Established precedent for punitive damages in product liability cases",\n        "context": "The case set a precedent for awarding punitive damages in product liability cases and highlighted the importance of corporate responsibility in product safety."\n    },\n    {\n        "question": "What was the significance of the 'crush space' in the Pinto's design, and how did it compare to other vehicles?",\n        "answer": "9-10 inches, less than other American cars",\n        "context": "The Pinto's styling, however, required the tank to be placed behind the rear axle leaving only 9 or 10 inches of 'crush space'--far less than in any other American automobile or Ford overseas subcompact."\n    },\n    {\n        "question": "How did Ford's internal memo about the cost-benefit analysis of safety improvements come to light during the trial?",\n        "answer": "Through the testimony of Harley Copp",\n        "context": "Harley Copp's testimony revealed the existence of Ford's internal cost-benefit analysis memo, which compared the cost of improvements to the potential costs of lawsuits from deaths and injuries."\n    },\n    ] took 0.00 seconds
2024-10-24 22:11:09,673 - httpx - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 22:11:09,673 - httpx - DEBUG - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 22:11:09,679 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:11:09,679 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:11:09,689 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:11:10,155 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:11:10,158 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:11:11,023 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:11:11,023 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:11:11,253 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 22:11:12,105 - root - INFO - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 22:11:12,107 - root - INFO - Created 199 chunks
2024-10-24 22:11:12,107 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:11:12,107 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:11:12,107 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:11:12,434 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:11:12,434 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:11:12,693 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:11:12,694 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:11:12,761 - root - INFO - Processing RAG query: What was the model year of the Ford Pinto involved in the accident?
2024-10-24 22:11:12,761 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:11:12,762 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:11:12,762 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:11:13,111 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:11:13,113 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:11:13,403 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:11:13,403 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:11:13,404 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:11:13,404 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:11:13,405 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:11:13,773 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:11:13,775 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:11:14,168 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:11:14,169 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:11:15,160 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"upsertedCount":1}'
2024-10-24 22:11:16,048 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"results":[],"matches":[{"id":"381ff60ffe74542b971aeaa2148a488c","score":1.00000799,"values":[],"metadata":{"text":"What was the model year of the Ford Pinto involved in the accident?"}},{"id":"7c25ca08798757a5d15caefbcf6d0c6a","score":0.699642897,"values":[],"metadata":{"text":"How did Ford\'s \'rush\' development of the Pinto affect its safety design?"}},{"id":"2ce3084ae5e281f5816fb0b3e11c5cf6","score":0.677877963,"values":[],"metadata":{"text":"How did Ford\'s crash tests reveal the Pinto\'s fuel system vulnerabilities?"}},{"id":"032d6d9f7cf883f483068a2d1d3ea7d0","score":0.649451852,"values":[],"metadata":{"text":"What was the speed of the Ford Galaxie at the moment of impact with the Pinto?"}},{"id":"34d53f2e1e7ce76e0573ae33e295b16d","score":0.640364826,"values":[],"metadata":{"text":"What evidence suggested that Ford was aware of the Pinto\'s safety issues before its release?"}},{"id":"6baf920636bb0e7a14c37c499f0a135f","score":0.591545105,"values":[],"metadata":{"text":"What factors influenced the placement of the fuel tank in the Ford Pinto?"}},{"id":"51bf0066086639adb0a494086a5121ce","score":0.587939262,"values":[],"metadata":{"text":"Who was the executive vice president of Ford who conceived the Pinto project?"}},{"id":"01e59f8ef084bd6a4d99f9067667d768","score":0.578649342,"values":[],"metadata":{"text":"What was the weight target for the Pinto set by Ford?"}},{"id":"4af6bd37a7ac7aa66d6fa4606aaa82b0","score":0.577010334,"values":[],"metadata":{"text":"What was the estimated cost to fix the Pinto\'s fuel tank design, and how did Ford justify not implementing it?"}},{"id":"fc2832187ee0402317d49a6c0df724ae","score":0.566243768,"values":[],"metadata":{"text":"How did the Pinto case impact the legal understanding of corporate responsibility and product liability?"}}],"namespace":"","usage":{"readUnits":6}}'
2024-10-24 22:11:16,051 - root - ERROR - Error in RAG query process: 'chunk'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 72, in rag_query
    relevant_chunks = pinecone_manager.search_similar(query_embedding, top_k=10)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/pinecone_manager.py", line 121, in search_similar
    return [{"chunk": match['metadata']['chunk'], "score": match['score']} for match in results['matches']]
                      ~~~~~~~~~~~~~~~~~^^^^^^^^^
KeyError: 'chunk'
2024-10-24 22:11:16,088 - rag_results - INFO - 
Q: What was the model year of the Ford Pinto involved in the accident?
2024-10-24 22:11:16,088 - rag_results - INFO - Expected A: 1972
2024-10-24 22:11:16,088 - rag_results - INFO - System A: Sorry, I encountered an error while processing your query: 'chunk'
2024-10-24 22:11:16,088 - rag_results - INFO - Is correct: False
2024-10-24 22:11:16,088 - rag_results - INFO - --------------------------------------------------
2024-10-24 22:11:16,181 - root - INFO - Test test_qa_system[qa_pair0] took 3.42 seconds
2024-10-24 22:11:16,183 - root - INFO - Test test_qa_system[\n    {\n        "question": "Who was the executive vice president of Ford who conceived the Pinto project?",\n        "answer": "Lee Iacocca",\n        "context": "Mr. Iacocca, then a Ford vice president, conceived the project and was its moving force."\n    },\n    {\n        "question": "What was the weight target for the Pinto set by Ford?",\n        "answer": "2,000 pounds",\n        "context": "Ford's objective was to build a car at or below 2,000 pounds to sell for no more than $2,000."\n    },\n    {\n        "question": "On what date did the accident involving Lily Gray and Richard Grimshaw occur?",\n        "answer": "May 28, 1972",\n        "context": "On May 28, 1972, Mrs. Gray, accompanied by 13-year-old Richard Grimshaw, set out in the Pinto from Anaheim for Barstow to meet Mr. Gray."\n    },\n    {\n        "question": "What was the speed of the Ford Galaxie at the moment of impact with the Pinto?",\n        "answer": "28 to 37 miles per hour",\n        "context": "The Galaxie had been traveling from 50 to 55 miles per hour but before the impact had been braked to a speed of from 28 to 37 miles per hour."\n    },\n    {\n        "question": "What factors influenced the placement of the fuel tank in the Ford Pinto?",\n        "answer": "Styling decisions that preceded engineering design",\n        "context": "The Pinto's styling, however, required the tank to be placed behind the rear axle leaving only 9 or 10 inches of 'crush space'--far less than in any other American automobile or Ford overseas subcompact."\n    },\n    {\n        "question": "How did Ford's crash tests reveal the Pinto's fuel system vulnerabilities?",\n        "answer": "Tests showed fuel tank punctures and fuel leakage at low speeds",\n        "context": "Mechanical prototypes struck from the rear with a moving barrier at 21 miles per hour caused the fuel tank to be driven forward and to be punctured, causing fuel leakage in excess of the standard prescribed by the proposed regulation."\n    },\n    {\n        "question": "What was the estimated cost to fix the Pinto's fuel tank design, and how did Ford justify not implementing it?",\n        "answer": "$6.40 per vehicle, justified by cost-benefit analysis",\n        "context": "The cost to remedy the defective design of the Pinto gas tank was estimated to be $6.40 per vehicle. Ford used a cost-benefit analysis to determine that it was cheaper to pay for potential lawsuits than to fix the design."\n    },\n    {\n        "question": "How did the court define 'malice' in the context of the Ford Pinto case?",\n        "answer": "Conscious disregard for the safety of others",\n        "context": "The court defined 'malice' as conduct evincing 'conscious disregard of the probability that the actor's conduct will result in injury to others.'"\n    },\n    {\n        "question": "What was the initial punitive damage award for Grimshaw, and how was it later modified?",\n        "answer": "$125 million, reduced to $3.5 million",\n        "context": "Grimshaw was awarded $2,516,000 compensatory damages and $125 million punitive damages; the Grays were awarded $559,680 in compensatory damages. On Ford's motion for a new trial, Grimshaw was required to remit all but $3 1/2 million of the punitive award as a condition of denial of the motion."\n    },\n    {\n        "question": "How did Ford's 'rush' development of the Pinto affect its safety design?",\n        "answer": "Styling preceded engineering, dictating design choices",\n        "context": "Pinto, however, was a rush project, so that styling preceded engineering and dictated engineering design to a greater degree than usual."\n    },\n    {\n        "question": "What evidence suggested that Ford was aware of the Pinto's safety issues before its release?",\n        "answer": "Crash test results and engineer testimonies",\n        "context": "Harley Copp, a former Ford engineer and executive in charge of the crash testing program, testified that the highest level of Ford's management made the decision to go forward with the production of the Pinto, knowing that the gas tank was vulnerable to puncture and rupture at low rear impact speeds."\n    },\n    {\n        "question": "How did the Pinto case impact the legal understanding of corporate responsibility and product liability?",\n        "answer": "Established precedent for punitive damages in product liability cases",\n        "context": "The case set a precedent for awarding punitive damages in product liability cases and highlighted the importance of corporate responsibility in product safety."\n    },\n    {\n        "question": "What was the significance of the 'crush space' in the Pinto's design, and how did it compare to other vehicles?",\n        "answer": "9-10 inches, less than other American cars",\n        "context": "The Pinto's styling, however, required the tank to be placed behind the rear axle leaving only 9 or 10 inches of 'crush space'--far less than in any other American automobile or Ford overseas subcompact."\n    },\n    {\n        "question": "How did Ford's internal memo about the cost-benefit analysis of safety improvements come to light during the trial?",\n        "answer": "Through the testimony of Harley Copp",\n        "context": "Harley Copp's testimony revealed the existence of Ford's internal cost-benefit analysis memo, which compared the cost of improvements to the potential costs of lawsuits from deaths and injuries."\n    },\n    ] took 0.00 seconds
2024-10-24 22:28:02,317 - httpx - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 22:28:02,317 - httpx - DEBUG - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 22:28:02,323 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:28:02,324 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:28:02,332 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:28:03,308 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:28:03,310 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:28:04,998 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:28:04,999 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:28:05,612 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 22:28:06,470 - root - INFO - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 22:28:06,472 - root - INFO - Created 199 chunks
2024-10-24 22:28:06,473 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:28:06,473 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:28:06,473 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:28:06,852 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:28:06,854 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:28:09,505 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:28:09,505 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:28:09,565 - root - INFO - Processing RAG query: What was the model year of the Ford Pinto involved in the accident?
2024-10-24 22:28:09,565 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:28:09,566 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:28:09,566 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:28:11,039 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:28:11,041 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:28:13,700 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:28:13,702 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:28:13,705 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:28:13,705 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:28:13,706 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:28:14,616 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:28:14,617 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:28:16,771 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:28:16,772 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:28:17,724 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"upsertedCount":1}'
2024-10-24 22:28:18,515 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"results":[],"matches":[{"id":"381ff60ffe74542b971aeaa2148a488c","score":1.00000799,"values":[],"metadata":{"text":"What was the model year of the Ford Pinto involved in the accident?"}},{"id":"0","score":1,"values":[],"metadata":{"chunk":"What was the model year of the Ford Pinto involved in the accident?"}},{"id":"7c25ca08798757a5d15caefbcf6d0c6a","score":0.699642897,"values":[],"metadata":{"text":"How did Ford\'s \'rush\' development of the Pinto affect its safety design?"}},{"id":"2ce3084ae5e281f5816fb0b3e11c5cf6","score":0.677877963,"values":[],"metadata":{"text":"How did Ford\'s crash tests reveal the Pinto\'s fuel system vulnerabilities?"}},{"id":"032d6d9f7cf883f483068a2d1d3ea7d0","score":0.649451852,"values":[],"metadata":{"text":"What was the speed of the Ford Galaxie at the moment of impact with the Pinto?"}},{"id":"34d53f2e1e7ce76e0573ae33e295b16d","score":0.640364826,"values":[],"metadata":{"text":"What evidence suggested that Ford was aware of the Pinto\'s safety issues before its release?"}},{"id":"6baf920636bb0e7a14c37c499f0a135f","score":0.591545105,"values":[],"metadata":{"text":"What factors influenced the placement of the fuel tank in the Ford Pinto?"}},{"id":"51bf0066086639adb0a494086a5121ce","score":0.587939262,"values":[],"metadata":{"text":"Who was the executive vice president of Ford who conceived the Pinto project?"}},{"id":"01e59f8ef084bd6a4d99f9067667d768","score":0.578649342,"values":[],"metadata":{"text":"What was the weight target for the Pinto set by Ford?"}},{"id":"4af6bd37a7ac7aa66d6fa4606aaa82b0","score":0.577010334,"values":[],"metadata":{"text":"What was the estimated cost to fix the Pinto\'s fuel tank design, and how did Ford justify not implementing it?"}}],"namespace":"","usage":{"readUnits":6}}'
2024-10-24 22:28:18,518 - root - ERROR - Error in RAG query process: 'chunk'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 72, in rag_query
    relevant_chunks = pinecone_manager.search_similar(query_embedding, top_k=10)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/pinecone_manager.py", line 121, in search_similar
    return [{"chunk": match['metadata']['chunk'], "score": match['score']} for match in results['matches']]
                      ~~~~~~~~~~~~~~~~~^^^^^^^^^
KeyError: 'chunk'
2024-10-24 22:28:18,555 - rag_results - INFO - 
Q: What was the model year of the Ford Pinto involved in the accident?
2024-10-24 22:28:18,556 - rag_results - INFO - Expected A: 1972
2024-10-24 22:28:18,556 - rag_results - INFO - System A: Sorry, I encountered an error while processing your query: 'chunk'
2024-10-24 22:28:18,556 - rag_results - INFO - Is correct: False
2024-10-24 22:28:18,556 - rag_results - INFO - --------------------------------------------------
2024-10-24 22:28:18,651 - root - INFO - Test test_qa_system[qa_pair0] took 9.09 seconds
2024-10-24 22:41:23,686 - httpx - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 22:41:23,687 - httpx - DEBUG - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 22:41:23,693 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:41:23,693 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:41:23,702 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:41:24,112 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:41:24,113 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:41:24,442 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:41:24,442 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:41:24,638 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 22:41:25,514 - root - INFO - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 22:41:25,516 - root - INFO - Created 199 chunks
2024-10-24 22:41:25,516 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:41:25,516 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:41:25,516 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:41:25,808 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:41:25,808 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:41:26,051 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:41:26,052 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:41:26,110 - root - INFO - Processing RAG query: What was the model year of the Ford Pinto involved in the accident?
2024-10-24 22:41:26,111 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:41:26,111 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:41:26,111 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:41:26,435 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:41:26,436 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:41:26,798 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:41:26,798 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:41:26,799 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:41:26,799 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:41:26,799 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:41:27,093 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:41:27,094 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:41:27,516 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:41:27,517 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:41:28,506 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"upsertedCount":1}'
2024-10-24 22:41:29,336 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"results":[],"matches":[{"id":"0","score":1.00000799,"values":[],"metadata":{"chunk":"What was the model year of the Ford Pinto involved in the accident?"}},{"id":"381ff60ffe74542b971aeaa2148a488c","score":1.00000799,"values":[],"metadata":{"text":"What was the model year of the Ford Pinto involved in the accident?"}},{"id":"7c25ca08798757a5d15caefbcf6d0c6a","score":0.699642897,"values":[],"metadata":{"text":"How did Ford\'s \'rush\' development of the Pinto affect its safety design?"}},{"id":"2ce3084ae5e281f5816fb0b3e11c5cf6","score":0.677877963,"values":[],"metadata":{"text":"How did Ford\'s crash tests reveal the Pinto\'s fuel system vulnerabilities?"}},{"id":"032d6d9f7cf883f483068a2d1d3ea7d0","score":0.649451852,"values":[],"metadata":{"text":"What was the speed of the Ford Galaxie at the moment of impact with the Pinto?"}},{"id":"34d53f2e1e7ce76e0573ae33e295b16d","score":0.640364826,"values":[],"metadata":{"text":"What evidence suggested that Ford was aware of the Pinto\'s safety issues before its release?"}},{"id":"6baf920636bb0e7a14c37c499f0a135f","score":0.591545105,"values":[],"metadata":{"text":"What factors influenced the placement of the fuel tank in the Ford Pinto?"}},{"id":"51bf0066086639adb0a494086a5121ce","score":0.587939262,"values":[],"metadata":{"text":"Who was the executive vice president of Ford who conceived the Pinto project?"}},{"id":"01e59f8ef084bd6a4d99f9067667d768","score":0.578649342,"values":[],"metadata":{"text":"What was the weight target for the Pinto set by Ford?"}},{"id":"4af6bd37a7ac7aa66d6fa4606aaa82b0","score":0.577010334,"values":[],"metadata":{"text":"What was the estimated cost to fix the Pinto\'s fuel tank design, and how did Ford justify not implementing it?"}}],"namespace":"","usage":{"readUnits":6}}'
2024-10-24 22:41:29,339 - root - INFO - Generated answer: <MagicMock name='mock.generate_answer()' id='5473217440'>
2024-10-24 22:41:29,478 - root - INFO - Test test_qa_system[qa_pair0] took 3.37 seconds
2024-10-24 22:48:46,760 - httpx - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 22:48:46,760 - httpx - DEBUG - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 22:48:46,767 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:48:46,767 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:48:46,775 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:48:47,635 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:48:47,638 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:48:50,013 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:48:50,014 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:48:50,370 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 22:48:51,200 - root - INFO - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 22:48:51,202 - root - INFO - Created 199 chunks
2024-10-24 22:48:51,203 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:48:51,203 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:48:51,203 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:48:51,519 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:48:51,520 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:48:53,862 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:48:53,863 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:48:53,920 - root - INFO - Processing RAG query: What was the model year of the Ford Pinto involved in the accident?
2024-10-24 22:48:53,922 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:48:53,922 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:48:53,923 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:48:54,429 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:48:54,430 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:48:56,484 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:48:56,484 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:48:56,486 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:48:56,487 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:48:56,487 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:48:57,669 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:48:57,670 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:48:58,284 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:48:58,285 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:48:59,294 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"upsertedCount":1}'
2024-10-24 22:49:00,152 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"results":[],"matches":[{"id":"381ff60ffe74542b971aeaa2148a488c","score":1.00000799,"values":[],"metadata":{"text":"What was the model year of the Ford Pinto involved in the accident?"}},{"id":"0","score":1,"values":[],"metadata":{"chunk":"What was the model year of the Ford Pinto involved in the accident?"}},{"id":"7c25ca08798757a5d15caefbcf6d0c6a","score":0.699642897,"values":[],"metadata":{"text":"How did Ford\'s \'rush\' development of the Pinto affect its safety design?"}},{"id":"2ce3084ae5e281f5816fb0b3e11c5cf6","score":0.677877963,"values":[],"metadata":{"text":"How did Ford\'s crash tests reveal the Pinto\'s fuel system vulnerabilities?"}},{"id":"032d6d9f7cf883f483068a2d1d3ea7d0","score":0.649451852,"values":[],"metadata":{"text":"What was the speed of the Ford Galaxie at the moment of impact with the Pinto?"}},{"id":"34d53f2e1e7ce76e0573ae33e295b16d","score":0.640364826,"values":[],"metadata":{"text":"What evidence suggested that Ford was aware of the Pinto\'s safety issues before its release?"}},{"id":"6baf920636bb0e7a14c37c499f0a135f","score":0.591545105,"values":[],"metadata":{"text":"What factors influenced the placement of the fuel tank in the Ford Pinto?"}},{"id":"51bf0066086639adb0a494086a5121ce","score":0.587939262,"values":[],"metadata":{"text":"Who was the executive vice president of Ford who conceived the Pinto project?"}},{"id":"01e59f8ef084bd6a4d99f9067667d768","score":0.578649342,"values":[],"metadata":{"text":"What was the weight target for the Pinto set by Ford?"}},{"id":"4af6bd37a7ac7aa66d6fa4606aaa82b0","score":0.577010334,"values":[],"metadata":{"text":"What was the estimated cost to fix the Pinto\'s fuel tank design, and how did Ford justify not implementing it?"}}],"namespace":"","usage":{"readUnits":6}}'
2024-10-24 22:49:00,156 - root - INFO - Generated answer: This is a mock answer
2024-10-24 22:49:00,190 - rag_results - INFO - 
Q: What was the model year of the Ford Pinto involved in the accident?
2024-10-24 22:49:00,190 - rag_results - INFO - Expected A: 1972
2024-10-24 22:49:00,190 - rag_results - INFO - System A: This is a mock answer
2024-10-24 22:49:00,190 - rag_results - INFO - Is correct: False
2024-10-24 22:49:00,190 - rag_results - INFO - --------------------------------------------------
2024-10-24 22:49:00,284 - root - INFO - Test test_qa_system[qa_pair0] took 6.36 seconds
2024-10-24 22:50:53,889 - httpx - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 22:50:53,890 - httpx - DEBUG - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 22:50:53,897 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:50:53,897 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:50:53,905 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:50:54,229 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:50:54,231 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:50:56,865 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:50:56,865 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:50:57,051 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 22:53:14,623 - httpx - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 22:53:14,624 - httpx - DEBUG - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 22:53:14,631 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:53:14,631 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:53:14,640 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:53:15,656 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:53:15,656 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:53:15,923 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:53:15,924 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:53:16,158 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 22:53:16,165 - root - INFO - Starting the RAG system
2024-10-24 22:53:54,597 - root - INFO - Loading book from: tests/data/test.pdf
2024-10-24 22:53:54,600 - root - INFO - Starting to process book content
2024-10-24 22:53:54,600 - root - INFO - Preprocessing text content
2024-10-24 22:53:54,945 - root - INFO - Extracted 0 dates, 0 named entities, and 1 key phrases from the text
2024-10-24 22:53:54,945 - root - INFO - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 22:53:54,945 - root - INFO - Created 1 chunks
2024-10-24 22:53:54,945 - root - INFO - Text preprocessed. Number of chunks: 1
2024-10-24 22:53:54,945 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:53:54,946 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:53:54,946 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:53:55,260 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:53:55,260 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:53:55,730 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:53:55,730 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:53:55,733 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x12ab4fb00>, 'json_data': {'input': ['tests/data/test.pdf'], 'model': 'text-embedding-3-small', 'encoding_format': 'base64'}}
2024-10-24 22:53:55,766 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-24 22:53:55,766 - httpcore.connection - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-24 22:53:55,902 - httpcore.connection - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x12ad248f0>
2024-10-24 22:53:55,904 - httpcore.connection - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x12a97f7d0> server_hostname='api.openai.com' timeout=5.0
2024-10-24 22:53:55,946 - httpcore.connection - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x12a9a6210>
2024-10-24 22:53:55,946 - httpcore.http11 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-24 22:53:55,947 - httpcore.http11 - DEBUG - send_request_headers.complete
2024-10-24 22:53:55,947 - httpcore.http11 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-24 22:53:55,947 - httpcore.http11 - DEBUG - send_request_body.complete
2024-10-24 22:53:55,947 - httpcore.http11 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-24 22:53:56,182 - httpcore.http11 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Thu, 24 Oct 2024 21:53:56 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-3-small'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'35'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999996'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'0s'), (b'x-request-id', b'req_589bf42deca44b6afd1b1fa224244951'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=sgOiz5IS9iE4SmqzBX.PpcK2AgQcYJUl7_GWV0I2Q48-1729806836-1.0.1.1-XwYH7mM46Ijn_7IWr1ftp_NFJV85n25rYqPJ0egJfpGPEWOUvJD2N58Fs6lkHlCPcH6m8UnmJEau6kIPf1gPJQ; path=/; expires=Thu, 24-Oct-24 22:23:56 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=Dm9HXmNA8UFVOwf2o75q2bUnXOHn2TIevzelVNu5KsA-1729806836306-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d7d33d5b9a894fb-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-24 22:53:56,185 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-24 22:53:56,186 - httpcore.http11 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-24 22:53:56,189 - httpcore.http11 - DEBUG - receive_response_body.complete
2024-10-24 22:53:56,191 - httpcore.http11 - DEBUG - response_closed.started
2024-10-24 22:53:56,191 - httpcore.http11 - DEBUG - response_closed.complete
2024-10-24 22:53:56,191 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers([('date', 'Thu, 24 Oct 2024 21:53:56 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-allow-origin', '*'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-model', 'text-embedding-3-small'), ('openai-organization', 'uinside'), ('openai-processing-ms', '35'), ('openai-version', '2020-10-01'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '5000000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '4999996'), ('x-ratelimit-reset-requests', '6ms'), ('x-ratelimit-reset-tokens', '0s'), ('x-request-id', 'req_589bf42deca44b6afd1b1fa224244951'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=sgOiz5IS9iE4SmqzBX.PpcK2AgQcYJUl7_GWV0I2Q48-1729806836-1.0.1.1-XwYH7mM46Ijn_7IWr1ftp_NFJV85n25rYqPJ0egJfpGPEWOUvJD2N58Fs6lkHlCPcH6m8UnmJEau6kIPf1gPJQ; path=/; expires=Thu, 24-Oct-24 22:23:56 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=Dm9HXmNA8UFVOwf2o75q2bUnXOHn2TIevzelVNu5KsA-1729806836306-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d7d33d5b9a894fb-LIS'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-24 22:53:56,191 - openai._base_client - DEBUG - request_id: req_589bf42deca44b6afd1b1fa224244951
2024-10-24 22:53:57,148 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"upsertedCount":1}'
2024-10-24 22:53:57,320 - root - INFO - Saving 1 chunks, their embeddings, and processed text to data/embeddings/35c83be7eecaf97ed63d33d440f620b3_chunks_embeddings.pkl.
2024-10-24 22:53:57,322 - root - INFO - Data saved to data/embeddings/35c83be7eecaf97ed63d33d440f620b3_chunks_embeddings.pkl.
2024-10-24 22:53:57,322 - root - INFO - Book data created. Number of chunks: 1
2024-10-24 22:53:57,322 - root - INFO - Book loaded and preprocessed. Text split into 1 chunks
2024-10-24 22:54:08,051 - root - INFO - Received query:  ?
2024-10-24 22:54:08,052 - root - ERROR - Error generating answer: rag_query() missing 1 required positional argument: 'openai_service'
2024-10-24 22:59:46,436 - httpx - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 22:59:46,437 - httpx - DEBUG - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 22:59:46,444 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:59:46,444 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:59:46,453 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:59:46,861 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:59:46,863 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:59:47,296 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:59:47,297 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:59:47,496 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 22:59:47,498 - root - INFO - Starting the RAG system
2024-10-24 23:00:04,865 - root - INFO - Loading book from: tests/data/test.docx
2024-10-24 23:00:04,866 - root - INFO - Starting to process book content
2024-10-24 23:00:04,866 - root - INFO - Preprocessing text content
2024-10-24 23:00:05,158 - root - INFO - Extracted 0 dates, 0 named entities, and 1 key phrases from the text
2024-10-24 23:00:05,158 - root - INFO - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 23:00:05,158 - root - INFO - Created 1 chunks
2024-10-24 23:00:05,158 - root - INFO - Text preprocessed. Number of chunks: 1
2024-10-24 23:00:05,158 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:00:05,158 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:00:05,159 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 23:00:06,419 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:00:06,420 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 23:00:06,777 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:00:06,777 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 23:00:06,779 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x113b4fa60>, 'json_data': {'input': ['tests/data/test.docx'], 'model': 'text-embedding-3-small', 'encoding_format': 'base64'}}
2024-10-24 23:00:06,815 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-24 23:00:06,816 - httpcore.connection - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-24 23:00:06,950 - httpcore.connection - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x114924080>
2024-10-24 23:00:06,950 - httpcore.connection - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x11397f7d0> server_hostname='api.openai.com' timeout=5.0
2024-10-24 23:00:06,987 - httpcore.connection - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x112a2a000>
2024-10-24 23:00:06,987 - httpcore.http11 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-24 23:00:06,988 - httpcore.http11 - DEBUG - send_request_headers.complete
2024-10-24 23:00:06,988 - httpcore.http11 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-24 23:00:06,988 - httpcore.http11 - DEBUG - send_request_body.complete
2024-10-24 23:00:06,988 - httpcore.http11 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-24 23:00:07,346 - httpcore.http11 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Thu, 24 Oct 2024 22:00:07 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-3-small'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'134'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999994'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'0s'), (b'x-request-id', b'req_c40f3598dda3aeec3665d3716c1bda0f'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=munTpX_6yUPeFjiqDGNXhpHxK2r4J5xT7T_QybblXgw-1729807207-1.0.1.1-Bslqj_4UVx4ZR6HEJ7g8IpafNE71O4f4.zwJY6179kT.SJu56xitLJBb6buMGX39EkSm9ptvgDcGTDevCRgtIg; path=/; expires=Thu, 24-Oct-24 22:30:07 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=ED62IBqvfppYcajiSIbeZeU8ksGL_cPn35k03TZbhQI-1729807207415-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d7d3ce4bd25e3b0-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-24 23:00:07,349 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-24 23:00:07,349 - httpcore.http11 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-24 23:00:07,353 - httpcore.http11 - DEBUG - receive_response_body.complete
2024-10-24 23:00:07,353 - httpcore.http11 - DEBUG - response_closed.started
2024-10-24 23:00:07,353 - httpcore.http11 - DEBUG - response_closed.complete
2024-10-24 23:00:07,354 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers([('date', 'Thu, 24 Oct 2024 22:00:07 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-allow-origin', '*'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-model', 'text-embedding-3-small'), ('openai-organization', 'uinside'), ('openai-processing-ms', '134'), ('openai-version', '2020-10-01'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '5000000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '4999994'), ('x-ratelimit-reset-requests', '6ms'), ('x-ratelimit-reset-tokens', '0s'), ('x-request-id', 'req_c40f3598dda3aeec3665d3716c1bda0f'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=munTpX_6yUPeFjiqDGNXhpHxK2r4J5xT7T_QybblXgw-1729807207-1.0.1.1-Bslqj_4UVx4ZR6HEJ7g8IpafNE71O4f4.zwJY6179kT.SJu56xitLJBb6buMGX39EkSm9ptvgDcGTDevCRgtIg; path=/; expires=Thu, 24-Oct-24 22:30:07 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=ED62IBqvfppYcajiSIbeZeU8ksGL_cPn35k03TZbhQI-1729807207415-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d7d3ce4bd25e3b0-LIS'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-24 23:00:07,354 - openai._base_client - DEBUG - request_id: req_c40f3598dda3aeec3665d3716c1bda0f
2024-10-24 23:00:08,336 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"upsertedCount":1}'
2024-10-24 23:00:08,544 - root - INFO - Saving 1 chunks, their embeddings, and processed text to data/embeddings/e4d91ac66e5f5558df574c83384c8ecd_chunks_embeddings.pkl.
2024-10-24 23:00:08,545 - root - INFO - Data saved to data/embeddings/e4d91ac66e5f5558df574c83384c8ecd_chunks_embeddings.pkl.
2024-10-24 23:00:08,545 - root - INFO - Book data created. Number of chunks: 1
2024-10-24 23:00:08,545 - root - INFO - Book loaded and preprocessed. Text split into 1 chunks
2024-10-24 23:00:19,301 - root - INFO - Received query:  ?
2024-10-24 23:00:19,302 - root - ERROR - Error generating answer: rag_query() missing 1 required positional argument: 'openai_service'
2024-10-24 23:06:24,338 - root - INFO - Received query: ?
2024-10-24 23:06:24,343 - root - ERROR - Error generating answer: rag_query() missing 1 required positional argument: 'openai_service'
2024-10-24 23:06:37,488 - httpx - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 23:06:37,489 - httpx - DEBUG - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 23:06:37,496 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:06:37,496 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:06:37,505 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 23:06:37,966 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:06:37,967 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 23:06:38,463 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:06:38,463 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 23:06:38,675 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 23:06:38,679 - root - INFO - Starting the RAG system
2024-10-24 23:07:08,880 - root - INFO - Loading book from: tests/data/test.odt
2024-10-24 23:07:08,881 - root - INFO - Starting to process book content
2024-10-24 23:07:08,881 - root - INFO - Preprocessing text content
2024-10-24 23:07:09,176 - root - INFO - Extracted 0 dates, 0 named entities, and 1 key phrases from the text
2024-10-24 23:07:09,176 - root - INFO - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 23:07:09,176 - root - INFO - Created 1 chunks
2024-10-24 23:07:09,176 - root - INFO - Text preprocessed. Number of chunks: 1
2024-10-24 23:07:09,177 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:07:09,177 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:07:09,177 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 23:07:09,494 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:07:09,494 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 23:07:09,848 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:07:09,849 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 23:07:09,852 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x1248539c0>, 'json_data': {'input': ['tests/data/test.odt'], 'model': 'text-embedding-3-small', 'encoding_format': 'base64'}}
2024-10-24 23:07:09,893 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-24 23:07:09,893 - httpcore.connection - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-24 23:07:10,026 - httpcore.connection - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x124a24380>
2024-10-24 23:07:10,026 - httpcore.connection - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x11f3337d0> server_hostname='api.openai.com' timeout=5.0
2024-10-24 23:07:10,063 - httpcore.connection - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x124a25280>
2024-10-24 23:07:10,064 - httpcore.http11 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-24 23:07:10,064 - httpcore.http11 - DEBUG - send_request_headers.complete
2024-10-24 23:07:10,064 - httpcore.http11 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-24 23:07:10,064 - httpcore.http11 - DEBUG - send_request_body.complete
2024-10-24 23:07:10,064 - httpcore.http11 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-24 23:07:10,403 - httpcore.http11 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Thu, 24 Oct 2024 22:07:10 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-3-small'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'106'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999995'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'0s'), (b'x-request-id', b'req_ea5e4769ec3b8c42ff6aa597a5413df3'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=VOm9jrc1YjMpOFE4QfRBcmZkMlCo80igcDJA05RBQR4-1729807630-1.0.1.1-jGNajBoAoE5WtjVA3fqj19QVx4LXH4h_C.vM0sipUZ0_4QDLVBj0QNqN3szcHXYIcW_tyaXXnvLt30xbimNShQ; path=/; expires=Thu, 24-Oct-24 22:37:10 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=2.FvMGhMkjipV3d_thG2o2vE7gbxc_5jBib_x97qn.E-1729807630535-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d7d4738e84de3b4-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-24 23:07:10,405 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-24 23:07:10,406 - httpcore.http11 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-24 23:07:10,456 - httpcore.http11 - DEBUG - receive_response_body.complete
2024-10-24 23:07:10,456 - httpcore.http11 - DEBUG - response_closed.started
2024-10-24 23:07:10,456 - httpcore.http11 - DEBUG - response_closed.complete
2024-10-24 23:07:10,456 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers([('date', 'Thu, 24 Oct 2024 22:07:10 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-allow-origin', '*'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-model', 'text-embedding-3-small'), ('openai-organization', 'uinside'), ('openai-processing-ms', '106'), ('openai-version', '2020-10-01'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '5000000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '4999995'), ('x-ratelimit-reset-requests', '6ms'), ('x-ratelimit-reset-tokens', '0s'), ('x-request-id', 'req_ea5e4769ec3b8c42ff6aa597a5413df3'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=VOm9jrc1YjMpOFE4QfRBcmZkMlCo80igcDJA05RBQR4-1729807630-1.0.1.1-jGNajBoAoE5WtjVA3fqj19QVx4LXH4h_C.vM0sipUZ0_4QDLVBj0QNqN3szcHXYIcW_tyaXXnvLt30xbimNShQ; path=/; expires=Thu, 24-Oct-24 22:37:10 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=2.FvMGhMkjipV3d_thG2o2vE7gbxc_5jBib_x97qn.E-1729807630535-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d7d4738e84de3b4-LIS'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-24 23:07:10,456 - openai._base_client - DEBUG - request_id: req_ea5e4769ec3b8c42ff6aa597a5413df3
2024-10-24 23:07:11,505 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"upsertedCount":1}'
2024-10-24 23:07:11,700 - root - INFO - Saving 1 chunks, their embeddings, and processed text to data/embeddings/6ee7dca7817d3b2f28a88d5e7e6121f0_chunks_embeddings.pkl.
2024-10-24 23:07:11,701 - root - INFO - Data saved to data/embeddings/6ee7dca7817d3b2f28a88d5e7e6121f0_chunks_embeddings.pkl.
2024-10-24 23:07:11,701 - root - INFO - Book data created. Number of chunks: 1
2024-10-24 23:07:11,701 - root - INFO - Book loaded and preprocessed. Text split into 1 chunks
2024-10-24 23:07:22,491 - root - INFO - Received query:   ?
2024-10-24 23:07:22,491 - root - ERROR - An error occurred: name 'openai_service' is not defined
2024-10-24 23:07:22,491 - root - INFO - Exiting the RAG system
2024-10-24 23:07:22,584 - httpcore.connection - DEBUG - close.started
2024-10-24 23:07:22,584 - httpcore.connection - DEBUG - close.complete
2024-10-24 23:10:06,340 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 23:10:06,341 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 23:10:06,347 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:10:06,348 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:10:06,356 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:10:06,831 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:10:06,832 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:10:07,545 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:10:07,546 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:10:07,852 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 23:10:07,859 - root - INFO - cli.py:54 - run_cli - Starting the RAG system
2024-10-24 23:10:11,888 - root - INFO - cli.py:62 - run_cli - Loading book from: tests/data/test.odt
2024-10-24 23:10:11,889 - root - INFO - cli.py:25 - load_and_process_book - Starting to process book content
2024-10-24 23:10:11,890 - root - INFO - text_processing.py:75 - load_and_preprocess_text - Preprocessing text content
2024-10-24 23:10:12,232 - root - INFO - text_processing.py:81 - load_and_preprocess_text - Extracted 0 dates, 0 named entities, and 1 key phrases from the text
2024-10-24 23:10:12,232 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 23:10:12,232 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1 chunks
2024-10-24 23:10:12,232 - root - INFO - cli.py:28 - load_and_process_book - Text preprocessed. Number of chunks: 1
2024-10-24 23:10:12,232 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:10:12,232 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:10:12,233 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:10:12,538 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:10:12,539 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:10:12,973 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:10:12,973 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:10:13,911 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-24 23:10:14,101 - root - INFO - embedding.py:46 - save_chunks_and_embeddings - Saving 1 chunks, their embeddings, and processed text to data/embeddings/6ee7dca7817d3b2f28a88d5e7e6121f0_chunks_embeddings.pkl.
2024-10-24 23:10:14,103 - root - INFO - embedding.py:49 - save_chunks_and_embeddings - Data saved to data/embeddings/6ee7dca7817d3b2f28a88d5e7e6121f0_chunks_embeddings.pkl.
2024-10-24 23:10:14,103 - root - INFO - cli.py:38 - load_and_process_book - Book data created. Number of chunks: 1
2024-10-24 23:10:14,103 - root - INFO - cli.py:64 - run_cli - Book loaded and preprocessed. Text split into 1 chunks
2024-10-24 23:10:23,415 - root - INFO - cli.py:74 - run_cli - Received query: ?
2024-10-24 23:10:23,416 - root - ERROR - cli.py:82 - run_cli - An error occurred: name 'openai_service' is not defined
2024-10-24 23:10:23,416 - root - INFO - cli.py:85 - run_cli - Exiting the RAG system
2024-10-24 23:12:39,242 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 23:12:39,243 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 23:12:39,251 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:12:39,252 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:12:39,261 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:12:39,581 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:12:39,583 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:12:40,799 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:12:40,799 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:12:41,147 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 23:12:41,150 - root - INFO - cli.py:54 - run_cli - Starting the RAG system
2024-10-24 23:13:23,254 - root - INFO - cli.py:62 - run_cli - Loading book from: tests/data/test.odt
2024-10-24 23:13:23,256 - root - INFO - cli.py:25 - load_and_process_book - Starting to process book content
2024-10-24 23:13:23,256 - root - INFO - text_processing.py:75 - load_and_preprocess_text - Preprocessing text content
2024-10-24 23:13:23,597 - root - INFO - text_processing.py:81 - load_and_preprocess_text - Extracted 0 dates, 0 named entities, and 1 key phrases from the text
2024-10-24 23:13:23,598 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 23:13:23,598 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1 chunks
2024-10-24 23:13:23,598 - root - INFO - cli.py:28 - load_and_process_book - Text preprocessed. Number of chunks: 1
2024-10-24 23:13:23,598 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:13:23,598 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:13:23,598 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:13:23,986 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:13:23,988 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:13:24,307 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:13:24,307 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:13:25,254 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-24 23:13:25,444 - root - INFO - embedding.py:46 - save_chunks_and_embeddings - Saving 1 chunks, their embeddings, and processed text to data/embeddings/6ee7dca7817d3b2f28a88d5e7e6121f0_chunks_embeddings.pkl.
2024-10-24 23:13:25,445 - root - INFO - embedding.py:49 - save_chunks_and_embeddings - Data saved to data/embeddings/6ee7dca7817d3b2f28a88d5e7e6121f0_chunks_embeddings.pkl.
2024-10-24 23:13:25,445 - root - INFO - cli.py:38 - load_and_process_book - Book data created. Number of chunks: 1
2024-10-24 23:13:25,445 - root - INFO - cli.py:64 - run_cli - Book loaded and preprocessed. Text split into 1 chunks
2024-10-24 23:13:47,161 - root - INFO - cli.py:74 - run_cli - Received query: ?
2024-10-24 23:13:47,162 - root - ERROR - cli.py:82 - run_cli - An error occurred: name 'openai_service' is not defined
2024-10-24 23:13:47,163 - root - INFO - cli.py:85 - run_cli - Exiting the RAG system
2024-10-24 23:19:30,918 - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:19:31,210 - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:19:31,415 - INFO - src/cli.py:54 - run_cli - Starting the RAG system
2024-10-24 23:21:10,171 - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:21:10,539 - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:21:10,907 - INFO - src/cli.py:54 - run_cli - Starting the RAG system
2024-10-24 23:21:14,822 - INFO - src/cli.py:65 - run_cli - Loading book from: tests/data/test.odt
2024-10-24 23:21:14,823 - INFO - src/cli.py:25 - load_and_process_book - Starting to process book content
2024-10-24 23:21:14,823 - INFO - src/text_processing.py:75 - load_and_preprocess_text - Preprocessing text content
2024-10-24 23:21:15,105 - INFO - src/text_processing.py:81 - load_and_preprocess_text - Extracted 0 dates, 0 named entities, and 1 key phrases from the text
2024-10-24 23:21:15,105 - INFO - src/text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 23:21:15,105 - INFO - src/text_processing.py:103 - split_into_chunks - Created 1 chunks
2024-10-24 23:21:15,105 - INFO - src/cli.py:28 - load_and_process_book - Text preprocessed. Number of chunks: 1
2024-10-24 23:21:15,797 - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:21:16,055 - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:21:17,145 - INFO - src/embedding.py:46 - save_chunks_and_embeddings - Saving 1 chunks, their embeddings, and processed text to data/embeddings/6ee7dca7817d3b2f28a88d5e7e6121f0_chunks_embeddings.pkl.
2024-10-24 23:21:17,146 - INFO - src/embedding.py:49 - save_chunks_and_embeddings - Data saved to data/embeddings/6ee7dca7817d3b2f28a88d5e7e6121f0_chunks_embeddings.pkl.
2024-10-24 23:21:17,146 - INFO - src/cli.py:38 - load_and_process_book - Book data created. Number of chunks: 1
2024-10-24 23:21:17,146 - INFO - src/cli.py:67 - run_cli - Book loaded and preprocessed. Text split into 1 chunks
2024-10-24 23:21:24,405 - INFO - src/cli.py:77 - run_cli - Received query:  ,
2024-10-24 23:21:24,406 - INFO - src/cli.py:43 - answer_question - Received query:  ,
2024-10-24 23:21:24,407 - INFO - src/rag.py:68 - rag_query - Processing RAG query:  ,
2024-10-24 23:21:24,726 - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:21:24,972 - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:21:25,392 - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:21:25,638 - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:21:28,317 - INFO - src/openai_service.py:40 - generate_answer - Generating answer for query:  ,
2024-10-24 23:21:29,626 - INFO - src/rag.py:80 - rag_query - Generated answer: The text " ," translates to "What is here," but the context does not provide any additional information or content to clarify what is being referred to. The original chunk only consists of this phrase, leaving the context and meaning unclear. We do not have further details about the subject, situation, or items being referenced.
2024-10-24 23:21:29,628 - INFO - src/cli.py:46 - answer_question - Generated answer: The text " ," translates to "What is here," but the context does not provide any additional information or content to clarify what is being referred to. The original chunk only consists of this phrase, leaving the context and meaning unclear. We do not have further details about the subject, situation, or items being referenced.
2024-10-24 23:23:10,658 - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:23:12,341 - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:23:13,276 - INFO - app.py:96 - <module> - Starting Flask app on port 5001
2024-10-24 23:23:14,813 - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:23:15,483 - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:23:15,802 - INFO - app.py:96 - <module> - Starting Flask app on port 5001
2024-10-24 23:24:06,127 - INFO - app.py:34 - index - Index route accessed
2024-10-24 23:24:06,129 - INFO - app.py:60 - index - Rendering index.html
2024-10-24 23:24:20,031 - INFO - app.py:34 - index - Index route accessed
2024-10-24 23:24:20,032 - INFO - app.py:36 - index - POST request received
2024-10-24 23:24:20,040 - INFO - src/file_processor.py:15 - process_file - Processing file: uploads/A_Byte_of_Python_Rus_2.01.pdf with extension: .pdf
2024-10-24 23:24:20,040 - INFO - src/file_processor.py:26 - process_file - Using processor for extension: .pdf
2024-10-24 23:24:21,175 - INFO - src/cli.py:25 - load_and_process_book - Starting to process book content
2024-10-24 23:24:21,175 - INFO - src/text_processing.py:75 - load_and_preprocess_text - Preprocessing text content
2024-10-24 23:24:25,597 - INFO - src/text_processing.py:81 - load_and_preprocess_text - Extracted 22 dates, 1232 named entities, and 5 key phrases from the text
2024-10-24 23:24:25,598 - INFO - src/text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 23:24:25,600 - INFO - src/text_processing.py:103 - split_into_chunks - Created 183 chunks
2024-10-24 23:24:25,601 - INFO - src/cli.py:28 - load_and_process_book - Text preprocessed. Number of chunks: 183
2024-10-24 23:24:25,931 - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:24:26,210 - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:25:11,189 - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:25:11,670 - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:25:12,023 - INFO - app.py:96 - <module> - Starting Flask app on port 5001
2024-10-24 23:25:19,169 - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:25:19,452 - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:25:19,747 - INFO - app.py:96 - <module> - Starting Flask app on port 5001
2024-10-24 23:25:34,044 - root - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:25:34,598 - root - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:25:34,913 - root - INFO - app.py:96 - <module> - Starting Flask app on port 5001
2024-10-24 23:25:40,974 - root - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:25:41,259 - root - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:25:41,880 - root - INFO - app.py:96 - <module> - Starting Flask app on port 5001
2024-10-24 23:25:56,962 - root - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:25:57,225 - root - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:25:57,553 - root - INFO - app.py:96 - <module> - Starting Flask app on port 5001
2024-10-24 23:26:17,399 - root - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:26:17,823 - root - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:26:18,262 - root - INFO - app.py:96 - <module> - Starting Flask app on port 5001
2024-10-24 23:26:19,291 - root - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:26:19,664 - root - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:26:20,173 - root - INFO - app.py:96 - <module> - Starting Flask app on port 5001
2024-10-24 23:26:25,094 - root - INFO - app.py:34 - index - Index route accessed
2024-10-24 23:26:25,096 - root - INFO - app.py:60 - index - Rendering index.html
2024-10-24 23:26:25,602 - root - INFO - app.py:34 - index - Index route accessed
2024-10-24 23:26:25,602 - root - INFO - app.py:60 - index - Rendering index.html
2024-10-24 23:26:31,942 - root - INFO - app.py:34 - index - Index route accessed
2024-10-24 23:26:31,942 - root - INFO - app.py:36 - index - POST request received
2024-10-24 23:26:31,950 - root - INFO - src/file_processor.py:15 - process_file - Processing file: uploads/A_Byte_of_Python_Rus_2.01.pdf with extension: .pdf
2024-10-24 23:26:31,951 - root - INFO - src/file_processor.py:26 - process_file - Using processor for extension: .pdf
2024-10-24 23:26:32,945 - root - INFO - src/cli.py:25 - load_and_process_book - Starting to process book content
2024-10-24 23:26:32,945 - root - INFO - src/text_processing.py:75 - load_and_preprocess_text - Preprocessing text content
2024-10-24 23:26:37,389 - root - INFO - src/text_processing.py:81 - load_and_preprocess_text - Extracted 22 dates, 1232 named entities, and 5 key phrases from the text
2024-10-24 23:26:37,389 - root - INFO - src/text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 23:26:37,391 - root - INFO - src/text_processing.py:103 - split_into_chunks - Created 183 chunks
2024-10-24 23:26:37,392 - root - INFO - src/cli.py:28 - load_and_process_book - Text preprocessed. Number of chunks: 183
2024-10-24 23:26:37,725 - root - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:26:38,037 - root - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:27:40,146 - root - INFO - src/embedding.py:46 - save_chunks_and_embeddings - Saving 183 chunks, their embeddings, and processed text to data/embeddings/2874edd83f926b01da779ebb81f68a45_chunks_embeddings.pkl.
2024-10-24 23:27:40,152 - root - INFO - src/embedding.py:49 - save_chunks_and_embeddings - Data saved to data/embeddings/2874edd83f926b01da779ebb81f68a45_chunks_embeddings.pkl.
2024-10-24 23:27:40,153 - root - INFO - src/cli.py:38 - load_and_process_book - Book data created. Number of chunks: 183
2024-10-24 23:27:40,153 - root - INFO - app.py:53 - index - Book data loaded: 183 chunks
2024-10-24 23:29:19,323 - root - INFO - app.py:34 - index - Index route accessed
2024-10-24 23:29:19,324 - root - INFO - app.py:36 - index - POST request received
2024-10-24 23:29:19,327 - root - WARNING - app.py:38 - index - No file part in the request
2024-10-24 23:30:34,898 - root - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:30:35,307 - root - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:30:35,674 - root - INFO - src/cli.py:54 - run_cli - Starting the RAG system
2024-10-24 23:31:15,304 - root - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:31:19,092 - root - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:31:19,320 - root - INFO - src/cli.py:54 - run_cli - Starting the RAG system
2024-10-24 23:34:53,274 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 23:34:53,275 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 23:34:53,282 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:34:53,283 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:34:53,292 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:34:54,979 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:34:54,982 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:34:56,579 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:34:56,579 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:34:56,812 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 23:34:56,815 - root - INFO - cli.py:54 - run_cli - Starting the RAG system
2024-10-24 23:34:56,816 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 23:34:56,817 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 23:35:11,527 - root - INFO - cli.py:65 - run_cli - Loading book from: tests/data/ford.txt
2024-10-24 23:35:11,528 - root - INFO - cli.py:25 - load_and_process_book - Starting to process book content
2024-10-24 23:35:11,528 - root - INFO - text_processing.py:75 - load_and_preprocess_text - Preprocessing text content
2024-10-24 23:35:11,825 - root - INFO - text_processing.py:81 - load_and_preprocess_text - Extracted 0 dates, 0 named entities, and 1 key phrases from the text
2024-10-24 23:35:11,825 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 23:35:11,825 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1 chunks
2024-10-24 23:35:11,825 - root - INFO - cli.py:28 - load_and_process_book - Text preprocessed. Number of chunks: 1
2024-10-24 23:35:11,825 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:35:11,826 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:35:11,826 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:35:12,203 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:35:12,203 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:35:12,596 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:35:12,596 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:35:12,598 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x10b219580>, 'json_data': {'input': ['tests/data/ford.txt'], 'model': 'text-embedding-3-small', 'encoding_format': 'base64'}}
2024-10-24 23:35:12,626 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-24 23:35:12,627 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-24 23:35:12,759 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b2c8a70>
2024-10-24 23:35:12,759 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.started ssl_context=<ssl.SSLContext object at 0x10b1237d0> server_hostname='api.openai.com' timeout=5.0
2024-10-24 23:35:12,797 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b2c9d00>
2024-10-24 23:35:12,797 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-24 23:35:12,798 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-24 23:35:12,798 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-24 23:35:12,798 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-24 23:35:12,798 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-24 23:35:13,257 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Thu, 24 Oct 2024 22:35:13 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-3-small'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'60'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999996'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'0s'), (b'x-request-id', b'req_0df48eb255c2864c8890f6ceebaea2d4'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=kfoN7.mIsyEiHfD9qMtMs5UlxzrFQwg6ykmHSZHkUwM-1729809313-1.0.1.1-uO52BWBmkdVKYIN7rSrDyhG9eInAgmzvNXa7vbi8B_KjZRqYk0wxvitjrK4A7lJWMTlO7f_mCUDWidE7d64aKg; path=/; expires=Thu, 24-Oct-24 23:05:13 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=Uxe5tyi8XzZSkhnEYxf0F_eNKsfyzKhO2OTkTWdrnB4-1729809313334-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d7d704da97d03e6-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-24 23:35:13,258 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-24 23:35:13,258 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-24 23:35:13,281 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-24 23:35:13,281 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-24 23:35:13,281 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-24 23:35:13,281 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers([('date', 'Thu, 24 Oct 2024 22:35:13 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-allow-origin', '*'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-model', 'text-embedding-3-small'), ('openai-organization', 'uinside'), ('openai-processing-ms', '60'), ('openai-version', '2020-10-01'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '5000000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '4999996'), ('x-ratelimit-reset-requests', '6ms'), ('x-ratelimit-reset-tokens', '0s'), ('x-request-id', 'req_0df48eb255c2864c8890f6ceebaea2d4'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=kfoN7.mIsyEiHfD9qMtMs5UlxzrFQwg6ykmHSZHkUwM-1729809313-1.0.1.1-uO52BWBmkdVKYIN7rSrDyhG9eInAgmzvNXa7vbi8B_KjZRqYk0wxvitjrK4A7lJWMTlO7f_mCUDWidE7d64aKg; path=/; expires=Thu, 24-Oct-24 23:05:13 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=Uxe5tyi8XzZSkhnEYxf0F_eNKsfyzKhO2OTkTWdrnB4-1729809313334-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d7d704da97d03e6-LIS'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-24 23:35:13,281 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_0df48eb255c2864c8890f6ceebaea2d4
2024-10-24 23:35:14,188 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-24 23:35:14,346 - root - INFO - embedding.py:46 - save_chunks_and_embeddings - Saving 1 chunks, their embeddings, and processed text to data/embeddings/65d642d83b720a1e924d3ebef3a845fe_chunks_embeddings.pkl.
2024-10-24 23:35:14,346 - root - INFO - embedding.py:49 - save_chunks_and_embeddings - Data saved to data/embeddings/65d642d83b720a1e924d3ebef3a845fe_chunks_embeddings.pkl.
2024-10-24 23:35:14,347 - root - INFO - cli.py:38 - load_and_process_book - Book data created. Number of chunks: 1
2024-10-24 23:35:14,347 - root - INFO - cli.py:67 - run_cli - Book loaded and preprocessed. Text split into 1 chunks
2024-10-24 23:35:29,904 - root - INFO - cli.py:77 - run_cli - Received query:   ?
2024-10-24 23:35:29,904 - root - INFO - cli.py:43 - answer_question - Received query:   ?
2024-10-24 23:35:29,905 - root - INFO - rag.py:68 - rag_query - Processing RAG query:   ?
2024-10-24 23:35:29,905 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:35:29,907 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:35:29,908 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:35:30,327 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:35:30,328 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:35:30,603 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:35:30,603 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:35:30,611 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:35:30,611 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:35:30,611 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:35:31,192 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:35:31,193 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:35:31,462 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:35:31,463 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:35:31,465 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x11355d9e0>, 'json_data': {'input': ['  ?'], 'model': 'text-embedding-3-small', 'encoding_format': 'base64'}}
2024-10-24 23:35:31,465 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-24 23:35:31,466 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.started
2024-10-24 23:35:31,466 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.complete
2024-10-24 23:35:31,466 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-24 23:35:31,502 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b2fb7a0>
2024-10-24 23:35:31,502 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.started ssl_context=<ssl.SSLContext object at 0x10b1237d0> server_hostname='api.openai.com' timeout=5.0
2024-10-24 23:35:31,542 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b2fa810>
2024-10-24 23:35:31,543 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-24 23:35:31,543 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-24 23:35:31,543 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-24 23:35:31,543 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-24 23:35:31,543 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-24 23:35:31,988 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Thu, 24 Oct 2024 22:35:32 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-3-small'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'72'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999992'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'0s'), (b'x-request-id', b'req_b5e0b85fb06abc18143b17a9ebd759f3'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d7d70c2dc08e3c4-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-24 23:35:31,990 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-24 23:35:31,990 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-24 23:35:31,998 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-24 23:35:31,998 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-24 23:35:31,998 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-24 23:35:31,998 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers({'date': 'Thu, 24 Oct 2024 22:35:32 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-allow-origin': '*', 'access-control-expose-headers': 'X-Request-ID', 'openai-model': 'text-embedding-3-small', 'openai-organization': 'uinside', 'openai-processing-ms': '72', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '5000000', 'x-ratelimit-remaining-requests': '9999', 'x-ratelimit-remaining-tokens': '4999992', 'x-ratelimit-reset-requests': '6ms', 'x-ratelimit-reset-tokens': '0s', 'x-request-id': 'req_b5e0b85fb06abc18143b17a9ebd759f3', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d7d70c2dc08e3c4-LIS', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-24 23:35:31,999 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_b5e0b85fb06abc18143b17a9ebd759f3
2024-10-24 23:35:32,792 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-24 23:35:33,726 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"results":[],"matches":[{"id":"0","score":1,"values":[],"metadata":{"chunk":"\xd0\x9a\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82\xd0\xb0 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe?"}},{"id":"c4532a84961f92ab47be24889d3090b0","score":0.25741294,"values":[],"metadata":{"text":"What was the significance of the \'crush space\' in the Pinto\'s design, and how did it compare to other vehicles?"}},{"id":"381ff60ffe74542b971aeaa2148a488c","score":0.24771373,"values":[],"metadata":{"text":"What was the model year of the Ford Pinto involved in the accident?"}},{"id":"d5ecdbd9489bb32b1d887074f67e7fa5","score":0.221266523,"values":[],"metadata":{"text":"How did the court define \'malice\' in the context of the Ford Pinto case?"}},{"id":"7c25ca08798757a5d15caefbcf6d0c6a","score":0.2174308,"values":[],"metadata":{"text":"How did Ford\'s \'rush\' development of the Pinto affect its safety design?"}},{"id":"51bf0066086639adb0a494086a5121ce","score":0.209419027,"values":[],"metadata":{"text":"Who was the executive vice president of Ford who conceived the Pinto project?"}},{"id":"032d6d9f7cf883f483068a2d1d3ea7d0","score":0.202357724,"values":[],"metadata":{"text":"What was the speed of the Ford Galaxie at the moment of impact with the Pinto?"}},{"id":"cb1f75b9db1ebda19c630ecdc7e299f0","score":0.195930511,"values":[],"metadata":{"text":"How did Ford\'s internal memo about the cost-benefit analysis of safety improvements come to light during the trial?"}},{"id":"01e59f8ef084bd6a4d99f9067667d768","score":0.192188159,"values":[],"metadata":{"text":"What was the weight target for the Pinto set by Ford?"}},{"id":"6baf920636bb0e7a14c37c499f0a135f","score":0.190332636,"values":[],"metadata":{"text":"What factors influenced the placement of the fuel tank in the Ford Pinto?"}}],"namespace":"","usage":{"readUnits":6}}'
2024-10-24 23:35:33,729 - root - INFO - openai_service.py:40 - generate_answer - Generating answer for query:   ?
2024-10-24 23:35:33,737 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful assistant specialized in extracting precise information from texts. Focus on providing accurate information. If the exact information is not available, explain what is known and what is missing.'}, {'role': 'user', 'content': 'Context: Original text chunks and metadata:\n\nChunk 1 (score: 1.00):   ?\n\nChunk 2 (score: 0.26): \n\nChunk 3 (score: 0.25): \n\nChunk 4 (score: 0.22): \n\nChunk 5 (score: 0.22): \n\nChunk 6 (score: 0.21): \n\nChunk 7 (score: 0.20): \n\nChunk 8 (score: 0.20): \n\nChunk 9 (score: 0.19): \n\nChunk 10 (score: 0.19): \n\nQuestion:   ?\n\nQuestion:   ?\n\nProvide a concise answer based on the context. If specific information is not available, briefly explain what is known and what is missing.'}], 'model': 'gpt-4o-mini', 'max_tokens': 15000}}
2024-10-24 23:35:33,737 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-24 23:35:33,738 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-24 23:35:33,773 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b2d9c10>
2024-10-24 23:35:33,773 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.started ssl_context=<ssl.SSLContext object at 0x10b1cef50> server_hostname='api.openai.com' timeout=5.0
2024-10-24 23:35:33,810 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b2d8e00>
2024-10-24 23:35:33,810 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-24 23:35:33,810 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-24 23:35:33,810 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-24 23:35:33,810 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-24 23:35:33,810 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-24 23:35:35,112 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Thu, 24 Oct 2024 22:35:35 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'1103'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9991828'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'49ms'), (b'x-request-id', b'req_f6915bc70065c3f353c1157bb5716266'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=pXdubV2CJhI87CV_cuLDriWjCoN2mOOvf.7PJlEwITM-1729809335-1.0.1.1-1QoXEavmeQkXzAKNzBFwUOBHgSt3hN_rIQHotj9KFGzfwgE9sSStrFiD4DPZ3OkPwXxtRD_IeUdGPAIPmWPadw; path=/; expires=Thu, 24-Oct-24 23:05:35 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=VwKxo.jKuhRAkHxOVoTswXlBCBA1pK7vPVVqlbUn0A8-1729809335188-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d7d70d0f981e3bd-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-24 23:35:35,112 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-24 23:35:35,113 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-24 23:35:35,113 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-24 23:35:35,113 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-24 23:35:35,113 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-24 23:35:35,113 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Thu, 24 Oct 2024 22:35:35 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'uinside'), ('openai-processing-ms', '1103'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9991828'), ('x-ratelimit-reset-requests', '6ms'), ('x-ratelimit-reset-tokens', '49ms'), ('x-request-id', 'req_f6915bc70065c3f353c1157bb5716266'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=pXdubV2CJhI87CV_cuLDriWjCoN2mOOvf.7PJlEwITM-1729809335-1.0.1.1-1QoXEavmeQkXzAKNzBFwUOBHgSt3hN_rIQHotj9KFGzfwgE9sSStrFiD4DPZ3OkPwXxtRD_IeUdGPAIPmWPadw; path=/; expires=Thu, 24-Oct-24 23:05:35 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=VwKxo.jKuhRAkHxOVoTswXlBCBA1pK7vPVVqlbUn0A8-1729809335188-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d7d70d0f981e3bd-LIS'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-24 23:35:35,113 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_f6915bc70065c3f353c1157bb5716266
2024-10-24 23:35:35,119 - root - INFO - rag.py:80 - rag_query - Generated answer: The context does not provide specific information about the color of the car. The only available text is a repeated question, "  ?" (which means "What color is the car?"). Therefore, we know the question being asked but lack any details regarding the actual color of the car.
2024-10-24 23:35:35,123 - root - INFO - cli.py:46 - answer_question - Generated answer: The context does not provide specific information about the color of the car. The only available text is a repeated question, "  ?" (which means "What color is the car?"). Therefore, we know the question being asked but lack any details regarding the actual color of the car.
2024-10-24 23:35:58,923 - root - INFO - cli.py:77 - run_cli - Received query:     ?
2024-10-24 23:35:58,924 - root - INFO - cli.py:43 - answer_question - Received query:     ?
2024-10-24 23:35:58,924 - root - INFO - rag.py:68 - rag_query - Processing RAG query:     ?
2024-10-24 23:35:58,924 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:35:58,925 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:35:58,925 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:35:59,342 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:35:59,343 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:35:59,971 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:35:59,971 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:35:59,972 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:35:59,972 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:35:59,972 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:36:00,373 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:36:00,374 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:36:00,687 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:36:00,688 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:36:00,689 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x11355da80>, 'json_data': {'input': ['    ?'], 'model': 'text-embedding-3-small', 'encoding_format': 'base64'}}
2024-10-24 23:36:00,690 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-24 23:36:00,691 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.started
2024-10-24 23:36:00,691 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.complete
2024-10-24 23:36:00,691 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-24 23:36:00,816 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b2e7a70>
2024-10-24 23:36:00,817 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.started ssl_context=<ssl.SSLContext object at 0x10b1237d0> server_hostname='api.openai.com' timeout=5.0
2024-10-24 23:36:00,863 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b2e7740>
2024-10-24 23:36:00,864 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-24 23:36:00,864 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-24 23:36:00,864 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-24 23:36:00,867 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-24 23:36:00,872 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-24 23:36:01,095 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Thu, 24 Oct 2024 22:36:01 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-3-small'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'67'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999987'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'0s'), (b'x-request-id', b'req_6490e4374ddfffe072cd4a1dc6a6af31'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d7d717a1f127113-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-24 23:36:01,095 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-24 23:36:01,096 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-24 23:36:01,096 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-24 23:36:01,096 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-24 23:36:01,096 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-24 23:36:01,097 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers({'date': 'Thu, 24 Oct 2024 22:36:01 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-allow-origin': '*', 'access-control-expose-headers': 'X-Request-ID', 'openai-model': 'text-embedding-3-small', 'openai-organization': 'uinside', 'openai-processing-ms': '67', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '5000000', 'x-ratelimit-remaining-requests': '9999', 'x-ratelimit-remaining-tokens': '4999987', 'x-ratelimit-reset-requests': '6ms', 'x-ratelimit-reset-tokens': '0s', 'x-request-id': 'req_6490e4374ddfffe072cd4a1dc6a6af31', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d7d717a1f127113-LIS', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-24 23:36:01,097 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_6490e4374ddfffe072cd4a1dc6a6af31
2024-10-24 23:36:01,920 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-24 23:36:02,685 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"results":[],"matches":[{"id":"0","score":1,"values":[],"metadata":{"chunk":"\xd0\x9a\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xb4\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd0\xb9 \xd0\xb3\xd0\xbe\xd0\xb4 \xd0\xb8 \xd0\xbc\xd0\xb0\xd1\x80\xd0\xba\xd0\xb0?"}},{"id":"381ff60ffe74542b971aeaa2148a488c","score":0.413662314,"values":[],"metadata":{"text":"What was the model year of the Ford Pinto involved in the accident?"}},{"id":"c4532a84961f92ab47be24889d3090b0","score":0.260540605,"values":[],"metadata":{"text":"What was the significance of the \'crush space\' in the Pinto\'s design, and how did it compare to other vehicles?"}},{"id":"27","score":0.246054545,"values":[],"metadata":{"chunk":". . 125 17.2 \xd0\x9c\xd0\xbe\xd0\xb4\xd1\x83\xd0\xbb\xd1\x8clogging . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 126 17.3 \xd0\xa1\xd0\xb5\xd1\x80\xd0\xb8\xd1\x8f\xc2\xab\xd0\x9c\xd0\xbe\xd0\xb4\xd1\x83\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xc2\xbb . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 128 17.4 \xd0\xa0\xd0\xb5\xd0\xb7\xd1\x8e\xd0\xbc\xd0\xb5 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 128 18 \xd0\x94\xd0\xbe\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xbd\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe 129 18.1 \xd0\x9f\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb0\xd0\xba\xd0\xbe\xd1\x80\xd1\x82\xd0\xb5\xd0\xb6\xd0\xb5\xd0\xb9 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 129 18.2 \xd0\xa1\xd0\xbf\xd0\xb5\xd1\x86\xd0\xb8\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd0\xb5\xd0\xbc\xd0\xb5\xd1\x82\xd0\xbe\xd0\xb4\xd1\x8b . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 130 18.3 \xd0\x91\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb8\xd0\xb2\xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb2\xd1\x8b\xd1\x80\xd0\xb0\xd0\xb6\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 130 18.4 Lambda-\xd1\x84\xd0\xbe\xd1\x80\xd0\xbc\xd1\x8b . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 131 18.5 \xd0\x93\xd0\xb5\xd0\xbd\xd0\xb5\xd1\x80\xd0\xb0\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd1\x81\xd0\xbf\xd0\xb8\xd1\x81\xd0\xba\xd0\xbe\xd0\xb2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ."}},{"id":"7c25ca08798757a5d15caefbcf6d0c6a","score":0.245544374,"values":[],"metadata":{"text":"How did Ford\'s \'rush\' development of the Pinto affect its safety design?"}},{"id":"4af6bd37a7ac7aa66d6fa4606aaa82b0","score":0.223532379,"values":[],"metadata":{"text":"What was the estimated cost to fix the Pinto\'s fuel tank design, and how did Ford justify not implementing it?"}},{"id":"34d53f2e1e7ce76e0573ae33e295b16d","score":0.222371861,"values":[],"metadata":{"text":"What evidence suggested that Ford was aware of the Pinto\'s safety issues before its release?"}},{"id":"51bf0066086639adb0a494086a5121ce","score":0.217901215,"values":[],"metadata":{"text":"Who was the executive vice president of Ford who conceived the Pinto project?"}},{"id":"032d6d9f7cf883f483068a2d1d3ea7d0","score":0.213339031,"values":[],"metadata":{"text":"What was the speed of the Ford Galaxie at the moment of impact with the Pinto?"}},{"id":"01e59f8ef084bd6a4d99f9067667d768","score":0.211256489,"values":[],"metadata":{"text":"What was the weight target for the Pinto set by Ford?"}}],"namespace":"","usage":{"readUnits":6}}'
2024-10-24 23:36:02,687 - root - INFO - openai_service.py:40 - generate_answer - Generating answer for query:     ?
2024-10-24 23:36:02,700 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful assistant specialized in extracting precise information from texts. Focus on providing accurate information. If the exact information is not available, explain what is known and what is missing.'}, {'role': 'user', 'content': 'Context: Original text chunks and metadata:\n\nChunk 1 (score: 1.00):     ?\n\nChunk 2 (score: 0.41): \n\nChunk 3 (score: 0.26): \n\nChunk 4 (score: 0.25): . . 125 17.2 logging . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 126 17.3  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 128 17.4  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 128 18  129 18.1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 129 18.2  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 130 18.3  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 130 18.4 Lambda- . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 131 18.5  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n\nChunk 5 (score: 0.25): \n\nChunk 6 (score: 0.22): \n\nChunk 7 (score: 0.22): \n\nChunk 8 (score: 0.22): \n\nChunk 9 (score: 0.21): \n\nChunk 10 (score: 0.21): \n\nQuestion:     ?\n\nQuestion:     ?\n\nProvide a concise answer based on the context. If specific information is not available, briefly explain what is known and what is missing.'}], 'model': 'gpt-4o-mini', 'max_tokens': 15000}}
2024-10-24 23:36:02,701 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-24 23:36:02,701 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.started
2024-10-24 23:36:02,702 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.complete
2024-10-24 23:36:02,702 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-24 23:36:02,740 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b2f34d0>
2024-10-24 23:36:02,741 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.started ssl_context=<ssl.SSLContext object at 0x10b1cef50> server_hostname='api.openai.com' timeout=5.0
2024-10-24 23:36:02,783 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b2fa2d0>
2024-10-24 23:36:02,783 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-24 23:36:02,784 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-24 23:36:02,784 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-24 23:36:02,784 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-24 23:36:02,784 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-24 23:36:03,656 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Thu, 24 Oct 2024 22:36:03 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'687'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9991828'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'49ms'), (b'x-request-id', b'req_e2fc74bf3598bcd3188ed07ff28345d1'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d7d71860d7c48a4-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-24 23:36:03,657 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-24 23:36:03,657 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-24 23:36:03,657 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-24 23:36:03,657 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-24 23:36:03,657 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-24 23:36:03,657 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Thu, 24 Oct 2024 22:36:03 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'uinside', 'openai-processing-ms': '687', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000000', 'x-ratelimit-remaining-requests': '9999', 'x-ratelimit-remaining-tokens': '9991828', 'x-ratelimit-reset-requests': '6ms', 'x-ratelimit-reset-tokens': '49ms', 'x-request-id': 'req_e2fc74bf3598bcd3188ed07ff28345d1', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d7d71860d7c48a4-LIS', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-24 23:36:03,657 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_e2fc74bf3598bcd3188ed07ff28345d1
2024-10-24 23:36:03,658 - root - INFO - rag.py:80 - rag_query - Generated answer: The context provided does not contain any information regarding the model year or brand of a vehicle. It only includes a question asking for that information and some unrelated text chunks that do not address the inquiry. Therefore, the specific information about the model year and brand is missing.
2024-10-24 23:36:03,661 - root - INFO - cli.py:46 - answer_question - Generated answer: The context provided does not contain any information regarding the model year or brand of a vehicle. It only includes a question asking for that information and some unrelated text chunks that do not address the inquiry. Therefore, the specific information about the model year and brand is missing.
2024-10-24 23:36:50,922 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 23:36:50,923 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 23:36:50,930 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:36:50,930 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:36:50,938 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:36:51,266 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:36:51,269 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:36:51,599 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:36:51,600 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:36:51,832 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 23:36:51,840 - root - INFO - cli.py:54 - run_cli - Starting the RAG system
2024-10-24 23:36:51,841 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 23:36:51,842 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 23:37:06,298 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 23:37:06,299 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 23:37:06,306 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:37:06,306 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:37:06,317 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:37:06,645 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:37:06,647 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:37:07,156 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:37:07,156 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:37:07,553 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 23:37:08,517 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 23:37:08,519 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 23:37:08,525 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:37:08,525 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:37:08,529 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:37:08,836 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:37:08,837 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:37:09,195 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:37:09,195 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:37:09,506 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 23:44:42,934 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 23:44:42,935 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 23:44:42,942 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:44:42,943 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:44:42,951 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:44:43,513 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:44:43,513 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:44:43,839 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:44:43,839 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:44:45,061 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 23:45:33,108 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 23:45:33,109 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 23:45:33,117 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:45:33,117 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:45:33,126 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:45:34,597 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:45:34,597 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:45:36,976 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:45:36,977 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:45:37,204 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 23:47:00,208 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 23:47:00,209 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 23:47:00,216 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:47:00,216 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:47:00,224 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:47:00,545 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:47:00,547 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:47:00,886 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:47:00,886 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:47:01,173 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 23:47:34,229 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 23:47:34,230 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 23:47:34,238 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:47:34,239 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:47:34,248 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:47:34,607 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:47:34,609 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:47:35,105 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:47:35,106 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:47:35,366 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 23:49:22,741 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 23:49:22,741 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 23:49:22,748 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:49:22,748 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:49:22,756 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:49:23,076 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:49:23,077 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:49:23,430 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:49:23,430 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:49:23,662 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 23:49:23,668 - root - INFO - cli.py:53 - run_cli - Starting the RAG system
2024-10-24 23:49:23,669 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 23:49:23,670 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 23:49:37,109 - root - INFO - cli.py:64 - run_cli - Loading book from: uploads/ford.txt
2024-10-24 23:49:37,109 - root - INFO - cli.py:25 - load_and_process_book - Starting to process book content
2024-10-24 23:49:37,109 - root - INFO - text_processing.py:75 - load_and_preprocess_text - Preprocessing text content
2024-10-24 23:49:37,391 - root - INFO - text_processing.py:81 - load_and_preprocess_text - Extracted 0 dates, 0 named entities, and 1 key phrases from the text
2024-10-24 23:49:37,392 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 23:49:37,392 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1 chunks
2024-10-24 23:49:37,392 - root - INFO - cli.py:28 - load_and_process_book - Text preprocessed. Number of chunks: 1
2024-10-24 23:49:37,392 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:49:37,392 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:49:37,392 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:49:37,869 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:49:37,869 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:49:38,130 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:49:38,130 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:49:38,131 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x10b2a5580>, 'json_data': {'input': ['uploads/ford.txt'], 'model': 'text-embedding-3-small', 'encoding_format': 'base64'}}
2024-10-24 23:49:38,157 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-24 23:49:38,158 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-24 23:49:38,333 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b3546e0>
2024-10-24 23:49:38,333 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.started ssl_context=<ssl.SSLContext object at 0x10b1af7d0> server_hostname='api.openai.com' timeout=5.0
2024-10-24 23:49:38,374 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b355580>
2024-10-24 23:49:38,374 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-24 23:49:38,375 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-24 23:49:38,375 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-24 23:49:38,375 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-24 23:49:38,376 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-24 23:49:38,614 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Thu, 24 Oct 2024 22:49:38 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-3-small'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'81'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999995'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'0s'), (b'x-request-id', b'req_c7732d411f6065ec06feb83fd0d2d681'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=r.UFYyjc0_cKbWE895adTbhJKBmD5N0vllmcL66LWZM-1729810178-1.0.1.1-f5TzV564f3wVQExD5xK44NGFw3od_D9BC2UIUDSpziLtaeT_2B_EsI1mkuZVvbE14Lb6SDFchwkXsm3rfbeghA; path=/; expires=Thu, 24-Oct-24 23:19:38 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=83TyLY6shvFwCQREEkLzj7WwUJloVPEJtBnI8tHB5_Q-1729810178669-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d7d856f6c92785f-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-24 23:49:38,616 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-24 23:49:38,616 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-24 23:49:38,617 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-24 23:49:38,617 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-24 23:49:38,618 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-24 23:49:38,618 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers([('date', 'Thu, 24 Oct 2024 22:49:38 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-allow-origin', '*'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-model', 'text-embedding-3-small'), ('openai-organization', 'uinside'), ('openai-processing-ms', '81'), ('openai-version', '2020-10-01'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '5000000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '4999995'), ('x-ratelimit-reset-requests', '6ms'), ('x-ratelimit-reset-tokens', '0s'), ('x-request-id', 'req_c7732d411f6065ec06feb83fd0d2d681'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=r.UFYyjc0_cKbWE895adTbhJKBmD5N0vllmcL66LWZM-1729810178-1.0.1.1-f5TzV564f3wVQExD5xK44NGFw3od_D9BC2UIUDSpziLtaeT_2B_EsI1mkuZVvbE14Lb6SDFchwkXsm3rfbeghA; path=/; expires=Thu, 24-Oct-24 23:19:38 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=83TyLY6shvFwCQREEkLzj7WwUJloVPEJtBnI8tHB5_Q-1729810178669-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d7d856f6c92785f-LIS'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-24 23:49:38,618 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_c7732d411f6065ec06feb83fd0d2d681
2024-10-24 23:49:39,643 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-24 23:49:39,835 - root - INFO - embedding.py:46 - save_chunks_and_embeddings - Saving 1 chunks, their embeddings, and processed text to data/embeddings/f516f4df12faa415bf60a3e635a5fd4a_chunks_embeddings.pkl.
2024-10-24 23:49:39,835 - root - INFO - embedding.py:49 - save_chunks_and_embeddings - Data saved to data/embeddings/f516f4df12faa415bf60a3e635a5fd4a_chunks_embeddings.pkl.
2024-10-24 23:49:39,835 - root - INFO - cli.py:38 - load_and_process_book - Book data created. Number of chunks: 1
2024-10-24 23:49:39,835 - root - INFO - cli.py:66 - run_cli - Book loaded and preprocessed. Text split into 1 chunks
2024-10-24 23:50:08,102 - root - INFO - cli.py:76 - run_cli - Received query:     
2024-10-24 23:50:08,103 - root - INFO - cli.py:43 - answer_question - Received query:     
2024-10-24 23:50:08,103 - root - INFO - rag.py:67 - rag_query - Processing query:     
2024-10-24 23:50:08,103 - root - ERROR - rag.py:76 - rag_query - Error in rag_query: 'BookDataInterface' object has no attribute 'get_relevant_chunks'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 69, in rag_query
    relevant_chunks = book_data.get_relevant_chunks(question)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'BookDataInterface' object has no attribute 'get_relevant_chunks'
2024-10-24 23:50:08,106 - root - INFO - cli.py:46 - answer_question - Generated answer: An error occurred while processing the query: 'BookDataInterface' object has no attribute 'get_relevant_chunks'
2024-10-25 13:52:01,401 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 13:52:01,402 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 13:52:01,408 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:52:01,409 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:52:01,418 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:52:02,084 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:52:02,087 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:52:02,427 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:52:02,428 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:52:02,823 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 13:52:04,552 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-25 13:52:04,566 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1389 chunks
2024-10-25 13:52:04,569 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:52:04,569 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:52:04,569 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:52:05,017 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:52:05,019 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:52:06,465 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:52:06,465 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:52:33,410 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"code":11,"message":"Error, message length too large: found 13124219 bytes, the limit is: 4194304 bytes","details":[]}'
2024-10-25 13:52:34,020 - root - INFO - conftest.py:58 - timer - Test test_main_cli_mode took 0.00 seconds
2024-10-25 13:52:34,021 - root - INFO - conftest.py:58 - timer - Test test_main_api_mode took 0.00 seconds
2024-10-25 13:52:34,021 - root - INFO - conftest.py:58 - timer - Test test_main_invalid_mode took 0.00 seconds
2024-10-25 13:52:34,022 - root - INFO - cli.py:25 - load_and_process_book - Starting to process book content
2024-10-25 13:52:34,022 - root - INFO - cli.py:28 - load_and_process_book - Text preprocessed. Number of chunks: 2
2024-10-25 13:52:34,022 - root - INFO - cli.py:38 - load_and_process_book - Book data created. Number of chunks: 2
2024-10-25 13:52:34,022 - root - INFO - conftest.py:58 - timer - Test test_load_and_process_book took 0.00 seconds
2024-10-25 13:52:34,025 - root - INFO - conftest.py:58 - timer - Test test_answer_question took 0.00 seconds
2024-10-25 13:52:34,026 - root - INFO - cli.py:53 - run_cli - Starting the RAG system
2024-10-25 13:52:34,027 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 13:52:34,027 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 13:52:34,034 - root - INFO - cli.py:64 - run_cli - Loading book from: input1
2024-10-25 13:52:34,035 - root - INFO - cli.py:66 - run_cli - Book loaded and preprocessed. Text split into 2 chunks
2024-10-25 13:52:34,035 - root - ERROR - cli.py:84 - run_cli - An error occurred: 
2024-10-25 13:52:34,035 - root - INFO - cli.py:87 - run_cli - Exiting the RAG system
2024-10-25 13:52:34,036 - root - INFO - conftest.py:58 - timer - Test test_run_cli[input1] took 0.01 seconds
2024-10-25 13:52:34,037 - root - INFO - cli.py:53 - run_cli - Starting the RAG system
2024-10-25 13:52:34,038 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 13:52:34,038 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 13:52:34,044 - root - INFO - cli.py:64 - run_cli - Loading book from: input2
2024-10-25 13:52:34,044 - root - INFO - cli.py:66 - run_cli - Book loaded and preprocessed. Text split into 2 chunks
2024-10-25 13:52:34,044 - root - ERROR - cli.py:84 - run_cli - An error occurred: 
2024-10-25 13:52:34,044 - root - INFO - cli.py:87 - run_cli - Exiting the RAG system
2024-10-25 13:52:34,045 - root - INFO - conftest.py:58 - timer - Test test_run_cli[input2] took 0.01 seconds
2024-10-25 13:52:34,046 - root - INFO - cli.py:53 - run_cli - Starting the RAG system
2024-10-25 13:52:34,046 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 13:52:34,046 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 13:52:34,052 - root - ERROR - cli.py:84 - run_cli - An error occurred: The file nonexistent_file.txt does not exist.
2024-10-25 13:52:34,052 - root - INFO - cli.py:87 - run_cli - Exiting the RAG system
2024-10-25 13:52:34,053 - root - INFO - conftest.py:58 - timer - Test test_run_cli_file_not_found took 0.01 seconds
2024-10-25 13:52:34,053 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:52:34,054 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:52:34,054 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:52:34,555 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:52:34,557 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:52:34,928 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:52:34,928 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:52:35,891 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":2}'
2024-10-25 13:52:35,893 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_length[chunks0-2] took 1.84 seconds
2024-10-25 13:52:35,897 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:52:35,897 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:52:35,898 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:52:36,420 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:52:36,422 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:52:36,700 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:52:36,701 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:52:37,445 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 13:52:37,448 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_length[chunks1-1] took 1.55 seconds
2024-10-25 13:52:37,452 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:52:37,453 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:52:37,453 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:52:38,044 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:52:38,046 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:52:38,449 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:52:38,449 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:52:38,452 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_length[chunks2-0] took 1.00 seconds
2024-10-25 13:52:38,455 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:52:38,455 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:52:38,456 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:52:38,796 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:52:38,798 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:52:39,475 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:52:39,476 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:52:40,248 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 13:52:40,257 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_structure took 1.80 seconds
2024-10-25 13:52:40,259 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:52:40,260 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:52:40,260 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:52:40,629 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:52:40,631 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:52:40,951 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:52:40,952 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:52:40,979 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_api_error took 0.72 seconds
2024-10-25 13:52:40,982 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:52:40,982 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:52:40,982 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:52:41,297 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:52:41,298 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:52:41,713 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:52:41,714 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:52:41,717 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_various_lengths[-1536] took 0.74 seconds
2024-10-25 13:52:41,723 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:52:41,723 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:52:41,724 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:52:42,105 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:52:42,107 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:52:42,797 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:52:42,798 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:52:42,801 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_various_lengths[Short text-1536] took 1.08 seconds
2024-10-25 13:52:42,806 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:52:42,806 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:52:42,807 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:52:43,113 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:52:43,114 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:52:43,624 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:52:43,625 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:52:43,630 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_various_lengths[AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA-1536] took 0.83 seconds
2024-10-25 13:52:43,635 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_with_cache took 0.00 seconds
2024-10-25 13:52:43,637 - root - INFO - file_processor.py:15 - process_file - Processing file: /Users/eduardizgorodin/Projects/rag_book_assistant/tests/data/test.pdf with extension: .pdf
2024-10-25 13:52:43,638 - root - INFO - file_processor.py:26 - process_file - Using processor for extension: .pdf
2024-10-25 13:52:43,641 - root - INFO - conftest.py:58 - timer - Test test_process_pdf took 0.00 seconds
2024-10-25 13:52:43,643 - root - INFO - file_processor.py:15 - process_file - Processing file: /Users/eduardizgorodin/Projects/rag_book_assistant/tests/data/test.docx with extension: .docx
2024-10-25 13:52:43,643 - root - INFO - file_processor.py:26 - process_file - Using processor for extension: .docx
2024-10-25 13:52:43,660 - root - INFO - conftest.py:58 - timer - Test test_process_docx took 0.02 seconds
2024-10-25 13:52:43,661 - root - INFO - file_processor.py:15 - process_file - Processing file: /Users/eduardizgorodin/Projects/rag_book_assistant/tests/data/test.odt with extension: .odt
2024-10-25 13:52:43,661 - root - INFO - file_processor.py:26 - process_file - Using processor for extension: .odt
2024-10-25 13:52:43,665 - root - INFO - conftest.py:58 - timer - Test test_process_odt took 0.00 seconds
2024-10-25 13:52:43,666 - root - INFO - file_processor.py:15 - process_file - Processing file: /Users/eduardizgorodin/Projects/rag_book_assistant/tests/data/test.txt with extension: .txt
2024-10-25 13:52:43,666 - root - INFO - file_processor.py:26 - process_file - Using processor for extension: .txt
2024-10-25 13:52:43,667 - root - INFO - conftest.py:58 - timer - Test test_process_txt took 0.00 seconds
2024-10-25 13:52:43,669 - root - INFO - file_processor.py:15 - process_file - Processing file: /private/var/folders/dd/70xsqyd921gd18src4pk119r0000gn/T/pytest-of-eduardizgorodin/pytest-11/test_unsupported_file_format0/test.unsupported with extension: .unsupported
2024-10-25 13:52:43,669 - root - ERROR - file_processor.py:29 - process_file - Unsupported file format: .unsupported
2024-10-25 13:52:43,670 - root - INFO - conftest.py:58 - timer - Test test_unsupported_file_format took 0.00 seconds
2024-10-25 13:52:43,671 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-25 13:52:43,674 - root - INFO - text_processing.py:103 - split_into_chunks - Created 199 chunks
2024-10-25 13:52:43,678 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:52:43,678 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:52:43,678 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:52:44,113 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:52:44,114 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:52:44,770 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:52:44,770 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:52:44,817 - root - INFO - rag.py:67 - rag_query - Processing query: What was the model year of the Ford Pinto involved in the accident?
2024-10-25 13:52:44,817 - root - ERROR - rag.py:76 - rag_query - Error in rag_query: 'BookDataInterface' object has no attribute 'get_relevant_chunks'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 69, in rag_query
    relevant_chunks = book_data.get_relevant_chunks(question)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'BookDataInterface' object has no attribute 'get_relevant_chunks'
2024-10-25 13:52:44,841 - rag_results - INFO - test_ford_pinto_qa.py:94 - test_qa_system - 
Q: What was the model year of the Ford Pinto involved in the accident?
2024-10-25 13:52:44,841 - rag_results - INFO - test_ford_pinto_qa.py:95 - test_qa_system - Expected A: 1972
2024-10-25 13:52:44,841 - rag_results - INFO - test_ford_pinto_qa.py:96 - test_qa_system - System A: An error occurred while processing the query: 'BookDataInterface' object has no attribute 'get_relevant_chunks'
2024-10-25 13:52:44,841 - rag_results - INFO - test_ford_pinto_qa.py:97 - test_qa_system - Is correct: False
2024-10-25 13:52:44,841 - rag_results - INFO - test_ford_pinto_qa.py:98 - test_qa_system - --------------------------------------------------
2024-10-25 13:52:44,844 - root - INFO - conftest.py:58 - timer - Test test_qa_system[qa_pair0] took 0.03 seconds
2024-10-25 13:52:44,851 - root - INFO - conftest.py:58 - timer - Test test_search took 0.01 seconds
2024-10-25 13:52:44,854 - root - INFO - conftest.py:58 - timer - Test test_embedding_weight took 0.00 seconds
2024-10-25 13:52:44,855 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search_initialization took 0.00 seconds
2024-10-25 13:52:46,197 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:52:46,197 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:52:46,197 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:52:46,497 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:52:46,498 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:52:46,797 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:52:46,797 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:52:46,803 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x158a1e020>, 'json_data': {'input': ['AI AI AI AI AI AI AI AI AI AI AI AI AI AI AI ai ai ai ai ai ai ai ai ai ai ai ai ai Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence and and and and and and and and and and machine machine machine machine machine machine machine machine machine machine machine machine machine machine machine simple_machine simple_machine simple_machine simple_machine simple_machine simple_machine simple_machine simple_machine simple_machine simple_machine simple_machine simple_machine simple_machine simple_machine simple_machine motorcar motorcar motorcar motorcar motorcar motorcar motorcar motorcar motorcar motorcar motorcar motorcar motorcar motorcar motorcar learning learning learning learning learning learning learning learning learning learning learning learning learning find_out find_out find_out find_out find_out find_out find_out find_out find_out find_out find_out find_out find_out find_out find_out learnedness learnedness learnedness learnedness learnedness learnedness learnedness learnedness learnedness learnedness learnedness learnedness learnedness learnedness learnedness'], 'model': 'text-embedding-3-small', 'encoding_format': 'base64'}}
2024-10-25 13:52:46,859 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-25 13:52:46,859 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-25 13:52:47,003 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10bff1ee0>
2024-10-25 13:52:47,003 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.started ssl_context=<ssl.SSLContext object at 0x10d2f7b50> server_hostname='api.openai.com' timeout=5.0
2024-10-25 13:52:47,048 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x1621d9640>
2024-10-25 13:52:47,048 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-25 13:52:47,049 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-25 13:52:47,050 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-25 13:52:47,050 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-25 13:52:47,050 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-25 13:52:47,605 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 25 Oct 2024 12:52:47 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-3-small'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'174'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999673'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'3ms'), (b'x-request-id', b'req_bd03629d3992fc42166bcdaf66c2bc36'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=BDLCyGwvYUCQ9YXeeVV6S.KP7e8vswhLN5qqYV5wH.8-1729860767-1.0.1.1-b3Le1P9chGlXoLFWmEByUqdKp806wLy9oWXDw3Uq66hZpq9mQ542KCy7Vp6wdm4NVZ1fiO7kaEwvPWCM6I9fQQ; path=/; expires=Fri, 25-Oct-24 13:22:47 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=BnkyF.7MTbJn3AggY7XCnPuvxlQjiXc5uNnRofXRvzo-1729860767688-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d825882cc44e3bd-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-25 13:52:47,607 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-25 13:52:47,608 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-25 13:52:47,609 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-25 13:52:47,609 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-25 13:52:47,609 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-25 13:52:47,610 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers([('date', 'Fri, 25 Oct 2024 12:52:47 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-allow-origin', '*'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-model', 'text-embedding-3-small'), ('openai-organization', 'uinside'), ('openai-processing-ms', '174'), ('openai-version', '2020-10-01'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '5000000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '4999673'), ('x-ratelimit-reset-requests', '6ms'), ('x-ratelimit-reset-tokens', '3ms'), ('x-request-id', 'req_bd03629d3992fc42166bcdaf66c2bc36'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=BDLCyGwvYUCQ9YXeeVV6S.KP7e8vswhLN5qqYV5wH.8-1729860767-1.0.1.1-b3Le1P9chGlXoLFWmEByUqdKp806wLy9oWXDw3Uq66hZpq9mQ542KCy7Vp6wdm4NVZ1fiO7kaEwvPWCM6I9fQQ; path=/; expires=Fri, 25-Oct-24 13:22:47 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=BnkyF.7MTbJn3AggY7XCnPuvxlQjiXc5uNnRofXRvzo-1729860767688-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d825882cc44e3bd-LIS'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-25 13:52:47,610 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_bd03629d3992fc42166bcdaf66c2bc36
2024-10-25 13:52:48,431 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 13:52:48,438 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search_search took 3.58 seconds
2024-10-25 13:52:48,442 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:52:48,443 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:52:48,443 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:52:48,776 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:52:48,777 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:52:49,146 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:52:49,147 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:52:49,150 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x15dfb7e20>, 'json_data': {'input': ['AI AI AI AI AI AI AI AI AI AI AI AI AI AI AI ai ai ai ai ai ai ai ai ai ai ai ai ai Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence'], 'model': 'text-embedding-3-small', 'encoding_format': 'base64'}}
2024-10-25 13:52:49,152 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-25 13:52:49,153 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-25 13:52:49,153 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-25 13:52:49,153 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-25 13:52:49,154 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-25 13:52:49,154 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-25 13:52:49,926 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 25 Oct 2024 12:52:50 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-3-small'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'205'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999912'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'1ms'), (b'x-request-id', b'req_e17e3eedb2da9aa0c634836032950f4f'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d82588febeae3bd-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-25 13:52:49,927 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-25 13:52:49,928 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-25 13:52:49,929 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-25 13:52:49,930 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-25 13:52:49,930 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-25 13:52:49,930 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers({'date': 'Fri, 25 Oct 2024 12:52:50 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-allow-origin': '*', 'access-control-expose-headers': 'X-Request-ID', 'openai-model': 'text-embedding-3-small', 'openai-organization': 'uinside', 'openai-processing-ms': '205', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '5000000', 'x-ratelimit-remaining-requests': '9999', 'x-ratelimit-remaining-tokens': '4999912', 'x-ratelimit-reset-requests': '6ms', 'x-ratelimit-reset-tokens': '1ms', 'x-request-id': 'req_e17e3eedb2da9aa0c634836032950f4f', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d82588febeae3bd-LIS', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-25 13:52:49,930 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_e17e3eedb2da9aa0c634836032950f4f
2024-10-25 13:52:50,795 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 13:52:50,800 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:52:50,802 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:52:50,802 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:52:51,126 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:52:51,128 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:52:51,760 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:52:51,761 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:52:52,682 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 13:52:52,686 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search_embedding_weight took 4.25 seconds
2024-10-25 13:52:52,713 - root - INFO - conftest.py:58 - timer - Test test_imports took 0.03 seconds
2024-10-25 13:52:52,714 - root - INFO - conftest.py:58 - timer - Test test_config_import took 0.00 seconds
2024-10-25 13:52:52,716 - root - INFO - conftest.py:58 - timer - Test test_openai_api_key took 0.00 seconds
2024-10-25 13:52:52,717 - root - INFO - text_processing.py:75 - load_and_preprocess_text - Preprocessing text content
2024-10-25 13:52:52,894 - root - INFO - text_processing.py:81 - load_and_preprocess_text - Extracted 0 dates, 0 named entities, and 1 key phrases from the text
2024-10-25 13:52:52,894 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-25 13:52:52,894 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1 chunks
2024-10-25 13:52:52,894 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 1000, overlap: 100)
2024-10-25 13:52:52,894 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1 chunks
2024-10-25 13:52:52,895 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:52:52,895 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:52:52,895 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:52:53,399 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:52:53,401 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:52:53,804 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:52:53,805 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:52:54,689 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 13:52:54,690 - root - INFO - conftest.py:58 - timer - Test test_different_book_types[True-test_book.txt] took 1.97 seconds
2024-10-25 13:52:54,691 - root - INFO - text_processing.py:75 - load_and_preprocess_text - Preprocessing text content
2024-10-25 13:52:54,841 - root - INFO - text_processing.py:81 - load_and_preprocess_text - Extracted 0 dates, 0 named entities, and 1 key phrases from the text
2024-10-25 13:52:54,841 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-25 13:52:54,841 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1 chunks
2024-10-25 13:52:54,841 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 1000, overlap: 100)
2024-10-25 13:52:54,841 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1 chunks
2024-10-25 13:52:54,841 - root - INFO - conftest.py:58 - timer - Test test_different_book_types[False-test_book.txt] took 0.15 seconds
2024-10-25 13:52:54,842 - root - INFO - conftest.py:58 - timer - Test test_rag_query[True] took 0.00 seconds
2024-10-25 13:52:54,843 - root - INFO - conftest.py:58 - timer - Test test_rag_query[False] took 0.00 seconds
2024-10-25 13:52:54,950 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:52:55,602 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:52:56,834 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:52:59,065 - root - INFO - pinecone_manager.py:80 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:52:59,477 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:52:59,546 - root - INFO - conftest.py:58 - timer - Test test_pinecone_integration took 4.70 seconds
2024-10-25 13:52:59,547 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 13:52:59,547 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 13:52:59,555 - root - INFO - openai_service.py:40 - generate_answer - Generating answer for query: Test query
2024-10-25 13:52:59,556 - root - INFO - conftest.py:58 - timer - Test test_generate_answer took 0.01 seconds
2024-10-25 13:52:59,556 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 13:52:59,557 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 13:52:59,565 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings took 0.01 seconds
2024-10-25 13:52:59,565 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 13:52:59,566 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 13:52:59,573 - root - INFO - conftest.py:58 - timer - Test test_handle_openai_error[RateLimitError-Rate limit exceeded] took 0.01 seconds
2024-10-25 13:52:59,574 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 13:52:59,574 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 13:52:59,581 - root - INFO - conftest.py:58 - timer - Test test_handle_openai_error[APIError-API error] took 0.01 seconds
2024-10-25 13:52:59,581 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 13:52:59,582 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 13:52:59,588 - root - INFO - conftest.py:58 - timer - Test test_handle_openai_error[APITimeoutError-Request timed out] took 0.01 seconds
2024-10-25 13:52:59,589 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 13:52:59,589 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 13:52:59,595 - root - INFO - conftest.py:58 - timer - Test test_handle_openai_error[APIConnectionError-Connection error] took 0.01 seconds
2024-10-25 13:52:59,598 - root - INFO - conftest.py:58 - timer - Test test_create_test_exception took 0.00 seconds
2024-10-25 13:52:59,865 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 13:53:00,164 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:01,393 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:03,643 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 13:53:04,137 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:07,299 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:10,662 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 13:53:11,388 - root - INFO - pinecone_manager.py:83 - _initialize - Successfully initialized Pinecone index: test-index
2024-10-25 13:53:11,390 - root - INFO - conftest.py:58 - timer - Test test_pinecone_manager_initialization took 11.79 seconds
2024-10-25 13:53:11,837 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 13:53:12,351 - root - INFO - pinecone_manager.py:83 - _initialize - Successfully initialized Pinecone index: test-index
2024-10-25 13:53:12,355 - root - INFO - conftest.py:58 - timer - Test test_upsert_and_search[chunks0-embeddings0] took 0.96 seconds
2024-10-25 13:53:12,702 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 13:53:13,351 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:14,777 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:17,243 - root - INFO - pinecone_manager.py:80 - _initialize - Index test-index already exists. Using existing index.
2024-10-25 13:53:17,637 - root - INFO - pinecone_manager.py:83 - _initialize - Successfully initialized Pinecone index: test-index
2024-10-25 13:53:17,641 - root - INFO - conftest.py:58 - timer - Test test_upsert_and_search[chunks1-embeddings1] took 5.29 seconds
2024-10-25 13:53:18,098 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:19,395 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:21,713 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 13:53:22,115 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:25,313 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 13:53:25,691 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:28,973 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:29,034 - root - INFO - conftest.py:58 - timer - Test test_upsert_and_search[chunks2-embeddings2] took 11.39 seconds
2024-10-25 13:53:29,269 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 13:53:29,784 - root - INFO - pinecone_manager.py:83 - _initialize - Successfully initialized Pinecone index: test-index
2024-10-25 13:53:29,788 - root - INFO - conftest.py:58 - timer - Test test_get_or_create_embeddings took 0.75 seconds
2024-10-25 13:53:29,958 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:31,195 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 13:53:31,383 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:33,557 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 13:53:34,094 - root - INFO - pinecone_manager.py:83 - _initialize - Successfully initialized Pinecone index: test-index
2024-10-25 13:53:34,096 - root - INFO - conftest.py:58 - timer - Test test_clear_index took 4.31 seconds
2024-10-25 13:53:34,576 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 13:53:35,448 - root - INFO - pinecone_manager.py:83 - _initialize - Successfully initialized Pinecone index: test-index
2024-10-25 13:53:35,462 - root - WARNING - pinecone_manager.py:127 - clear_index - Pinecone index is not available. Skipping clear operation.
2024-10-25 13:53:35,462 - root - INFO - conftest.py:58 - timer - Test test_error_handling took 1.37 seconds
2024-10-25 13:53:35,862 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 13:53:36,298 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:37,462 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:39,688 - root - INFO - pinecone_manager.py:80 - _initialize - Index test-index already exists. Using existing index.
2024-10-25 13:53:39,897 - root - INFO - pinecone_manager.py:83 - _initialize - Successfully initialized Pinecone index: test-index
2024-10-25 13:53:39,899 - root - INFO - conftest.py:58 - timer - Test test_batch_operation[1] took 4.44 seconds
2024-10-25 13:53:40,190 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 13:53:40,772 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:41,882 - root - INFO - pinecone_manager.py:80 - _initialize - Index test-index already exists. Using existing index.
2024-10-25 13:53:42,296 - root - INFO - pinecone_manager.py:83 - _initialize - Successfully initialized Pinecone index: test-index
2024-10-25 13:53:42,298 - root - INFO - conftest.py:58 - timer - Test test_batch_operation[10] took 2.40 seconds
2024-10-25 13:53:42,593 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 13:53:43,008 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:44,322 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:46,509 - root - INFO - pinecone_manager.py:80 - _initialize - Index test-index already exists. Using existing index.
2024-10-25 13:53:47,002 - root - INFO - pinecone_manager.py:83 - _initialize - Successfully initialized Pinecone index: test-index
2024-10-25 13:53:47,007 - root - INFO - conftest.py:58 - timer - Test test_batch_operation[100] took 4.71 seconds
2024-10-25 13:53:47,014 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:53:47,016 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:53:47,016 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:53:47,868 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:53:47,870 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:53:48,131 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:53:48,131 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:53:48,135 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x15dfb6f20>, 'json_data': {'input': ['Test Test Test Test Test Test Test Test Test Test Test Test Test Test Test try_out try_out try_out try_out try_out try_out try_out try_out try_out try_out try_out try_out try_out try_out try_out trial_run trial_run trial_run trial_run trial_run trial_run trial_run trial_run trial_run trial_run trial_run trial_run trial_run trial_run trial_run query query query query query query query query query query query query query query query interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry'], 'model': 'text-embedding-3-small', 'encoding_format': 'base64'}}
2024-10-25 13:53:48,136 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-25 13:53:48,137 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.started
2024-10-25 13:53:48,137 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.complete
2024-10-25 13:53:48,137 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-25 13:53:48,172 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x162114b30>
2024-10-25 13:53:48,173 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.started ssl_context=<ssl.SSLContext object at 0x10d2f7b50> server_hostname='api.openai.com' timeout=5.0
2024-10-25 13:53:48,215 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x162117680>
2024-10-25 13:53:48,215 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-25 13:53:48,216 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-25 13:53:48,216 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-25 13:53:48,216 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-25 13:53:48,216 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-25 13:53:48,500 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 25 Oct 2024 12:53:48 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-3-small'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'57'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999809'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'2ms'), (b'x-request-id', b'req_e15b09327b632e08cd6032a83e5829b0'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d825a011ab0e3b1-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-25 13:53:48,501 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-25 13:53:48,501 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-25 13:53:48,502 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-25 13:53:48,502 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-25 13:53:48,502 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-25 13:53:48,503 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers({'date': 'Fri, 25 Oct 2024 12:53:48 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-allow-origin': '*', 'access-control-expose-headers': 'X-Request-ID', 'openai-model': 'text-embedding-3-small', 'openai-organization': 'uinside', 'openai-processing-ms': '57', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '5000000', 'x-ratelimit-remaining-requests': '9999', 'x-ratelimit-remaining-tokens': '4999809', 'x-ratelimit-reset-requests': '6ms', 'x-ratelimit-reset-tokens': '2ms', 'x-request-id': 'req_e15b09327b632e08cd6032a83e5829b0', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d825a011ab0e3b1-LIS', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-25 13:53:48,503 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_e15b09327b632e08cd6032a83e5829b0
2024-10-25 13:53:49,406 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 13:53:49,410 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[1] took 2.40 seconds
2024-10-25 13:53:49,414 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:53:49,415 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:53:49,415 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:53:49,702 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:53:49,704 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:53:50,193 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:53:50,193 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:53:51,153 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 13:53:51,156 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[2] took 1.74 seconds
2024-10-25 13:53:51,160 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:53:51,161 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:53:51,161 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:53:51,499 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:53:51,500 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:53:51,796 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:53:51,797 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:53:52,717 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 13:53:52,718 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[3] took 1.56 seconds
2024-10-25 13:53:52,720 - root - INFO - conftest.py:58 - timer - Test test_generate_answer took 0.00 seconds
2024-10-25 13:53:52,721 - root - INFO - rag.py:67 - rag_query - Processing query: Test query
2024-10-25 13:53:52,722 - root - ERROR - rag.py:76 - rag_query - Error in rag_query: 'BookDataInterface' object has no attribute 'get_relevant_chunks'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 69, in rag_query
    relevant_chunks = book_data.get_relevant_chunks(question)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'BookDataInterface' object has no attribute 'get_relevant_chunks'
2024-10-25 13:53:52,758 - root - INFO - conftest.py:58 - timer - Test test_rag_query took 0.04 seconds
2024-10-25 13:53:52,759 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[Short query] took 0.00 seconds
2024-10-25 13:53:52,759 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[A very long query that contains multiple sentences and specific terms] took 0.00 seconds
2024-10-25 13:53:52,760 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[] took 0.00 seconds
2024-10-25 13:53:52,760 - root - INFO - rag.py:67 - rag_query - Processing query: Test query
2024-10-25 13:53:52,760 - root - ERROR - rag.py:76 - rag_query - Error in rag_query: 'BookDataInterface' object has no attribute 'get_relevant_chunks'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 69, in rag_query
    relevant_chunks = book_data.get_relevant_chunks(question)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'BookDataInterface' object has no attribute 'get_relevant_chunks'
2024-10-25 13:53:52,761 - root - INFO - conftest.py:58 - timer - Test test_rag_query_performance took 0.00 seconds
2024-10-25 13:53:52,761 - root - INFO - rag.py:67 - rag_query - Processing query: Test query
2024-10-25 13:53:52,761 - root - ERROR - rag.py:76 - rag_query - Error in rag_query: 'BookDataInterface' object has no attribute 'get_relevant_chunks'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 69, in rag_query
    relevant_chunks = book_data.get_relevant_chunks(question)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'BookDataInterface' object has no attribute 'get_relevant_chunks'
2024-10-25 13:53:52,764 - root - INFO - conftest.py:58 - timer - Test test_rag_error_handling took 0.00 seconds
2024-10-25 13:53:52,764 - root - ERROR - rag.py:63 - generate_answer - Error in generate_answer: Test error
2024-10-25 13:53:52,765 - root - INFO - conftest.py:58 - timer - Test test_generate_answer_error_handling[Exception-Test error] took 0.00 seconds
2024-10-25 13:53:52,765 - root - INFO - text_processing.py:75 - load_and_preprocess_text - Preprocessing text content
2024-10-25 13:53:52,917 - root - INFO - text_processing.py:81 - load_and_preprocess_text - Extracted 0 dates, 0 named entities, and 5 key phrases from the text
2024-10-25 13:53:52,917 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-25 13:53:52,917 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1 chunks
2024-10-25 13:53:52,918 - root - INFO - conftest.py:58 - timer - Test test_load_and_preprocess_text took 0.15 seconds
2024-10-25 13:53:52,918 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 100, overlap: 20)
2024-10-25 13:53:52,918 - root - INFO - text_processing.py:103 - split_into_chunks - Created 13 chunks
2024-10-25 13:53:52,918 - root - INFO - conftest.py:58 - timer - Test test_split_into_chunks[100-20] took 0.00 seconds
2024-10-25 13:53:52,919 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 200, overlap: 50)
2024-10-25 13:53:52,919 - root - INFO - text_processing.py:103 - split_into_chunks - Created 7 chunks
2024-10-25 13:53:52,919 - root - INFO - conftest.py:58 - timer - Test test_split_into_chunks[200-50] took 0.00 seconds
2024-10-25 13:53:52,919 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 500, overlap: 100)
2024-10-25 13:53:52,919 - root - INFO - text_processing.py:103 - split_into_chunks - Created 3 chunks
2024-10-25 13:53:52,920 - root - INFO - conftest.py:58 - timer - Test test_split_into_chunks[500-100] took 0.00 seconds
2024-10-25 13:53:52,920 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 100, overlap: 20)
2024-10-25 13:53:52,920 - root - INFO - text_processing.py:103 - split_into_chunks - Created 13 chunks
2024-10-25 13:53:52,920 - root - INFO - conftest.py:58 - timer - Test test_split_into_chunks_with_dict_input took 0.00 seconds
2024-10-25 14:20:13,268 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 14:20:13,269 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 14:20:13,275 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 14:20:13,276 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 14:20:13,285 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 14:20:13,660 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 14:20:13,661 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 14:20:13,938 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 14:20:13,938 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 14:20:14,120 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 14:20:14,206 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[1] took 0.08 seconds
2024-10-25 14:20:14,211 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[2] took 0.00 seconds
2024-10-25 14:20:14,244 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[3] took 0.03 seconds
2024-10-25 14:20:14,245 - root - INFO - conftest.py:58 - timer - Test test_generate_answer took 0.00 seconds
2024-10-25 14:20:14,246 - root - INFO - rag.py:68 - rag_query - Processing query: Test question
2024-10-25 14:20:14,246 - root - INFO - conftest.py:58 - timer - Test test_rag_query took 0.00 seconds
2024-10-25 14:20:14,246 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[Short query] took 0.00 seconds
2024-10-25 14:20:14,247 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[A very long query that contains multiple sentences and specific terms] took 0.00 seconds
2024-10-25 14:20:14,247 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[] took 0.00 seconds
2024-10-25 14:20:14,247 - root - INFO - rag.py:68 - rag_query - Processing query: Test query
2024-10-25 14:20:14,248 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 14:20:14,248 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 14:20:14,248 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 14:20:14,566 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 14:20:14,567 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 14:20:14,832 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 14:20:14,832 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 14:20:15,848 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 14:20:15,921 - root - INFO - conftest.py:58 - timer - Test test_rag_query_performance took 1.67 seconds
2024-10-25 14:20:15,922 - root - INFO - rag.py:68 - rag_query - Processing query: Test query
2024-10-25 14:20:15,922 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 14:20:15,922 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 14:20:15,922 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 14:20:16,251 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 14:20:16,252 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 14:20:16,470 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 14:20:16,470 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 14:20:17,424 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 14:20:17,425 - root - ERROR - rag.py:76 - rag_query - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 73, in rag_query
    answer = openai_service.generate_answer(question, context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 14:20:17,430 - root - INFO - conftest.py:58 - timer - Test test_rag_error_handling took 1.51 seconds
2024-10-25 14:20:17,431 - root - ERROR - rag.py:64 - generate_answer - Error in generate_answer: Test error
2024-10-25 14:20:17,432 - root - INFO - conftest.py:58 - timer - Test test_generate_answer_error_handling[Exception-Test error] took 0.00 seconds
2024-10-25 14:20:17,433 - root - INFO - rag.py:68 - rag_query - Processing query: Test question
2024-10-25 14:20:17,433 - root - ERROR - rag.py:76 - rag_query - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 70, in rag_query
    search = get_search_strategy(search_strategy, book_data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 14:20:17,433 - root - INFO - conftest.py:58 - timer - Test test_rag_query_error_handling took 0.00 seconds
2024-10-25 14:21:44,597 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 14:21:44,598 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 14:21:44,605 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 14:21:44,606 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 14:21:44,614 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 14:21:44,940 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 14:21:44,943 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 14:21:45,199 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 14:21:45,199 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 14:21:45,404 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 14:21:45,418 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 14:21:46,716 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.30 seconds
2024-10-25 14:21:46,800 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.08 seconds
2024-10-25 14:21:46,802 - root - ERROR - search.py:54 - search - Error in hybrid search: Test error
2024-10-25 14:21:46,802 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.00 seconds
2024-10-25 14:21:46,805 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 14:21:46,808 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 14:21:46,809 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 14:21:46,809 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 14:21:46,831 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.02 seconds
2024-10-25 14:21:46,832 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 14:22:48,436 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 14:22:48,437 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 14:22:48,445 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 14:22:48,445 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 14:22:48,452 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 14:22:48,749 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 14:22:48,755 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 14:22:48,988 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 14:22:48,989 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 14:22:49,203 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 14:22:49,217 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 14:22:50,510 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.29 seconds
2024-10-25 14:22:50,595 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.08 seconds
2024-10-25 14:22:50,596 - root - ERROR - search.py:54 - search - Error in hybrid search: Test error
2024-10-25 14:22:50,596 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.00 seconds
2024-10-25 14:22:50,599 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 14:22:50,601 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 14:22:50,602 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 14:22:50,602 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 14:22:50,625 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.02 seconds
2024-10-25 14:22:50,626 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 14:22:54,340 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 14:22:54,341 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 14:22:54,347 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 14:22:54,347 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 14:22:54,351 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 14:22:54,779 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 14:22:54,782 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 14:22:55,085 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 14:22:55,085 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 14:22:55,260 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 14:22:55,372 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[1] took 0.10 seconds
2024-10-25 14:22:55,409 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[2] took 0.04 seconds
2024-10-25 14:22:55,414 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[3] took 0.00 seconds
2024-10-25 14:22:55,415 - root - INFO - conftest.py:58 - timer - Test test_generate_answer took 0.00 seconds
2024-10-25 14:22:55,416 - root - INFO - rag.py:68 - rag_query - Processing query: Test question
2024-10-25 14:22:55,416 - root - INFO - conftest.py:58 - timer - Test test_rag_query took 0.00 seconds
2024-10-25 14:22:55,417 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[Short query] took 0.00 seconds
2024-10-25 14:22:55,417 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[A very long query that contains multiple sentences and specific terms] took 0.00 seconds
2024-10-25 14:22:55,418 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[] took 0.00 seconds
2024-10-25 14:22:55,418 - root - INFO - rag.py:68 - rag_query - Processing query: Test query
2024-10-25 14:22:55,419 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 14:22:55,419 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 14:22:55,419 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 14:22:55,712 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 14:22:55,713 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 14:22:55,962 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 14:22:55,963 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 14:22:56,964 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 14:22:57,074 - root - INFO - conftest.py:58 - timer - Test test_rag_query_performance took 1.66 seconds
2024-10-25 14:22:57,075 - root - INFO - rag.py:68 - rag_query - Processing query: Test query
2024-10-25 14:22:57,075 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 14:22:57,075 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 14:22:57,075 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 14:22:57,418 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 14:22:57,420 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 14:22:57,669 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 14:22:57,670 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 14:22:58,653 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 14:22:58,654 - root - ERROR - rag.py:76 - rag_query - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 73, in rag_query
    answer = openai_service.generate_answer(question, context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 14:22:58,665 - root - INFO - conftest.py:58 - timer - Test test_rag_error_handling took 1.59 seconds
2024-10-25 14:22:58,668 - root - ERROR - rag.py:64 - generate_answer - Error in generate_answer: Test error
2024-10-25 14:22:58,668 - root - INFO - conftest.py:58 - timer - Test test_generate_answer_error_handling[Exception-Test error] took 0.00 seconds
2024-10-25 14:22:58,670 - root - INFO - rag.py:68 - rag_query - Processing query: Test question
2024-10-25 14:22:58,670 - root - ERROR - rag.py:76 - rag_query - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 70, in rag_query
    search = get_search_strategy(search_strategy, book_data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 14:22:58,671 - root - INFO - conftest.py:58 - timer - Test test_rag_query_error_handling took 0.00 seconds
2024-10-25 14:25:56,281 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 14:25:56,282 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 14:25:56,289 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 14:25:56,289 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 14:25:56,298 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 14:25:57,362 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 14:25:57,367 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 14:25:57,854 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 14:25:57,855 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 14:25:58,590 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 14:25:58,604 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 14:25:59,905 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.30 seconds
2024-10-25 14:25:59,989 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.08 seconds
2024-10-25 14:25:59,990 - root - ERROR - search.py:54 - search - Error in hybrid search: Test error
2024-10-25 14:25:59,990 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.00 seconds
2024-10-25 14:25:59,993 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 14:25:59,996 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 14:25:59,996 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 14:25:59,997 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 14:26:00,020 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.02 seconds
2024-10-25 14:26:00,021 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 14:41:28,805 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 14:41:28,808 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 14:41:28,815 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 14:41:28,815 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 14:41:28,823 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 14:41:29,208 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 14:41:29,209 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 14:41:29,508 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 14:41:29,508 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 14:41:29,734 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 14:41:29,845 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.10 seconds
2024-10-25 14:41:29,847 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 0.00 seconds
2024-10-25 14:41:29,849 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.00 seconds
2024-10-25 14:41:31,258 - root - ERROR - search.py:54 - search - Error in hybrid search: Test error
2024-10-25 14:41:31,258 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 1.41 seconds
2024-10-25 14:41:31,262 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 14:41:31,264 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 14:41:31,267 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 14:41:31,270 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 14:41:31,276 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 14:41:31,276 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 14:43:14,944 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 14:43:14,946 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 14:43:14,953 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 14:43:14,953 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 14:43:14,961 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 14:43:15,411 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 14:43:15,413 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 14:43:15,678 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 14:43:15,679 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 14:43:15,874 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 14:43:15,980 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.09 seconds
2024-10-25 14:43:15,982 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 0.00 seconds
2024-10-25 14:43:15,989 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.01 seconds
2024-10-25 14:43:17,281 - root - ERROR - search.py:54 - search - Error in hybrid search: Test error
2024-10-25 14:43:17,281 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 1.29 seconds
2024-10-25 14:43:17,285 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 14:43:17,287 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 14:43:17,289 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 14:43:17,292 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 14:43:17,297 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 14:43:17,298 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 14:44:51,683 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 14:44:51,684 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 14:44:51,691 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 14:44:51,691 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 14:44:51,699 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 14:44:52,120 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 14:44:52,122 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 14:44:52,616 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 14:44:52,616 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 14:44:52,822 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 14:44:52,836 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 14:44:54,186 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.35 seconds
2024-10-25 14:44:54,187 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.00 seconds
2024-10-25 14:44:54,188 - root - ERROR - search.py:54 - search - Error in hybrid search: Test error
2024-10-25 14:44:54,189 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.00 seconds
2024-10-25 14:44:54,252 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.06 seconds
2024-10-25 14:44:54,255 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 14:44:54,255 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 14:44:54,256 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 14:44:54,257 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 14:44:54,257 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 14:45:26,270 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 14:45:26,271 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 14:45:26,278 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 14:45:26,278 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 14:45:26,286 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 14:45:26,651 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 14:45:26,654 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 14:45:28,950 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 14:45:28,950 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 14:45:29,215 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 14:45:29,228 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 14:45:30,598 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.37 seconds
2024-10-25 14:45:30,599 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.00 seconds
2024-10-25 14:45:30,600 - root - ERROR - search.py:54 - search - Error in hybrid search: Test error
2024-10-25 14:45:30,600 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.00 seconds
2024-10-25 14:45:30,666 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.07 seconds
2024-10-25 14:45:30,668 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 14:45:30,669 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 14:45:30,669 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 14:45:30,670 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 14:45:30,670 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 14:47:36,009 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 14:47:36,010 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 14:47:36,017 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 14:47:36,017 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 14:47:36,025 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 14:47:36,779 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 14:47:36,782 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 14:47:37,497 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 14:47:37,497 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 14:47:37,789 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 14:47:37,803 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 14:47:39,105 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.30 seconds
2024-10-25 14:47:39,106 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.00 seconds
2024-10-25 14:47:39,107 - root - ERROR - search.py:54 - search - Error in hybrid search: Test error
2024-10-25 14:47:39,107 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.00 seconds
2024-10-25 14:47:39,171 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.06 seconds
2024-10-25 14:47:39,173 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 14:47:39,174 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 14:47:39,175 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 14:47:39,175 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 14:47:39,176 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 14:48:05,585 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 14:48:05,586 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 14:48:05,593 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 14:48:05,593 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 14:48:05,600 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 14:48:05,971 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 14:48:05,972 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 14:48:06,431 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 14:48:06,432 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 14:48:06,776 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 14:48:06,787 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 14:48:08,112 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.32 seconds
2024-10-25 14:48:08,113 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.00 seconds
2024-10-25 14:48:08,114 - root - ERROR - search.py:54 - search - Error in hybrid search: Test error
2024-10-25 14:48:08,114 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.00 seconds
2024-10-25 14:48:08,178 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.06 seconds
2024-10-25 14:48:08,180 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 14:48:08,181 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 14:48:08,182 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 14:48:08,185 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 14:48:08,185 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 14:56:10,943 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 14:56:10,944 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 14:56:10,951 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 14:56:10,951 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 14:56:10,959 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 14:56:11,433 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 14:56:11,434 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 14:56:13,716 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 14:56:13,717 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 14:56:14,730 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 14:56:14,743 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 14:56:16,227 - root - ERROR - search.py:50 - search - Error in hybrid search: 'HybridSearch' object has no attribute 'bm25'
2024-10-25 14:56:16,291 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.55 seconds
2024-10-25 14:56:16,292 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.00 seconds
2024-10-25 14:56:16,292 - root - ERROR - search.py:50 - search - Error in hybrid search: 'HybridSearch' object has no attribute 'bm25'
2024-10-25 14:56:16,292 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.00 seconds
2024-10-25 14:56:16,294 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 14:56:16,295 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 14:56:16,299 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 14:56:16,304 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.01 seconds
2024-10-25 14:56:16,310 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 14:56:16,310 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 15:00:54,053 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 15:00:54,054 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 15:00:54,062 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:00:54,062 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:00:54,070 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:00:54,472 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:00:54,473 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:00:54,973 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:00:54,974 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:00:55,324 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 15:00:55,338 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 15:00:56,866 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.53 seconds
2024-10-25 15:00:56,867 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.00 seconds
2024-10-25 15:00:56,868 - root - ERROR - search.py:61 - search - Error in hybrid search: Test error
2024-10-25 15:00:56,869 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.00 seconds
2024-10-25 15:00:56,870 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 15:00:56,871 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 15:00:56,872 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 15:00:56,872 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 15:00:56,873 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 15:00:56,874 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 15:01:09,924 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 15:01:09,925 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 15:01:09,931 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:01:09,931 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:01:09,935 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:01:10,262 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:01:10,262 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:01:10,902 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:01:10,903 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:01:11,141 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 15:01:11,252 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[1] took 0.10 seconds
2024-10-25 15:01:11,254 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[2] took 0.00 seconds
2024-10-25 15:01:11,256 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[3] took 0.00 seconds
2024-10-25 15:01:11,256 - root - INFO - conftest.py:58 - timer - Test test_generate_answer took 0.00 seconds
2024-10-25 15:01:11,258 - root - INFO - rag.py:68 - rag_query - Processing query: Test question
2024-10-25 15:01:11,258 - root - INFO - conftest.py:58 - timer - Test test_rag_query took 0.00 seconds
2024-10-25 15:01:11,259 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[Short query] took 0.00 seconds
2024-10-25 15:01:11,259 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[A very long query that contains multiple sentences and specific terms] took 0.00 seconds
2024-10-25 15:01:11,259 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[] took 0.00 seconds
2024-10-25 15:01:11,260 - root - INFO - rag.py:68 - rag_query - Processing query: Test query
2024-10-25 15:01:11,260 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:01:11,260 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:01:11,260 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:01:11,653 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:01:11,655 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:01:12,096 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:01:12,097 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:01:13,157 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:01:13,267 - root - INFO - conftest.py:58 - timer - Test test_rag_query_performance took 2.01 seconds
2024-10-25 15:01:13,268 - root - INFO - rag.py:68 - rag_query - Processing query: Test query
2024-10-25 15:01:13,268 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:01:13,268 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:01:13,268 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:01:13,780 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:01:13,782 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:01:14,187 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:01:14,187 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:01:15,024 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:01:15,025 - root - ERROR - rag.py:76 - rag_query - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 73, in rag_query
    answer = openai_service.generate_answer(question, context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:01:15,034 - root - INFO - conftest.py:58 - timer - Test test_rag_error_handling took 1.77 seconds
2024-10-25 15:01:15,035 - root - ERROR - rag.py:64 - generate_answer - Error in generate_answer: Test error
2024-10-25 15:01:15,036 - root - INFO - conftest.py:58 - timer - Test test_generate_answer_error_handling[Exception-Test error] took 0.00 seconds
2024-10-25 15:01:15,037 - root - INFO - rag.py:68 - rag_query - Processing query: Test question
2024-10-25 15:01:15,037 - root - ERROR - rag.py:76 - rag_query - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 70, in rag_query
    search = get_search_strategy(search_strategy, book_data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:01:15,038 - root - INFO - conftest.py:58 - timer - Test test_rag_query_error_handling took 0.00 seconds
2024-10-25 15:04:46,626 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 15:04:46,627 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 15:04:46,634 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:04:46,634 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:04:46,641 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:04:47,051 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:04:47,053 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:04:47,350 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:04:47,350 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:04:47,844 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 15:04:49,363 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:04:49,364 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:04:49,364 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:04:49,672 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:04:49,674 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:04:49,913 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:04:49,914 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:04:49,918 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x120a3fb00>, 'json_data': {'input': ['Test Test Test Test Test Test Test Test Test Test Test Test Test Test Test trial trial trial trial trial trial trial trial trial trial trial trial trial trial trial trial_run trial_run trial_run trial_run trial_run trial_run trial_run trial_run trial_run trial_run trial_run trial_run trial_run trial_run trial_run test test test test test test test test test test test test test test test tryout tryout tryout tryout tryout tryout tryout tryout tryout tryout tryout tryout tryout tryout tryout mental_test mental_test mental_test mental_test mental_test mental_test mental_test mental_test mental_test mental_test mental_test mental_test mental_testing mental_testing mental_testing mental_testing mental_testing mental_testing mental_testing mental_testing mental_testing mental_testing mental_testing mental_testing mental_testing psychometric_test psychometric_test psychometric_test psychometric_test psychometric_test psychometric_test psychometric_test psychometric_test psychometric_test psychometric_test psychometric_test psychometric_test examination examination examination examination examination examination examination examination examination examination examination examination examination examination examination exam exam exam exam exam exam exam exam exam exam exam exam exam exam exam run run run run run run run run run run run run run prove prove prove prove prove prove prove prove prove prove try try try try try try try try try try try try try try_out try_out try_out try_out try_out try_out try_out try_out try_out try_out examine examine examine examine examine examine examine examine examine examine examine examine essay essay essay essay essay essay essay essay essay essay essay essay essay essay essay screen screen screen screen screen screen screen screen screen screen screen screen screen screen screen quiz quiz quiz quiz quiz quiz quiz quiz quiz quiz quiz quiz quiz quiz quiz query query query query query query query query query query query query query query query question question question question question question question question question question question question question question question inquiry inquiry inquiry inquiry inquiry inquiry inquiry inquiry inquiry inquiry inquiry inquiry inquiry inquiry inquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation'], 'model': 'text-embedding-3-small', 'encoding_format': 'base64'}}
2024-10-25 15:04:49,965 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-25 15:04:49,966 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-25 15:04:50,019 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x1275a3e00>
2024-10-25 15:04:50,019 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.started ssl_context=<ssl.SSLContext object at 0x1205e1c50> server_hostname='api.openai.com' timeout=5.0
2024-10-25 15:04:50,059 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x1275a3d40>
2024-10-25 15:04:50,060 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-25 15:04:50,060 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-25 15:04:50,060 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-25 15:04:50,061 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-25 15:04:50,061 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-25 15:04:50,509 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 25 Oct 2024 14:04:50 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-3-small'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'90'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999353'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'7ms'), (b'x-request-id', b'req_362a15c42e8ceb79d021935db26bc3a3'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=_3VuFzkOcJoHqH7TCNqD2w15BEaNHoZFunFc0iU90rA-1729865090-1.0.1.1-_Uc39dQlxUJHLQmcQCbzZWi78dUU8WKT6mu3bUYiMlzXV1W7SuQmIDRNjXLj9k4b_X5so_xwxrECnbkWqQtQPw; path=/; expires=Fri, 25-Oct-24 14:34:50 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=hCrrK9HNyYIsA0uZzQKmS0y4izs8LHjG61PNcU5lK8Y-1729865090541-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d82c20da9604899-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-25 15:04:50,510 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-25 15:04:50,510 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-25 15:04:50,510 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-25 15:04:50,510 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-25 15:04:50,510 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-25 15:04:50,510 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers([('date', 'Fri, 25 Oct 2024 14:04:50 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-allow-origin', '*'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-model', 'text-embedding-3-small'), ('openai-organization', 'uinside'), ('openai-processing-ms', '90'), ('openai-version', '2020-10-01'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '5000000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '4999353'), ('x-ratelimit-reset-requests', '6ms'), ('x-ratelimit-reset-tokens', '7ms'), ('x-request-id', 'req_362a15c42e8ceb79d021935db26bc3a3'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=_3VuFzkOcJoHqH7TCNqD2w15BEaNHoZFunFc0iU90rA-1729865090-1.0.1.1-_Uc39dQlxUJHLQmcQCbzZWi78dUU8WKT6mu3bUYiMlzXV1W7SuQmIDRNjXLj9k4b_X5so_xwxrECnbkWqQtQPw; path=/; expires=Fri, 25-Oct-24 14:34:50 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=hCrrK9HNyYIsA0uZzQKmS0y4izs8LHjG61PNcU5lK8Y-1729865090541-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d82c20da9604899-LIS'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-25 15:04:50,511 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_362a15c42e8ceb79d021935db26bc3a3
2024-10-25 15:04:51,474 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:04:51,487 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[1] took 3.63 seconds
2024-10-25 15:04:51,494 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:04:51,494 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:04:51,494 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:04:51,835 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:04:51,837 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:04:52,327 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:04:52,327 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:04:53,261 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:04:53,269 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[2] took 1.78 seconds
2024-10-25 15:04:53,273 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:04:53,273 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:04:53,274 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:04:53,588 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:04:53,589 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:04:54,459 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:04:54,460 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:04:55,331 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:04:55,342 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[3] took 2.07 seconds
2024-10-25 15:04:55,345 - root - INFO - conftest.py:58 - timer - Test test_generate_answer took 0.00 seconds
2024-10-25 15:04:55,348 - root - INFO - rag.py:68 - rag_query - Processing query: Test question
2024-10-25 15:04:55,349 - root - INFO - conftest.py:58 - timer - Test test_rag_query took 0.00 seconds
2024-10-25 15:04:55,350 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[Short query] took 0.00 seconds
2024-10-25 15:04:55,351 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[A very long query that contains multiple sentences and specific terms] took 0.00 seconds
2024-10-25 15:04:55,352 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[] took 0.00 seconds
2024-10-25 15:04:55,354 - root - INFO - rag.py:68 - rag_query - Processing query: Test query
2024-10-25 15:04:55,354 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:04:55,355 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:04:55,355 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:04:55,681 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:04:55,681 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:04:56,059 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:04:56,060 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:04:56,883 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:04:56,991 - root - INFO - conftest.py:58 - timer - Test test_rag_query_performance took 1.64 seconds
2024-10-25 15:04:56,993 - root - INFO - rag.py:68 - rag_query - Processing query: Test query
2024-10-25 15:04:56,994 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:04:56,994 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:04:56,994 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:04:57,576 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:04:57,578 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:04:58,905 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:04:58,905 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:04:59,696 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:04:59,697 - root - ERROR - rag.py:76 - rag_query - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 73, in rag_query
    answer = openai_service.generate_answer(question, context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:04:59,702 - root - INFO - conftest.py:58 - timer - Test test_rag_error_handling took 2.71 seconds
2024-10-25 15:04:59,705 - root - ERROR - rag.py:64 - generate_answer - Error in generate_answer: Test error
2024-10-25 15:04:59,705 - root - INFO - conftest.py:58 - timer - Test test_generate_answer_error_handling[Exception-Test error] took 0.00 seconds
2024-10-25 15:04:59,708 - root - INFO - rag.py:68 - rag_query - Processing query: Test question
2024-10-25 15:04:59,708 - root - ERROR - rag.py:76 - rag_query - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 70, in rag_query
    search = get_search_strategy(search_strategy, book_data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:04:59,803 - root - INFO - conftest.py:58 - timer - Test test_rag_query_error_handling took 0.10 seconds
2024-10-25 15:05:46,530 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 15:05:46,531 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 15:05:46,538 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:05:46,538 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:05:46,546 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:05:46,902 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:05:46,905 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:05:49,268 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:05:49,268 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:05:50,089 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 15:05:51,602 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:05:51,602 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:05:51,602 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:05:52,161 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:05:52,162 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:05:52,973 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:05:52,974 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:05:53,850 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:05:53,862 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[1] took 3.76 seconds
2024-10-25 15:05:53,867 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:05:53,867 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:05:53,868 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:05:55,174 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:05:55,175 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:05:57,572 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:05:57,573 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:05:58,399 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:05:58,409 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[2] took 4.55 seconds
2024-10-25 15:05:58,414 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:05:58,415 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:05:58,415 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:05:59,602 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:05:59,603 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:06:00,103 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:06:00,104 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:06:00,940 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:06:00,945 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[3] took 2.53 seconds
2024-10-25 15:06:00,947 - root - INFO - conftest.py:58 - timer - Test test_generate_answer took 0.00 seconds
2024-10-25 15:06:00,949 - root - INFO - rag.py:68 - rag_query - Processing query: Test question
2024-10-25 15:06:00,949 - root - INFO - conftest.py:58 - timer - Test test_rag_query took 0.00 seconds
2024-10-25 15:06:00,950 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[Short query] took 0.00 seconds
2024-10-25 15:06:00,951 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[A very long query that contains multiple sentences and specific terms] took 0.00 seconds
2024-10-25 15:06:00,952 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[] took 0.00 seconds
2024-10-25 15:06:00,953 - root - INFO - rag.py:68 - rag_query - Processing query: Test query
2024-10-25 15:06:00,953 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:06:00,954 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:06:00,954 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:06:01,498 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:06:01,500 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:06:01,804 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:06:01,805 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:06:02,643 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:06:02,752 - root - INFO - conftest.py:58 - timer - Test test_rag_query_performance took 1.80 seconds
2024-10-25 15:06:02,754 - root - INFO - rag.py:68 - rag_query - Processing query: Test query
2024-10-25 15:06:02,754 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:06:02,755 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:06:02,755 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:06:03,275 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:06:03,276 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:06:03,755 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:06:03,756 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:06:04,562 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:06:04,562 - root - ERROR - rag.py:76 - rag_query - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 73, in rag_query
    answer = openai_service.generate_answer(question, context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:06:04,666 - root - INFO - conftest.py:58 - timer - Test test_rag_error_handling took 1.91 seconds
2024-10-25 15:06:04,667 - root - ERROR - rag.py:64 - generate_answer - Error in generate_answer: Test error
2024-10-25 15:06:04,667 - root - INFO - conftest.py:58 - timer - Test test_generate_answer_error_handling[Exception-Test error] took 0.00 seconds
2024-10-25 15:06:04,668 - root - INFO - rag.py:68 - rag_query - Processing query: Test question
2024-10-25 15:06:04,668 - root - ERROR - rag.py:76 - rag_query - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 70, in rag_query
    search = get_search_strategy(search_strategy, book_data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:06:04,668 - root - INFO - conftest.py:58 - timer - Test test_rag_query_error_handling took 0.00 seconds
2024-10-25 15:13:25,314 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 15:13:25,315 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 15:13:25,322 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:13:25,322 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:13:25,333 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:13:25,802 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:13:25,804 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:13:26,125 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:13:26,125 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:13:26,371 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 15:15:39,392 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 15:15:39,393 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 15:15:39,400 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:15:39,400 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:15:39,408 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:15:39,787 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:15:39,790 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:15:41,653 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:15:41,654 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:15:41,895 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 15:15:43,414 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:15:43,414 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:15:43,414 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:15:44,080 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:15:44,081 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:15:44,352 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:15:44,353 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:15:45,407 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:15:45,422 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[1] took 3.51 seconds
2024-10-25 15:15:45,427 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:15:45,428 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:15:45,428 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:15:45,888 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:15:45,889 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:15:46,236 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:15:46,236 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:15:47,122 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:15:47,130 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[2] took 1.71 seconds
2024-10-25 15:15:47,135 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:15:47,136 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:15:47,136 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:15:47,508 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:15:47,509 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:15:48,691 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:15:48,691 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:15:49,602 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:15:49,613 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[3] took 2.48 seconds
2024-10-25 15:15:49,615 - root - INFO - conftest.py:58 - timer - Test test_generate_answer took 0.00 seconds
2024-10-25 15:15:49,618 - root - INFO - rag.py:66 - rag_query - Processing query: Test question
2024-10-25 15:15:49,619 - root - INFO - conftest.py:58 - timer - Test test_rag_query took 0.00 seconds
2024-10-25 15:15:49,620 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[Short query] took 0.00 seconds
2024-10-25 15:15:49,622 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[A very long query that contains multiple sentences and specific terms] took 0.00 seconds
2024-10-25 15:15:49,623 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[] took 0.00 seconds
2024-10-25 15:15:49,624 - root - INFO - rag.py:66 - rag_query - Processing query: Test query
2024-10-25 15:15:49,625 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:15:49,625 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:15:49,626 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:15:49,925 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:15:49,926 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:15:50,672 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:15:50,672 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:15:51,548 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:15:51,664 - root - INFO - conftest.py:58 - timer - Test test_rag_query_performance took 2.04 seconds
2024-10-25 15:15:51,666 - root - INFO - rag.py:66 - rag_query - Processing query: Test query
2024-10-25 15:15:51,666 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:15:51,667 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:15:51,667 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:15:51,997 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:15:51,998 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:15:52,530 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:15:52,531 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:15:53,429 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:15:53,430 - root - ERROR - error_handler.py:17 - wrapper - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 70, in rag_query
    return openai_service.generate_answer(question, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:15:53,436 - root - INFO - conftest.py:58 - timer - Test test_rag_error_handling took 1.77 seconds
2024-10-25 15:15:53,439 - root - ERROR - error_handler.py:17 - wrapper - Error in generate_answer: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 62, in generate_answer
    return openai_service.generate_answer(query, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:15:53,440 - root - INFO - conftest.py:58 - timer - Test test_generate_answer_error_handling[Exception-Test error] took 0.00 seconds
2024-10-25 15:15:53,442 - root - INFO - rag.py:66 - rag_query - Processing query: Test question
2024-10-25 15:15:53,442 - root - ERROR - error_handler.py:17 - wrapper - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 67, in rag_query
    search = get_search_strategy(search_strategy, book_data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:15:53,443 - root - INFO - conftest.py:58 - timer - Test test_rag_query_error_handling took 0.00 seconds
2024-10-25 15:16:30,642 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 15:16:30,643 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 15:16:30,691 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:16:30,697 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:16:30,707 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:16:31,043 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:16:31,045 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:16:31,298 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:16:31,298 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:16:31,752 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 15:16:31,759 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 15:16:33,294 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.53 seconds
2024-10-25 15:16:33,295 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.00 seconds
2024-10-25 15:16:33,297 - root - ERROR - search.py:61 - search - Error in hybrid search: Test error
2024-10-25 15:16:33,297 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.00 seconds
2024-10-25 15:16:33,299 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 15:16:33,300 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 15:16:33,300 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 15:16:33,301 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 15:16:33,302 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 15:16:33,302 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 15:24:40,895 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 15:24:40,896 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 15:24:40,904 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:24:40,905 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:24:40,913 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:24:41,315 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:24:41,319 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:24:41,580 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:24:41,581 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:24:41,782 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 15:24:41,793 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 15:24:43,323 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.53 seconds
2024-10-25 15:24:43,324 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.00 seconds
2024-10-25 15:24:43,325 - root - ERROR - search.py:61 - search - Error in hybrid search: Test error
2024-10-25 15:24:43,325 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.00 seconds
2024-10-25 15:24:43,327 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 15:24:43,328 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 15:24:43,328 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 15:24:43,329 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 15:24:43,330 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 15:24:43,330 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 15:24:51,182 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 15:24:51,183 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 15:24:51,190 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:24:51,190 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:24:51,197 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:24:51,497 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:24:51,497 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:24:51,775 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:24:51,775 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:24:52,053 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 15:24:53,685 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:24:53,686 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:24:53,686 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:24:54,014 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:24:54,015 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:24:54,391 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:24:54,392 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:24:55,386 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:24:55,391 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[1] took 3.33 seconds
2024-10-25 15:24:55,395 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:24:55,395 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:24:55,395 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:24:55,684 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:24:55,684 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:24:55,949 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:24:55,950 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:24:56,859 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:24:56,864 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[2] took 1.47 seconds
2024-10-25 15:24:56,867 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:24:56,868 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:24:56,868 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:24:57,177 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:24:57,177 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:24:57,534 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:24:57,534 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:24:58,397 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:24:58,405 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[3] took 1.54 seconds
2024-10-25 15:24:58,408 - root - INFO - conftest.py:58 - timer - Test test_generate_answer took 0.00 seconds
2024-10-25 15:24:58,411 - root - INFO - rag.py:67 - rag_query - Processing query: Test question
2024-10-25 15:24:58,412 - root - INFO - conftest.py:58 - timer - Test test_rag_query took 0.00 seconds
2024-10-25 15:24:58,413 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[Short query] took 0.00 seconds
2024-10-25 15:24:58,414 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[A very long query that contains multiple sentences and specific terms] took 0.00 seconds
2024-10-25 15:24:58,415 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[] took 0.00 seconds
2024-10-25 15:24:58,416 - root - INFO - rag.py:67 - rag_query - Processing query: Test query
2024-10-25 15:24:58,417 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:24:58,418 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:24:58,418 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:24:58,738 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:24:58,739 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:24:58,966 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:24:58,966 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:24:59,819 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:24:59,908 - root - INFO - conftest.py:58 - timer - Test test_rag_query_performance took 1.49 seconds
2024-10-25 15:24:59,911 - root - INFO - rag.py:67 - rag_query - Processing query: Test query
2024-10-25 15:24:59,911 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:24:59,911 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:24:59,911 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:25:00,235 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:25:00,236 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:25:00,491 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:25:00,491 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:25:01,417 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:25:01,418 - root - ERROR - error_handler.py:17 - wrapper - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 71, in rag_query
    return openai_service.generate_answer(question, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:25:01,424 - root - INFO - conftest.py:58 - timer - Test test_rag_error_handling took 1.51 seconds
2024-10-25 15:25:01,426 - root - ERROR - error_handler.py:17 - wrapper - Error in generate_answer: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 63, in generate_answer
    return openai_service.generate_answer(query, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:25:01,428 - root - INFO - conftest.py:58 - timer - Test test_generate_answer_error_handling[Exception-Test error] took 0.00 seconds
2024-10-25 15:25:01,430 - root - INFO - rag.py:67 - rag_query - Processing query: Test question
2024-10-25 15:25:01,430 - root - ERROR - error_handler.py:17 - wrapper - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 68, in rag_query
    search = get_search_strategy(search_strategy, book_data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:25:01,432 - root - INFO - conftest.py:58 - timer - Test test_rag_query_error_handling took 0.00 seconds
2024-10-25 15:25:51,610 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 15:25:51,611 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 15:25:51,618 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:25:51,618 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:25:51,628 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:25:51,928 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:25:51,930 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:25:52,183 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:25:52,183 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:25:52,399 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 15:25:53,957 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:25:53,958 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:25:53,958 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:25:54,367 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:25:54,367 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:25:54,632 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:25:54,633 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:25:55,525 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:25:55,538 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[1] took 3.13 seconds
2024-10-25 15:25:55,543 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:25:55,544 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:25:55,544 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:25:55,837 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:25:55,838 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:25:56,135 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:25:56,135 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:25:56,948 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:25:56,958 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[2] took 1.42 seconds
2024-10-25 15:25:56,963 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:25:56,964 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:25:56,964 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:25:57,259 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:25:57,261 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:25:57,540 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:25:57,541 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:25:58,433 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:25:58,437 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[3] took 1.48 seconds
2024-10-25 15:25:58,439 - root - INFO - conftest.py:58 - timer - Test test_generate_answer took 0.00 seconds
2024-10-25 15:25:58,440 - root - INFO - rag.py:67 - rag_query - Processing query: Test question
2024-10-25 15:25:58,441 - root - INFO - conftest.py:58 - timer - Test test_rag_query took 0.00 seconds
2024-10-25 15:25:58,441 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[Short query] took 0.00 seconds
2024-10-25 15:25:58,442 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[A very long query that contains multiple sentences and specific terms] took 0.00 seconds
2024-10-25 15:25:58,442 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[] took 0.00 seconds
2024-10-25 15:25:58,443 - root - INFO - rag.py:67 - rag_query - Processing query: Test query
2024-10-25 15:25:58,443 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:25:58,444 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:25:58,444 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:25:58,792 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:25:58,793 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:25:59,162 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:25:59,162 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:26:00,029 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:26:00,134 - root - INFO - conftest.py:58 - timer - Test test_rag_query_performance took 1.69 seconds
2024-10-25 15:26:00,137 - root - INFO - rag.py:67 - rag_query - Processing query: Test query
2024-10-25 15:26:00,138 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:26:00,138 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:26:00,138 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:26:00,490 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:26:00,491 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:26:00,845 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:26:00,845 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:26:01,709 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:26:01,710 - root - ERROR - error_handler.py:17 - wrapper - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 71, in rag_query
    return openai_service.generate_answer(question, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:26:01,715 - root - INFO - conftest.py:58 - timer - Test test_rag_error_handling took 1.58 seconds
2024-10-25 15:26:01,717 - root - ERROR - error_handler.py:17 - wrapper - Error in generate_answer: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 63, in generate_answer
    return openai_service.generate_answer(query, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:26:01,717 - root - INFO - conftest.py:58 - timer - Test test_generate_answer_error_handling[Exception-Test error] took 0.00 seconds
2024-10-25 15:26:01,719 - root - INFO - rag.py:67 - rag_query - Processing query: Test question
2024-10-25 15:26:01,719 - root - ERROR - error_handler.py:17 - wrapper - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 68, in rag_query
    search = get_search_strategy(search_strategy, book_data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:26:01,719 - root - INFO - conftest.py:58 - timer - Test test_rag_query_error_handling took 0.00 seconds
2024-10-25 15:26:38,019 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 15:26:38,020 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 15:26:38,026 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:26:38,027 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:26:38,034 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:26:38,351 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:26:38,356 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:26:40,775 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:26:40,776 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:26:41,153 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 15:26:41,165 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 15:26:42,752 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.59 seconds
2024-10-25 15:26:42,753 - root - ERROR - error_handler.py:17 - wrapper - Error in get_search_strategy: Unknown search strategy: unknown
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 131, in get_search_strategy
    raise ValueError(f"Unknown search strategy: {strategy}")
ValueError: Unknown search strategy: unknown
2024-10-25 15:26:42,816 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.06 seconds
2024-10-25 15:26:42,818 - root - ERROR - error_handler.py:17 - wrapper - Error in _create_weighted_query_embedding: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 116, in _create_weighted_query_embedding
    return create_embeddings([weighted_query])[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:26:42,819 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: could not convert string to float: 'Sorry, I encountered an error while processing your request: Test error'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 95, in _get_embedding_scores
    return np.array([cosine_similarity(query_embedding, chunk_embedding) for chunk_embedding in self.embeddings])
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/embedding.py", line 72, in cosine_similarity
    a = np.array(a, dtype=np.float64)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'Sorry, I encountered an error while processing your request: Test error'
2024-10-25 15:26:42,820 - root - ERROR - error_handler.py:17 - wrapper - Error in _combine_scores: 'str' object has no attribute 'min'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 121, in _combine_scores
    embedding_scores = (embedding_scores - embedding_scores.min()) / (embedding_scores.max() - embedding_scores.min() + 1e-8)
                                           ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'min'
2024-10-25 15:26:42,820 - root - ERROR - search.py:68 - search - Error in hybrid search: could not convert string to float: 'S'
2024-10-25 15:26:42,820 - root - ERROR - error_handler.py:17 - wrapper - Error in search: could not convert string to float: 'S'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 66, in search
    return self._get_top_chunks(combined_scores, top_k)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 32, in _get_top_chunks
    return [{'chunk': self.chunks[i], 'score': float(scores[i])} for i in top_indices]
                                               ^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'S'
2024-10-25 15:26:42,822 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.01 seconds
2024-10-25 15:26:42,824 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 15:26:42,825 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 15:26:42,825 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 15:26:42,826 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 15:26:42,826 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 15:26:42,827 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 15:32:22,899 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 15:32:22,901 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 15:32:22,908 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:32:22,908 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:32:22,916 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:32:23,567 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:32:23,572 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:32:26,602 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:32:26,603 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:32:26,825 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 15:32:26,841 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 15:32:28,352 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.51 seconds
2024-10-25 15:32:28,353 - root - ERROR - error_handler.py:17 - wrapper - Error in get_search_strategy: Unknown search strategy: unknown
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 127, in get_search_strategy
    raise ValueError(f"Unknown search strategy: {strategy}")
ValueError: Unknown search strategy: unknown
2024-10-25 15:32:28,354 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.00 seconds
2024-10-25 15:32:28,355 - root - ERROR - error_handler.py:17 - wrapper - Error in _create_weighted_query_embedding: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 112, in _create_weighted_query_embedding
    return create_embeddings([weighted_query])[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:32:28,356 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: could not convert string to float: 'Sorry, I encountered an error while processing your request: Test error'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 91, in _get_embedding_scores
    return np.array([cosine_similarity(query_embedding, chunk_embedding) for chunk_embedding in self.embeddings])
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/embedding.py", line 72, in cosine_similarity
    a = np.array(a, dtype=np.float64)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'Sorry, I encountered an error while processing your request: Test error'
2024-10-25 15:32:28,357 - root - ERROR - error_handler.py:17 - wrapper - Error in _combine_scores: 'str' object has no attribute 'min'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 117, in _combine_scores
    embedding_scores = (embedding_scores - embedding_scores.min()) / (embedding_scores.max() - embedding_scores.min() + 1e-8)
                                           ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'min'
2024-10-25 15:32:28,357 - root - ERROR - error_handler.py:17 - wrapper - Error in search: could not convert string to float: 'S'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 65, in search
    return self._get_top_chunks(combined_scores, top_k)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 32, in _get_top_chunks
    return [{'chunk': self.chunks[i], 'score': float(scores[i])} for i in top_indices]
                                               ^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'S'
2024-10-25 15:32:28,421 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.07 seconds
2024-10-25 15:32:28,423 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 15:32:28,424 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 15:32:28,424 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 15:32:28,425 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 15:32:28,425 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 15:32:28,426 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 15:32:28,426 - root - INFO - conftest.py:58 - timer - Test test_simple_search_error_handling took 0.00 seconds
2024-10-25 15:32:28,426 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search_error_handling took 0.00 seconds
2024-10-25 15:33:17,428 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 15:33:17,429 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 15:33:17,436 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:33:17,436 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:33:17,445 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:33:17,763 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:33:17,765 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:33:18,072 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:33:18,073 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:33:18,252 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 15:33:19,781 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:33:19,781 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:33:19,781 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:33:20,079 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:33:20,080 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:33:20,319 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:33:20,320 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:33:21,426 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:33:21,435 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[1] took 3.17 seconds
2024-10-25 15:33:21,441 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:33:21,441 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:33:21,441 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:33:21,936 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:33:21,936 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:33:22,272 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:33:22,273 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:33:23,133 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:33:23,141 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[2] took 1.70 seconds
2024-10-25 15:33:23,146 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:33:23,147 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:33:23,147 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:33:23,685 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:33:23,686 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:33:23,983 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:33:23,983 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:33:24,947 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:33:24,955 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[3] took 1.81 seconds
2024-10-25 15:33:24,958 - root - INFO - conftest.py:58 - timer - Test test_generate_answer took 0.00 seconds
2024-10-25 15:33:24,961 - root - INFO - rag.py:67 - rag_query - Processing query: Test question
2024-10-25 15:33:24,962 - root - INFO - conftest.py:58 - timer - Test test_rag_query took 0.00 seconds
2024-10-25 15:33:24,963 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[Short query] took 0.00 seconds
2024-10-25 15:33:24,965 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[A very long query that contains multiple sentences and specific terms] took 0.00 seconds
2024-10-25 15:33:24,966 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[] took 0.00 seconds
2024-10-25 15:33:24,967 - root - INFO - rag.py:67 - rag_query - Processing query: Test query
2024-10-25 15:33:24,968 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:33:24,969 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:33:24,969 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:33:25,441 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:33:25,443 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:33:26,056 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:33:26,056 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:33:26,926 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:33:27,034 - root - INFO - conftest.py:58 - timer - Test test_rag_query_performance took 2.07 seconds
2024-10-25 15:33:27,036 - root - INFO - rag.py:67 - rag_query - Processing query: Test query
2024-10-25 15:33:27,037 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:33:27,037 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:33:27,037 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:33:27,382 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:33:27,383 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:33:29,646 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:33:29,646 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:33:30,465 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:33:30,466 - root - ERROR - error_handler.py:17 - wrapper - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 71, in rag_query
    return openai_service.generate_answer(question, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
src.error_handler.RAGError: Test error
2024-10-25 15:33:30,472 - root - INFO - conftest.py:58 - timer - Test test_rag_error_handling took 3.44 seconds
2024-10-25 15:33:30,474 - root - ERROR - error_handler.py:17 - wrapper - Error in generate_answer: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 63, in generate_answer
    return openai_service.generate_answer(query, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
src.error_handler.RAGError: Test error
2024-10-25 15:33:30,475 - root - INFO - conftest.py:58 - timer - Test test_generate_answer_error_handling[RAGError-Test error] took 0.00 seconds
2024-10-25 15:33:30,477 - root - ERROR - error_handler.py:17 - wrapper - Error in generate_answer: Unexpected error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 63, in generate_answer
    return openai_service.generate_answer(query, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Unexpected error
2024-10-25 15:33:30,478 - root - INFO - conftest.py:58 - timer - Test test_generate_answer_error_handling[Exception-Unexpected error] took 0.00 seconds
2024-10-25 15:33:30,480 - root - INFO - rag.py:67 - rag_query - Processing query: Test question
2024-10-25 15:33:30,481 - root - ERROR - error_handler.py:17 - wrapper - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 68, in rag_query
    search = get_search_strategy(search_strategy, book_data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
src.error_handler.RAGError: Test error
2024-10-25 15:33:30,482 - root - INFO - conftest.py:58 - timer - Test test_rag_query_error_handling took 0.00 seconds
2024-10-25 15:34:01,058 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 15:34:01,059 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 15:34:01,066 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:34:01,066 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:34:01,073 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:34:01,460 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:34:01,462 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:34:02,283 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:34:02,283 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:34:02,564 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 15:34:02,572 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 15:34:04,141 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.57 seconds
2024-10-25 15:34:04,142 - root - ERROR - error_handler.py:17 - wrapper - Error in get_search_strategy: Unknown search strategy: unknown
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 127, in get_search_strategy
    raise ValueError(f"Unknown search strategy: {strategy}")
ValueError: Unknown search strategy: unknown
2024-10-25 15:34:04,144 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.00 seconds
2024-10-25 15:34:04,145 - root - ERROR - error_handler.py:17 - wrapper - Error in _create_weighted_query_embedding: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 112, in _create_weighted_query_embedding
    return create_embeddings([weighted_query])[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:34:04,147 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: could not convert string to float: 'Sorry, I encountered an error while processing your request: Test error'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 91, in _get_embedding_scores
    return np.array([cosine_similarity(query_embedding, chunk_embedding) for chunk_embedding in self.embeddings])
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/embedding.py", line 72, in cosine_similarity
    a = np.array(a, dtype=np.float64)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'Sorry, I encountered an error while processing your request: Test error'
2024-10-25 15:34:04,148 - root - ERROR - error_handler.py:17 - wrapper - Error in _combine_scores: 'str' object has no attribute 'min'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 117, in _combine_scores
    embedding_scores = (embedding_scores - embedding_scores.min()) / (embedding_scores.max() - embedding_scores.min() + 1e-8)
                                           ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'min'
2024-10-25 15:34:04,148 - root - ERROR - error_handler.py:17 - wrapper - Error in search: could not convert string to float: 'S'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 65, in search
    return self._get_top_chunks(combined_scores, top_k)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 32, in _get_top_chunks
    return [{'chunk': self.chunks[i], 'score': float(scores[i])} for i in top_indices]
                                               ^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'S'
2024-10-25 15:34:04,221 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.08 seconds
2024-10-25 15:34:04,223 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 15:34:04,224 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 15:34:04,225 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 15:34:04,225 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 15:34:04,226 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 15:34:04,227 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 15:34:04,228 - root - INFO - conftest.py:58 - timer - Test test_simple_search_error_handling took 0.00 seconds
2024-10-25 15:34:04,229 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search_error_handling took 0.00 seconds
2024-10-25 15:35:30,190 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 15:35:30,191 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 15:35:30,198 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:35:30,199 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:35:30,207 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:35:30,520 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:35:30,520 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:35:30,881 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:35:30,881 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:35:31,753 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 15:35:31,769 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 15:35:33,274 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.50 seconds
2024-10-25 15:35:33,274 - root - ERROR - error_handler.py:17 - wrapper - Error in get_search_strategy: Unknown search strategy: unknown
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 135, in get_search_strategy
    raise ValueError(f"Unknown search strategy: {strategy}")
ValueError: Unknown search strategy: unknown
2024-10-25 15:35:33,275 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.00 seconds
2024-10-25 15:35:33,276 - root - ERROR - error_handler.py:17 - wrapper - Error in _create_weighted_query_embedding: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 115, in _create_weighted_query_embedding
    return create_embeddings([weighted_query])[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:35:33,278 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: could not convert string to float: 'Sorry, I encountered an error while processing your request: Test error'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 94, in _get_embedding_scores
    return np.array([cosine_similarity(query_embedding, chunk_embedding) for chunk_embedding in self.embeddings])
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/embedding.py", line 72, in cosine_similarity
    a = np.array(a, dtype=np.float64)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'Sorry, I encountered an error while processing your request: Test error'
2024-10-25 15:35:33,279 - root - ERROR - error_handler.py:17 - wrapper - Error in _combine_scores: 'str' object has no attribute 'min'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 120, in _combine_scores
    embedding_scores = (embedding_scores - embedding_scores.min()) / (embedding_scores.max() - embedding_scores.min() + 1e-8)
                                           ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'min'
2024-10-25 15:35:33,279 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_top_chunks: could not convert string to float: 'S'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 126, in _get_top_chunks
    return [{'chunk': self.chunks[i], 'score': float(scores[i])} for i in top_indices]
                                               ^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'S'
2024-10-25 15:35:33,342 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.07 seconds
2024-10-25 15:35:33,344 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 15:35:33,345 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 15:35:33,346 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 15:35:33,346 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 15:35:33,347 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 15:35:33,347 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 15:35:33,348 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:35:33,348 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:35:33,348 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:35:34,282 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:35:34,284 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:35:34,577 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:35:34,578 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:35:34,584 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x1450e7a60>, 'json_data': {'input': ['error query'], 'model': 'text-embedding-3-small', 'encoding_format': 'base64'}}
2024-10-25 15:35:34,632 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-25 15:35:34,632 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-25 15:35:34,766 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x14502f440>
2024-10-25 15:35:34,767 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.started ssl_context=<ssl.SSLContext object at 0x11f749c50> server_hostname='api.openai.com' timeout=5.0
2024-10-25 15:35:34,806 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x11f4415b0>
2024-10-25 15:35:34,807 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-25 15:35:34,808 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-25 15:35:34,808 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-25 15:35:34,808 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-25 15:35:34,808 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-25 15:35:35,155 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 25 Oct 2024 14:35:35 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-3-small'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'140'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999998'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'0s'), (b'x-request-id', b'req_acf4eb8d413ef18910e3f221a83f1b90'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=TWa9kkv1fKunfW6Q.3KwIiLTuVla_Kx.cG1cwJfyBMs-1729866935-1.0.1.1-cTzWe6TeO5ELceoB22BSbAU1Zo2y84nwTlaJ6kCQ9W3MHzNHOMAVfhgh1.7PuOiwKjcY.1..dKnM.R0lK3PQsw; path=/; expires=Fri, 25-Oct-24 15:05:35 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=7vsOYdNthk.lwwQyXHbWclTHjzblNPrz.bzFXnLj8yk-1729866935204-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d82ef171f89785c-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-25 15:35:35,157 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-25 15:35:35,158 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-25 15:35:35,159 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-25 15:35:35,159 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-25 15:35:35,159 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-25 15:35:35,159 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers([('date', 'Fri, 25 Oct 2024 14:35:35 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-allow-origin', '*'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-model', 'text-embedding-3-small'), ('openai-organization', 'uinside'), ('openai-processing-ms', '140'), ('openai-version', '2020-10-01'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '5000000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '4999998'), ('x-ratelimit-reset-requests', '6ms'), ('x-ratelimit-reset-tokens', '0s'), ('x-request-id', 'req_acf4eb8d413ef18910e3f221a83f1b90'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=TWa9kkv1fKunfW6Q.3KwIiLTuVla_Kx.cG1cwJfyBMs-1729866935-1.0.1.1-cTzWe6TeO5ELceoB22BSbAU1Zo2y84nwTlaJ6kCQ9W3MHzNHOMAVfhgh1.7PuOiwKjcY.1..dKnM.R0lK3PQsw; path=/; expires=Fri, 25-Oct-24 15:05:35 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=7vsOYdNthk.lwwQyXHbWclTHjzblNPrz.bzFXnLj8yk-1729866935204-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d82ef171f89785c-LIS'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-25 15:35:35,159 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_acf4eb8d413ef18910e3f221a83f1b90
2024-10-25 15:35:36,141 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:35:36,149 - root - ERROR - error_handler.py:17 - wrapper - Error in search: shapes (1536,) and (3,) not aligned: 1536 (dim 0) != 3 (dim 0)
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 38, in search
    scores = np.array([cosine_similarity(query_embedding, chunk_embedding) for chunk_embedding in self.embeddings])
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/embedding.py", line 74, in cosine_similarity
    return np.dot(a, b) / (np.linalg.norm(a) * np.linalg.norm(b))
           ^^^^^^^^^^^^
ValueError: shapes (1536,) and (3,) not aligned: 1536 (dim 0) != 3 (dim 0)
2024-10-25 15:35:36,157 - root - INFO - conftest.py:58 - timer - Test test_simple_search_error_handling took 2.81 seconds
2024-10-25 15:35:36,162 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:35:36,162 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:35:36,163 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:35:36,482 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:35:36,484 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:35:37,147 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:35:37,148 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:35:37,151 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x145016e80>, 'json_data': {'input': ['error error error error error error error error error error error error error error error mistake mistake mistake mistake mistake mistake mistake mistake mistake mistake mistake mistake mistake mistake mistake fault fault fault fault fault fault fault fault fault fault fault fault fault fault fault erroneousness erroneousness erroneousness erroneousness erroneousness erroneousness erroneousness erroneousness erroneousness erroneousness erroneousness erroneousness erroneousness erroneousness erroneousness erroneous_belief erroneous_belief erroneous_belief erroneous_belief erroneous_belief erroneous_belief erroneous_belief erroneous_belief erroneous_belief erroneous_belief erroneous_belief erroneous_belief erroneous_belief erroneous_belief erroneous_belief misplay misplay misplay misplay misplay misplay misplay misplay misplay misplay misplay misplay misplay misplay misplay wrongdoing wrongdoing wrongdoing wrongdoing wrongdoing wrongdoing wrongdoing wrongdoing wrongdoing wrongdoing wrongdoing wrongdoing wrongdoing computer_error computer_error computer_error computer_error computer_error computer_error computer_error computer_error computer_error computer_error computer_error computer_error computer_error computer_error computer_error query query query query query query query query query query query query query query query question question question question question question question question question question question question question question question inquiry inquiry inquiry inquiry inquiry inquiry inquiry inquiry inquiry inquiry inquiry inquiry inquiry inquiry inquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation'], 'model': 'text-embedding-3-small', 'encoding_format': 'base64'}}
2024-10-25 15:35:37,153 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-25 15:35:37,153 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-25 15:35:37,154 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-25 15:35:37,154 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-25 15:35:37,154 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-25 15:35:37,154 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-25 15:35:37,425 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 25 Oct 2024 14:35:37 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-3-small'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'74'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999519'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'5ms'), (b'x-request-id', b'req_8278ed17509c6a3d6fcd7af77533f536'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d82ef25ba80785c-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-25 15:35:37,427 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-25 15:35:37,427 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-25 15:35:37,428 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-25 15:35:37,429 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-25 15:35:37,429 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-25 15:35:37,429 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers({'date': 'Fri, 25 Oct 2024 14:35:37 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-allow-origin': '*', 'access-control-expose-headers': 'X-Request-ID', 'openai-model': 'text-embedding-3-small', 'openai-organization': 'uinside', 'openai-processing-ms': '74', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '5000000', 'x-ratelimit-remaining-requests': '9999', 'x-ratelimit-remaining-tokens': '4999519', 'x-ratelimit-reset-requests': '6ms', 'x-ratelimit-reset-tokens': '5ms', 'x-request-id': 'req_8278ed17509c6a3d6fcd7af77533f536', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d82ef25ba80785c-LIS', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-25 15:35:37,429 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_8278ed17509c6a3d6fcd7af77533f536
2024-10-25 15:35:38,283 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:35:38,284 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: shapes (1536,) and (3,) not aligned: 1536 (dim 0) != 3 (dim 0)
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 94, in _get_embedding_scores
    return np.array([cosine_similarity(query_embedding, chunk_embedding) for chunk_embedding in self.embeddings])
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/embedding.py", line 74, in cosine_similarity
    return np.dot(a, b) / (np.linalg.norm(a) * np.linalg.norm(b))
           ^^^^^^^^^^^^
ValueError: shapes (1536,) and (3,) not aligned: 1536 (dim 0) != 3 (dim 0)
2024-10-25 15:35:38,286 - root - ERROR - error_handler.py:17 - wrapper - Error in _combine_scores: 'str' object has no attribute 'min'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 120, in _combine_scores
    embedding_scores = (embedding_scores - embedding_scores.min()) / (embedding_scores.max() - embedding_scores.min() + 1e-8)
                                           ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'min'
2024-10-25 15:35:38,287 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_top_chunks: could not convert string to float: 'S'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 126, in _get_top_chunks
    return [{'chunk': self.chunks[i], 'score': float(scores[i])} for i in top_indices]
                                               ^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'S'
2024-10-25 15:35:38,295 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search_error_handling took 2.14 seconds
2024-10-25 15:38:44,927 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 15:38:44,929 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 15:38:44,936 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:38:44,936 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:38:44,945 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:38:45,367 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:38:45,368 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:38:45,657 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:38:45,657 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:38:45,865 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 15:38:45,872 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 15:38:47,524 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 94, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 15:38:47,525 - root - ERROR - error_handler.py:17 - wrapper - Error in _combine_scores: embedding_scores is a string: Sorry, I encountered an error while processing your request: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 122, in _combine_scores
    raise ValueError(f"embedding_scores is a string: {embedding_scores}")
ValueError: embedding_scores is a string: Sorry, I encountered an error while processing your request: 'list' object has no attribute 'shape'
2024-10-25 15:38:47,525 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_top_chunks: could not convert string to float: 'S'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 130, in _get_top_chunks
    return [{'chunk': self.chunks[i], 'score': float(scores[i])} for i in top_indices]
                                               ^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'S'
2024-10-25 15:38:47,588 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.72 seconds
2024-10-25 15:38:47,589 - root - ERROR - error_handler.py:17 - wrapper - Error in get_search_strategy: Unknown search strategy: unknown
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 139, in get_search_strategy
    raise ValueError(f"Unknown search strategy: {strategy}")
ValueError: Unknown search strategy: unknown
2024-10-25 15:38:47,590 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.00 seconds
2024-10-25 15:38:47,591 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 93, in _get_embedding_scores
    query_embedding = self._create_weighted_query_embedding(query)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:38:47,593 - root - ERROR - error_handler.py:17 - wrapper - Error in _combine_scores: embedding_scores is a string: Sorry, I encountered an error while processing your request: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 122, in _combine_scores
    raise ValueError(f"embedding_scores is a string: {embedding_scores}")
ValueError: embedding_scores is a string: Sorry, I encountered an error while processing your request: Test error
2024-10-25 15:38:47,593 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_top_chunks: could not convert string to float: 'S'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 130, in _get_top_chunks
    return [{'chunk': self.chunks[i], 'score': float(scores[i])} for i in top_indices]
                                               ^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'S'
2024-10-25 15:38:47,596 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.01 seconds
2024-10-25 15:38:47,597 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 15:38:47,598 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 15:38:47,598 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 15:38:47,599 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 94, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 15:38:47,601 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 15:38:47,602 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 15:38:47,603 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 15:38:47,603 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:38:47,603 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:38:47,604 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:38:47,886 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:38:47,886 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:38:48,160 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:38:48,160 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:38:49,119 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:38:49,120 - root - ERROR - error_handler.py:17 - wrapper - Error in search: shapes (1536,) and (3,) not aligned: 1536 (dim 0) != 3 (dim 0)
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 38, in search
    scores = np.array([cosine_similarity(query_embedding, chunk_embedding) for chunk_embedding in self.embeddings])
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/embedding.py", line 74, in cosine_similarity
    return np.dot(a, b) / (np.linalg.norm(a) * np.linalg.norm(b))
           ^^^^^^^^^^^^
ValueError: shapes (1536,) and (3,) not aligned: 1536 (dim 0) != 3 (dim 0)
2024-10-25 15:38:49,124 - root - INFO - conftest.py:58 - timer - Test test_simple_search_error_handling took 1.52 seconds
2024-10-25 15:38:49,126 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:38:49,126 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:38:49,126 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:38:49,405 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:38:49,405 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:38:49,666 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:38:49,666 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:38:50,609 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:38:50,609 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 94, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 15:38:50,610 - root - ERROR - error_handler.py:17 - wrapper - Error in _combine_scores: embedding_scores is a string: Sorry, I encountered an error while processing your request: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 122, in _combine_scores
    raise ValueError(f"embedding_scores is a string: {embedding_scores}")
ValueError: embedding_scores is a string: Sorry, I encountered an error while processing your request: 'list' object has no attribute 'shape'
2024-10-25 15:38:50,610 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_top_chunks: could not convert string to float: 'S'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 130, in _get_top_chunks
    return [{'chunk': self.chunks[i], 'score': float(scores[i])} for i in top_indices]
                                               ^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'S'
2024-10-25 15:38:50,613 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search_error_handling took 1.49 seconds
2024-10-25 15:55:33,890 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 15:55:33,891 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 15:55:33,898 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:55:33,898 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:55:33,906 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:55:34,322 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:55:34,323 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:55:34,593 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:55:34,593 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:55:34,806 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 15:55:34,822 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 15:55:36,327 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 94, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 15:55:36,329 - root - ERROR - error_handler.py:17 - wrapper - Error in _combine_scores: embedding_scores is a string: Sorry, I encountered an error while processing your request: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 122, in _combine_scores
    raise ValueError(f"embedding_scores is a string: {embedding_scores}")
ValueError: embedding_scores is a string: Sorry, I encountered an error while processing your request: 'list' object has no attribute 'shape'
2024-10-25 15:55:36,329 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_top_chunks: could not convert string to float: 'S'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 130, in _get_top_chunks
    return [{'chunk': self.chunks[i], 'score': float(scores[i])} for i in top_indices]
                                               ^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'S'
2024-10-25 15:55:36,390 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.57 seconds
2024-10-25 15:55:36,391 - root - ERROR - error_handler.py:17 - wrapper - Error in get_search_strategy: Unknown search strategy: unknown
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 139, in get_search_strategy
    raise ValueError(f"Unknown search strategy: {strategy}")
ValueError: Unknown search strategy: unknown
2024-10-25 15:55:36,391 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.00 seconds
2024-10-25 15:55:36,392 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 93, in _get_embedding_scores
    query_embedding = self._create_weighted_query_embedding(query)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:55:36,393 - root - ERROR - error_handler.py:17 - wrapper - Error in _combine_scores: embedding_scores is a string: Sorry, I encountered an error while processing your request: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 122, in _combine_scores
    raise ValueError(f"embedding_scores is a string: {embedding_scores}")
ValueError: embedding_scores is a string: Sorry, I encountered an error while processing your request: Test error
2024-10-25 15:55:36,394 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_top_chunks: could not convert string to float: 'S'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 130, in _get_top_chunks
    return [{'chunk': self.chunks[i], 'score': float(scores[i])} for i in top_indices]
                                               ^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'S'
2024-10-25 15:55:36,396 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.00 seconds
2024-10-25 15:55:36,398 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 15:55:36,399 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 15:55:36,399 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 15:55:36,400 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 94, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 15:55:36,403 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 15:55:36,404 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 15:55:36,405 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 15:55:36,405 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:55:36,405 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:55:36,406 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:55:36,751 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:55:36,752 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:55:37,027 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:55:37,027 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:55:37,985 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:55:37,986 - root - ERROR - error_handler.py:17 - wrapper - Error in search: Vectors have different shapes: (1536,) and (3,)
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 38, in search
    scores = np.array([cosine_similarity(query_embedding, chunk_embedding) for chunk_embedding in self.embeddings])
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/embedding.py", line 82, in cosine_similarity
    raise ValueError(f"Vectors have different shapes: {a.shape} and {b.shape}")
ValueError: Vectors have different shapes: (1536,) and (3,)
2024-10-25 15:55:37,996 - root - INFO - conftest.py:58 - timer - Test test_simple_search_error_handling took 1.59 seconds
2024-10-25 15:55:38,000 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:55:38,001 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:55:38,001 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:55:38,423 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:55:38,425 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:55:38,662 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:55:38,663 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:55:39,588 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:55:39,589 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 94, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 15:55:39,590 - root - ERROR - error_handler.py:17 - wrapper - Error in _combine_scores: embedding_scores is a string: Sorry, I encountered an error while processing your request: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 122, in _combine_scores
    raise ValueError(f"embedding_scores is a string: {embedding_scores}")
ValueError: embedding_scores is a string: Sorry, I encountered an error while processing your request: 'list' object has no attribute 'shape'
2024-10-25 15:55:39,590 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_top_chunks: could not convert string to float: 'S'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 130, in _get_top_chunks
    return [{'chunk': self.chunks[i], 'score': float(scores[i])} for i in top_indices]
                                               ^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'S'
2024-10-25 15:55:39,598 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search_error_handling took 1.60 seconds
2024-10-25 16:01:37,694 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 16:01:37,695 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 16:01:37,702 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:01:37,702 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:01:37,711 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:01:38,127 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:01:38,133 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:01:39,805 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:01:39,805 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:01:40,572 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 16:01:40,589 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 16:01:42,111 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 94, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 16:01:42,113 - root - ERROR - error_handler.py:17 - wrapper - Error in _combine_scores: embedding_scores is a string: Sorry, I encountered an error while processing your request: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 122, in _combine_scores
    raise ValueError(f"embedding_scores is a string: {embedding_scores}")
ValueError: embedding_scores is a string: Sorry, I encountered an error while processing your request: 'list' object has no attribute 'shape'
2024-10-25 16:01:42,113 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_top_chunks: could not convert string to float: 'S'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 130, in _get_top_chunks
    return [{'chunk': self.chunks[i], 'score': float(scores[i])} for i in top_indices]
                                               ^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'S'
2024-10-25 16:01:42,177 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.59 seconds
2024-10-25 16:01:42,178 - root - ERROR - error_handler.py:17 - wrapper - Error in get_search_strategy: Unknown search strategy: unknown
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 139, in get_search_strategy
    raise ValueError(f"Unknown search strategy: {strategy}")
ValueError: Unknown search strategy: unknown
2024-10-25 16:01:42,178 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.00 seconds
2024-10-25 16:01:42,179 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 93, in _get_embedding_scores
    query_embedding = self._create_weighted_query_embedding(query)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 16:01:42,180 - root - ERROR - error_handler.py:17 - wrapper - Error in _combine_scores: embedding_scores is a string: Sorry, I encountered an error while processing your request: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 122, in _combine_scores
    raise ValueError(f"embedding_scores is a string: {embedding_scores}")
ValueError: embedding_scores is a string: Sorry, I encountered an error while processing your request: Test error
2024-10-25 16:01:42,180 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_top_chunks: could not convert string to float: 'S'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 130, in _get_top_chunks
    return [{'chunk': self.chunks[i], 'score': float(scores[i])} for i in top_indices]
                                               ^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'S'
2024-10-25 16:01:42,182 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.00 seconds
2024-10-25 16:01:42,184 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 16:01:42,185 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 16:01:42,186 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 16:01:42,187 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 94, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 16:01:42,189 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 16:01:42,191 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 16:01:42,192 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 16:01:42,192 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:01:42,192 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:01:42,192 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:01:43,831 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:01:43,832 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:01:47,898 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:01:47,898 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:01:49,244 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:01:49,245 - root - ERROR - error_handler.py:17 - wrapper - Error in search: Vectors have different shapes: (1536,) and (3,)
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 38, in search
    scores = np.array([cosine_similarity(query_embedding, chunk_embedding) for chunk_embedding in self.embeddings])
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/embedding.py", line 82, in cosine_similarity
    raise ValueError(f"Vectors have different shapes: {a.shape} and {b.shape}")
ValueError: Vectors have different shapes: (1536,) and (3,)
2024-10-25 16:01:49,253 - root - INFO - conftest.py:58 - timer - Test test_simple_search_error_handling took 7.06 seconds
2024-10-25 16:01:49,258 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:01:49,258 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:01:49,258 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:01:49,956 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:01:49,957 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:01:50,245 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:01:50,246 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:01:51,133 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:01:51,134 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 94, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 16:01:51,136 - root - ERROR - error_handler.py:17 - wrapper - Error in _combine_scores: embedding_scores is a string: Sorry, I encountered an error while processing your request: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 122, in _combine_scores
    raise ValueError(f"embedding_scores is a string: {embedding_scores}")
ValueError: embedding_scores is a string: Sorry, I encountered an error while processing your request: 'list' object has no attribute 'shape'
2024-10-25 16:01:51,137 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_top_chunks: could not convert string to float: 'S'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 130, in _get_top_chunks
    return [{'chunk': self.chunks[i], 'score': float(scores[i])} for i in top_indices]
                                               ^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'S'
2024-10-25 16:01:51,145 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search_error_handling took 1.89 seconds
2024-10-25 16:02:06,025 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 16:02:06,026 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 16:02:06,032 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:02:06,033 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:02:06,040 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:02:06,449 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:02:06,454 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:02:06,872 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:02:06,872 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:02:07,710 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 16:02:07,725 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 16:02:09,290 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 94, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 16:02:09,291 - root - ERROR - error_handler.py:17 - wrapper - Error in _combine_scores: embedding_scores is a string: Sorry, I encountered an error while processing your request: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 122, in _combine_scores
    raise ValueError(f"embedding_scores is a string: {embedding_scores}")
ValueError: embedding_scores is a string: Sorry, I encountered an error while processing your request: 'list' object has no attribute 'shape'
2024-10-25 16:02:09,291 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_top_chunks: could not convert string to float: 'S'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 130, in _get_top_chunks
    return [{'chunk': self.chunks[i], 'score': float(scores[i])} for i in top_indices]
                                               ^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'S'
2024-10-25 16:02:09,353 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.63 seconds
2024-10-25 16:02:09,354 - root - ERROR - error_handler.py:17 - wrapper - Error in get_search_strategy: Unknown search strategy: unknown
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 139, in get_search_strategy
    raise ValueError(f"Unknown search strategy: {strategy}")
ValueError: Unknown search strategy: unknown
2024-10-25 16:02:09,354 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.00 seconds
2024-10-25 16:02:09,355 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 93, in _get_embedding_scores
    query_embedding = self._create_weighted_query_embedding(query)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 16:02:09,357 - root - ERROR - error_handler.py:17 - wrapper - Error in _combine_scores: embedding_scores is a string: Sorry, I encountered an error while processing your request: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 122, in _combine_scores
    raise ValueError(f"embedding_scores is a string: {embedding_scores}")
ValueError: embedding_scores is a string: Sorry, I encountered an error while processing your request: Test error
2024-10-25 16:02:09,357 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_top_chunks: could not convert string to float: 'S'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 130, in _get_top_chunks
    return [{'chunk': self.chunks[i], 'score': float(scores[i])} for i in top_indices]
                                               ^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'S'
2024-10-25 16:02:09,359 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.00 seconds
2024-10-25 16:02:09,361 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 16:02:09,362 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 16:02:09,362 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 16:02:09,363 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 94, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 16:02:09,366 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 16:02:09,367 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 16:02:09,368 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 16:02:09,369 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:02:09,369 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:02:09,369 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:02:10,339 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:02:10,341 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:02:10,933 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:02:10,933 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:02:11,932 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:02:11,933 - root - ERROR - error_handler.py:17 - wrapper - Error in search: Vectors have different shapes: (1536,) and (3,)
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 38, in search
    scores = np.array([cosine_similarity(query_embedding, chunk_embedding) for chunk_embedding in self.embeddings])
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/embedding.py", line 82, in cosine_similarity
    raise ValueError(f"Vectors have different shapes: {a.shape} and {b.shape}")
ValueError: Vectors have different shapes: (1536,) and (3,)
2024-10-25 16:02:11,938 - root - INFO - conftest.py:58 - timer - Test test_simple_search_error_handling took 2.57 seconds
2024-10-25 16:02:11,941 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:02:11,942 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:02:11,942 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:02:12,328 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:02:12,329 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:02:14,436 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:02:14,437 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:02:15,308 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:02:15,309 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 94, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 16:02:15,311 - root - ERROR - error_handler.py:17 - wrapper - Error in _combine_scores: embedding_scores is a string: Sorry, I encountered an error while processing your request: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 122, in _combine_scores
    raise ValueError(f"embedding_scores is a string: {embedding_scores}")
ValueError: embedding_scores is a string: Sorry, I encountered an error while processing your request: 'list' object has no attribute 'shape'
2024-10-25 16:02:15,312 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_top_chunks: could not convert string to float: 'S'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 130, in _get_top_chunks
    return [{'chunk': self.chunks[i], 'score': float(scores[i])} for i in top_indices]
                                               ^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'S'
2024-10-25 16:02:15,320 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search_error_handling took 3.38 seconds
2024-10-25 16:10:38,368 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 16:10:38,370 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 16:10:38,376 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:10:38,377 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:10:38,384 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:10:39,068 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:10:39,070 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:10:40,994 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:10:40,995 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:10:41,666 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 16:10:41,671 - root - ERROR - error_handler.py:17 - wrapper - Error in __init__: Some embeddings have incorrect dimension
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 29, in __init__
    raise ValueError("Some embeddings have incorrect dimension")
ValueError: Some embeddings have incorrect dimension
2024-10-25 16:10:41,741 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.07 seconds
2024-10-25 16:10:41,742 - root - ERROR - error_handler.py:17 - wrapper - Error in __init__: Some embeddings have incorrect dimension
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 29, in __init__
    raise ValueError("Some embeddings have incorrect dimension")
ValueError: Some embeddings have incorrect dimension
2024-10-25 16:10:43,278 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 116, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 16:10:43,278 - root - DEBUG - search.py:81 - search - BM25 scores shape: (4,), dtype: float64
2024-10-25 16:10:43,278 - root - ERROR - error_handler.py:17 - wrapper - Error in search: Error in hybrid search: 'str' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 82, in search
    logger.debug(f"Embedding scores shape: {embedding_scores.shape}, dtype: {embedding_scores.dtype}")
                                            ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'shape'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 90, in search
    raise RAGError(f"Error in hybrid search: {str(e)}")
src.error_handler.RAGError: Error in hybrid search: 'str' object has no attribute 'shape'
2024-10-25 16:10:43,281 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.54 seconds
2024-10-25 16:10:43,281 - root - ERROR - error_handler.py:17 - wrapper - Error in __init__: Some embeddings have incorrect dimension
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 29, in __init__
    raise ValueError("Some embeddings have incorrect dimension")
ValueError: Some embeddings have incorrect dimension
2024-10-25 16:10:43,282 - root - ERROR - error_handler.py:17 - wrapper - Error in get_search_strategy: __init__() should return None, not 'str'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 157, in get_search_strategy
    return SimpleSearch(data_source)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: __init__() should return None, not 'str'
2024-10-25 16:10:43,283 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.00 seconds
2024-10-25 16:10:43,284 - root - ERROR - error_handler.py:17 - wrapper - Error in __init__: Some embeddings have incorrect dimension
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 29, in __init__
    raise ValueError("Some embeddings have incorrect dimension")
ValueError: Some embeddings have incorrect dimension
2024-10-25 16:10:43,284 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 115, in _get_embedding_scores
    query_embedding = self._create_weighted_query_embedding(query)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 16:10:43,286 - root - DEBUG - search.py:81 - search - BM25 scores shape: (4,), dtype: float64
2024-10-25 16:10:43,286 - root - ERROR - error_handler.py:17 - wrapper - Error in search: Error in hybrid search: 'str' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 82, in search
    logger.debug(f"Embedding scores shape: {embedding_scores.shape}, dtype: {embedding_scores.dtype}")
                                            ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'shape'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 90, in search
    raise RAGError(f"Error in hybrid search: {str(e)}")
src.error_handler.RAGError: Error in hybrid search: 'str' object has no attribute 'shape'
2024-10-25 16:10:43,289 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.01 seconds
2024-10-25 16:10:43,289 - root - ERROR - error_handler.py:17 - wrapper - Error in __init__: Some embeddings have incorrect dimension
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 29, in __init__
    raise ValueError("Some embeddings have incorrect dimension")
ValueError: Some embeddings have incorrect dimension
2024-10-25 16:10:43,291 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 16:10:43,291 - root - ERROR - error_handler.py:17 - wrapper - Error in __init__: Some embeddings have incorrect dimension
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 29, in __init__
    raise ValueError("Some embeddings have incorrect dimension")
ValueError: Some embeddings have incorrect dimension
2024-10-25 16:10:43,292 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 16:10:43,292 - root - ERROR - error_handler.py:17 - wrapper - Error in __init__: Some embeddings have incorrect dimension
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 29, in __init__
    raise ValueError("Some embeddings have incorrect dimension")
ValueError: Some embeddings have incorrect dimension
2024-10-25 16:10:43,293 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 16:10:43,293 - root - ERROR - error_handler.py:17 - wrapper - Error in __init__: Some embeddings have incorrect dimension
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 29, in __init__
    raise ValueError("Some embeddings have incorrect dimension")
ValueError: Some embeddings have incorrect dimension
2024-10-25 16:10:43,294 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 116, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 16:10:43,296 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 16:10:43,297 - root - ERROR - error_handler.py:17 - wrapper - Error in __init__: Some embeddings have incorrect dimension
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 29, in __init__
    raise ValueError("Some embeddings have incorrect dimension")
ValueError: Some embeddings have incorrect dimension
2024-10-25 16:10:43,298 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 16:10:43,298 - root - ERROR - error_handler.py:17 - wrapper - Error in __init__: Some embeddings have incorrect dimension
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 29, in __init__
    raise ValueError("Some embeddings have incorrect dimension")
ValueError: Some embeddings have incorrect dimension
2024-10-25 16:10:43,301 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 16:10:43,301 - root - ERROR - error_handler.py:17 - wrapper - Error in __init__: Some embeddings have incorrect dimension
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 29, in __init__
    raise ValueError("Some embeddings have incorrect dimension")
ValueError: Some embeddings have incorrect dimension
2024-10-25 16:10:43,304 - root - INFO - conftest.py:58 - timer - Test test_simple_search_error_handling took 0.00 seconds
2024-10-25 16:10:43,304 - root - ERROR - error_handler.py:17 - wrapper - Error in __init__: Some embeddings have incorrect dimension
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 29, in __init__
    raise ValueError("Some embeddings have incorrect dimension")
ValueError: Some embeddings have incorrect dimension
2024-10-25 16:10:43,305 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:10:43,306 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:10:43,306 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:10:44,450 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:10:44,451 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:10:44,900 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:10:44,901 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:10:45,961 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:10:45,962 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 116, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 16:10:45,963 - root - DEBUG - search.py:81 - search - BM25 scores shape: (4,), dtype: float64
2024-10-25 16:10:45,963 - root - ERROR - error_handler.py:17 - wrapper - Error in search: Error in hybrid search: 'str' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 82, in search
    logger.debug(f"Embedding scores shape: {embedding_scores.shape}, dtype: {embedding_scores.dtype}")
                                            ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'shape'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 90, in search
    raise RAGError(f"Error in hybrid search: {str(e)}")
src.error_handler.RAGError: Error in hybrid search: 'str' object has no attribute 'shape'
2024-10-25 16:10:45,978 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search_error_handling took 2.67 seconds
2024-10-25 16:11:46,239 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 16:11:46,241 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 16:11:46,248 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:11:46,250 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:11:46,259 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:11:46,922 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:11:46,922 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:11:47,448 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:11:47,448 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:11:47,701 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 16:11:49,300 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:11:49,300 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:11:49,300 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:11:50,417 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:11:50,417 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:11:51,171 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:11:51,171 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:11:52,027 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:11:52,029 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 116, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 16:11:52,031 - root - DEBUG - search.py:81 - search - BM25 scores shape: (3,), dtype: float64
2024-10-25 16:11:52,031 - root - ERROR - error_handler.py:17 - wrapper - Error in search: Error in hybrid search: 'str' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 82, in search
    logger.debug(f"Embedding scores shape: {embedding_scores.shape}, dtype: {embedding_scores.dtype}")
                                            ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'shape'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 90, in search
    raise RAGError(f"Error in hybrid search: {str(e)}")
src.error_handler.RAGError: Error in hybrid search: 'str' object has no attribute 'shape'
2024-10-25 16:11:52,098 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[1] took 4.39 seconds
2024-10-25 16:11:52,100 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:11:52,100 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:11:52,100 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:11:52,397 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:11:52,397 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:11:52,756 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:11:52,756 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:11:53,572 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:11:53,574 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 116, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 16:11:53,575 - root - DEBUG - search.py:81 - search - BM25 scores shape: (3,), dtype: float64
2024-10-25 16:11:53,575 - root - ERROR - error_handler.py:17 - wrapper - Error in search: Error in hybrid search: 'str' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 82, in search
    logger.debug(f"Embedding scores shape: {embedding_scores.shape}, dtype: {embedding_scores.dtype}")
                                            ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'shape'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 90, in search
    raise RAGError(f"Error in hybrid search: {str(e)}")
src.error_handler.RAGError: Error in hybrid search: 'str' object has no attribute 'shape'
2024-10-25 16:11:53,578 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[2] took 1.48 seconds
2024-10-25 16:11:53,580 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:11:53,580 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:11:53,580 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:11:53,968 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:11:53,969 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:11:54,388 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:11:54,389 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:11:55,357 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:11:55,359 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 116, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 16:11:55,359 - root - DEBUG - search.py:81 - search - BM25 scores shape: (3,), dtype: float64
2024-10-25 16:11:55,359 - root - ERROR - error_handler.py:17 - wrapper - Error in search: Error in hybrid search: 'str' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 82, in search
    logger.debug(f"Embedding scores shape: {embedding_scores.shape}, dtype: {embedding_scores.dtype}")
                                            ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'shape'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 90, in search
    raise RAGError(f"Error in hybrid search: {str(e)}")
src.error_handler.RAGError: Error in hybrid search: 'str' object has no attribute 'shape'
2024-10-25 16:11:55,362 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[3] took 1.78 seconds
2024-10-25 16:11:55,363 - root - INFO - conftest.py:58 - timer - Test test_generate_answer took 0.00 seconds
2024-10-25 16:11:55,364 - root - INFO - rag.py:67 - rag_query - Processing query: Test question
2024-10-25 16:11:55,364 - root - INFO - conftest.py:58 - timer - Test test_rag_query took 0.00 seconds
2024-10-25 16:11:55,365 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[Short query] took 0.00 seconds
2024-10-25 16:11:55,365 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[A very long query that contains multiple sentences and specific terms] took 0.00 seconds
2024-10-25 16:11:55,365 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[] took 0.00 seconds
2024-10-25 16:11:55,366 - root - INFO - rag.py:67 - rag_query - Processing query: Test query
2024-10-25 16:11:55,366 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:11:55,366 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:11:55,366 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:11:56,525 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:11:56,525 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:11:57,833 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:11:57,833 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:11:58,838 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:11:58,907 - root - INFO - conftest.py:58 - timer - Test test_rag_query_performance took 3.54 seconds
2024-10-25 16:11:58,910 - root - INFO - rag.py:67 - rag_query - Processing query: Test query
2024-10-25 16:11:58,910 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:11:58,911 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:11:58,911 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:11:59,662 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:11:59,662 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:12:00,880 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:12:00,880 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:12:01,679 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:12:01,680 - root - ERROR - error_handler.py:17 - wrapper - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 71, in rag_query
    return openai_service.generate_answer(question, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
src.error_handler.RAGError: Test error
2024-10-25 16:12:01,685 - root - INFO - conftest.py:58 - timer - Test test_rag_error_handling took 2.78 seconds
2024-10-25 16:12:01,685 - root - ERROR - error_handler.py:17 - wrapper - Error in generate_answer: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 63, in generate_answer
    return openai_service.generate_answer(query, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
src.error_handler.RAGError: Test error
2024-10-25 16:12:01,690 - root - INFO - conftest.py:58 - timer - Test test_generate_answer_error_handling[RAGError-Test error] took 0.00 seconds
2024-10-25 16:12:01,691 - root - ERROR - error_handler.py:17 - wrapper - Error in generate_answer: Unexpected error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 63, in generate_answer
    return openai_service.generate_answer(query, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Unexpected error
2024-10-25 16:12:01,691 - root - INFO - conftest.py:58 - timer - Test test_generate_answer_error_handling[Exception-Unexpected error] took 0.00 seconds
2024-10-25 16:12:01,692 - root - INFO - rag.py:67 - rag_query - Processing query: Test question
2024-10-25 16:12:01,692 - root - ERROR - error_handler.py:17 - wrapper - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 68, in rag_query
    search = get_search_strategy(search_strategy, book_data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
src.error_handler.RAGError: Test error
2024-10-25 16:12:01,694 - root - INFO - conftest.py:58 - timer - Test test_rag_query_error_handling took 0.00 seconds
2024-10-25 16:13:45,104 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 16:13:45,105 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 16:13:45,112 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:13:45,112 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:13:45,120 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:13:45,438 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:13:45,440 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:13:45,759 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:13:45,759 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:13:45,970 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 16:13:47,497 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:13:47,497 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:13:47,497 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:13:48,551 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:13:48,553 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:13:48,846 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:13:48,847 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:13:49,841 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:13:49,848 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 116, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 16:13:49,852 - root - DEBUG - search.py:81 - search - BM25 scores shape: (3,), dtype: float64
2024-10-25 16:13:49,852 - root - ERROR - error_handler.py:17 - wrapper - Error in search: Error in hybrid search: 'str' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 82, in search
    logger.debug(f"Embedding scores shape: {embedding_scores.shape}, dtype: {embedding_scores.dtype}")
                                            ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'shape'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 90, in search
    raise RAGError(f"Error in hybrid search: {str(e)}")
src.error_handler.RAGError: Error in hybrid search: 'str' object has no attribute 'shape'
2024-10-25 16:13:49,951 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[1] took 3.96 seconds
2024-10-25 16:13:49,953 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:13:49,953 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:13:49,953 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:13:50,247 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:13:50,248 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:13:50,540 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:13:50,541 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:13:51,517 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:13:51,525 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 116, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 16:13:51,526 - root - DEBUG - search.py:81 - search - BM25 scores shape: (3,), dtype: float64
2024-10-25 16:13:51,526 - root - ERROR - error_handler.py:17 - wrapper - Error in search: Error in hybrid search: 'str' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 82, in search
    logger.debug(f"Embedding scores shape: {embedding_scores.shape}, dtype: {embedding_scores.dtype}")
                                            ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'shape'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 90, in search
    raise RAGError(f"Error in hybrid search: {str(e)}")
src.error_handler.RAGError: Error in hybrid search: 'str' object has no attribute 'shape'
2024-10-25 16:13:51,533 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[2] took 1.58 seconds
2024-10-25 16:13:51,538 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:13:51,539 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:13:51,539 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:13:52,215 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:13:52,216 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:13:52,486 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:13:52,486 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:13:53,358 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:13:53,367 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 116, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 16:13:53,368 - root - DEBUG - search.py:81 - search - BM25 scores shape: (3,), dtype: float64
2024-10-25 16:13:53,368 - root - ERROR - error_handler.py:17 - wrapper - Error in search: Error in hybrid search: 'str' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 82, in search
    logger.debug(f"Embedding scores shape: {embedding_scores.shape}, dtype: {embedding_scores.dtype}")
                                            ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'shape'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 90, in search
    raise RAGError(f"Error in hybrid search: {str(e)}")
src.error_handler.RAGError: Error in hybrid search: 'str' object has no attribute 'shape'
2024-10-25 16:13:53,375 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[3] took 1.84 seconds
2024-10-25 16:13:53,377 - root - INFO - conftest.py:58 - timer - Test test_generate_answer took 0.00 seconds
2024-10-25 16:13:53,380 - root - INFO - rag.py:67 - rag_query - Processing query: Test question
2024-10-25 16:13:53,381 - root - INFO - conftest.py:58 - timer - Test test_rag_query took 0.00 seconds
2024-10-25 16:13:53,382 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[Short query] took 0.00 seconds
2024-10-25 16:13:53,383 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[A very long query that contains multiple sentences and specific terms] took 0.00 seconds
2024-10-25 16:13:53,384 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[] took 0.00 seconds
2024-10-25 16:13:53,385 - root - INFO - rag.py:67 - rag_query - Processing query: Test query
2024-10-25 16:13:53,386 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:13:53,386 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:13:53,386 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:13:53,917 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:13:53,918 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:13:54,955 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:13:54,956 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:13:55,788 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:13:55,899 - root - INFO - conftest.py:58 - timer - Test test_rag_query_performance took 2.51 seconds
2024-10-25 16:13:55,901 - root - INFO - rag.py:67 - rag_query - Processing query: Test query
2024-10-25 16:13:55,901 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:13:55,901 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:13:55,902 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:13:56,205 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:13:56,207 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:13:58,589 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:13:58,589 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:13:59,427 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:13:59,427 - root - ERROR - error_handler.py:17 - wrapper - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 71, in rag_query
    return openai_service.generate_answer(question, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
src.error_handler.RAGError: Test error
2024-10-25 16:13:59,437 - root - INFO - conftest.py:58 - timer - Test test_rag_error_handling took 3.54 seconds
2024-10-25 16:13:59,439 - root - ERROR - error_handler.py:17 - wrapper - Error in generate_answer: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 63, in generate_answer
    return openai_service.generate_answer(query, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
src.error_handler.RAGError: Test error
2024-10-25 16:13:59,442 - root - INFO - conftest.py:58 - timer - Test test_generate_answer_error_handling[RAGError-Test error] took 0.00 seconds
2024-10-25 16:13:59,443 - root - ERROR - error_handler.py:17 - wrapper - Error in generate_answer: Unexpected error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 63, in generate_answer
    return openai_service.generate_answer(query, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Unexpected error
2024-10-25 16:13:59,443 - root - INFO - conftest.py:58 - timer - Test test_generate_answer_error_handling[Exception-Unexpected error] took 0.00 seconds
2024-10-25 16:13:59,445 - root - INFO - rag.py:67 - rag_query - Processing query: Test question
2024-10-25 16:13:59,445 - root - ERROR - error_handler.py:17 - wrapper - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 68, in rag_query
    search = get_search_strategy(search_strategy, book_data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
src.error_handler.RAGError: Test error
2024-10-25 16:13:59,448 - root - INFO - conftest.py:58 - timer - Test test_rag_query_error_handling took 0.00 seconds
2024-10-25 16:14:30,138 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 16:14:30,139 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 16:14:30,146 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:14:30,146 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:14:30,154 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:14:30,476 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:14:30,479 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:14:30,740 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:14:30,740 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:14:31,065 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 16:14:32,565 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:14:32,566 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:14:32,567 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:14:32,874 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:14:32,876 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:14:33,187 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:14:33,187 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:14:34,117 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:14:34,126 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 116, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 16:14:34,128 - root - DEBUG - search.py:81 - search - BM25 scores shape: (3,), dtype: float64
2024-10-25 16:14:34,129 - root - ERROR - error_handler.py:17 - wrapper - Error in search: Error in hybrid search: 'str' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 82, in search
    logger.debug(f"Embedding scores shape: {embedding_scores.shape}, dtype: {embedding_scores.dtype}")
                                            ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'shape'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 90, in search
    raise RAGError(f"Error in hybrid search: {str(e)}")
src.error_handler.RAGError: Error in hybrid search: 'str' object has no attribute 'shape'
2024-10-25 16:14:34,227 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[1] took 3.15 seconds
2024-10-25 16:14:34,228 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:14:34,229 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:14:34,229 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:14:34,704 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:14:34,705 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:14:35,017 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:14:35,018 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:14:35,911 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:14:35,916 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 116, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 16:14:35,917 - root - DEBUG - search.py:81 - search - BM25 scores shape: (3,), dtype: float64
2024-10-25 16:14:35,917 - root - ERROR - error_handler.py:17 - wrapper - Error in search: Error in hybrid search: 'str' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 82, in search
    logger.debug(f"Embedding scores shape: {embedding_scores.shape}, dtype: {embedding_scores.dtype}")
                                            ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'shape'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 90, in search
    raise RAGError(f"Error in hybrid search: {str(e)}")
src.error_handler.RAGError: Error in hybrid search: 'str' object has no attribute 'shape'
2024-10-25 16:14:35,924 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[2] took 1.70 seconds
2024-10-25 16:14:35,929 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:14:35,930 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:14:35,930 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:14:36,331 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:14:36,333 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:14:36,786 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:14:36,787 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:14:37,597 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:14:37,605 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 116, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 16:14:37,606 - root - DEBUG - search.py:81 - search - BM25 scores shape: (3,), dtype: float64
2024-10-25 16:14:37,606 - root - ERROR - error_handler.py:17 - wrapper - Error in search: Error in hybrid search: 'str' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 82, in search
    logger.debug(f"Embedding scores shape: {embedding_scores.shape}, dtype: {embedding_scores.dtype}")
                                            ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'shape'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 90, in search
    raise RAGError(f"Error in hybrid search: {str(e)}")
src.error_handler.RAGError: Error in hybrid search: 'str' object has no attribute 'shape'
2024-10-25 16:14:37,613 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[3] took 1.69 seconds
2024-10-25 16:14:37,616 - root - INFO - conftest.py:58 - timer - Test test_generate_answer took 0.00 seconds
2024-10-25 16:14:37,619 - root - INFO - rag.py:67 - rag_query - Processing query: Test question
2024-10-25 16:14:37,619 - root - INFO - conftest.py:58 - timer - Test test_rag_query took 0.00 seconds
2024-10-25 16:14:37,620 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[Short query] took 0.00 seconds
2024-10-25 16:14:37,621 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[A very long query that contains multiple sentences and specific terms] took 0.00 seconds
2024-10-25 16:14:37,622 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[] took 0.00 seconds
2024-10-25 16:14:37,623 - root - INFO - rag.py:67 - rag_query - Processing query: Test query
2024-10-25 16:14:37,624 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:14:37,625 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:14:37,625 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:14:37,941 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:14:37,943 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:14:38,243 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:14:38,244 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:14:39,123 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:14:39,233 - root - INFO - conftest.py:58 - timer - Test test_rag_query_performance took 1.61 seconds
2024-10-25 16:14:39,235 - root - INFO - rag.py:67 - rag_query - Processing query: Test query
2024-10-25 16:14:39,236 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:14:39,236 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:14:39,236 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:14:39,709 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:14:39,711 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:14:40,006 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:14:40,006 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:14:40,870 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:14:40,871 - root - ERROR - error_handler.py:17 - wrapper - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 71, in rag_query
    return openai_service.generate_answer(question, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
src.error_handler.RAGError: Test error
2024-10-25 16:14:40,889 - root - INFO - conftest.py:58 - timer - Test test_rag_error_handling took 1.66 seconds
2024-10-25 16:14:40,890 - root - ERROR - error_handler.py:17 - wrapper - Error in generate_answer: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 63, in generate_answer
    return openai_service.generate_answer(query, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
src.error_handler.RAGError: Test error
2024-10-25 16:14:40,896 - root - INFO - conftest.py:58 - timer - Test test_generate_answer_error_handling[RAGError-Test error] took 0.01 seconds
2024-10-25 16:14:40,898 - root - ERROR - error_handler.py:17 - wrapper - Error in generate_answer: Unexpected error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 63, in generate_answer
    return openai_service.generate_answer(query, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Unexpected error
2024-10-25 16:14:40,899 - root - INFO - conftest.py:58 - timer - Test test_generate_answer_error_handling[Exception-Unexpected error] took 0.00 seconds
2024-10-25 16:14:40,900 - root - INFO - rag.py:67 - rag_query - Processing query: Test question
2024-10-25 16:14:40,901 - root - ERROR - error_handler.py:17 - wrapper - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 68, in rag_query
    search = get_search_strategy(search_strategy, book_data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
src.error_handler.RAGError: Test error
2024-10-25 16:14:40,905 - root - INFO - conftest.py:58 - timer - Test test_rag_query_error_handling took 0.01 seconds
2024-10-25 16:14:53,928 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 16:14:53,929 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 16:14:53,936 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:14:53,936 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:14:53,944 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:14:54,264 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:14:54,265 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:14:54,542 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:14:54,543 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:14:55,070 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 16:14:55,085 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:14:55,086 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:14:55,086 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:14:55,394 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:14:55,396 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:14:56,199 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:14:56,199 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:14:56,206 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x10be42480>, 'json_data': {'input': ['journey'], 'model': 'text-embedding-3-small', 'encoding_format': 'base64'}}
2024-10-25 16:14:56,247 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-25 16:14:56,248 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-25 16:14:56,391 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10be753a0>
2024-10-25 16:14:56,392 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.started ssl_context=<ssl.SSLContext object at 0x10bd75cd0> server_hostname='api.openai.com' timeout=5.0
2024-10-25 16:14:56,437 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10be760c0>
2024-10-25 16:14:56,438 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-25 16:14:56,439 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-25 16:14:56,439 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-25 16:14:56,440 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-25 16:14:56,440 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-25 16:14:56,843 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 25 Oct 2024 15:14:56 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-3-small'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'119'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999999'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'0s'), (b'x-request-id', b'req_d3c5143f44e2fe1e5015a2dc0ad785c4'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=E0ms7ApJsPLpnmUZCYxsrB4F6ZwJyvItrvcttuFfDhE-1729869296-1.0.1.1-eUjTfP5suzt.P1HryfoWn7v0L2MWMwu98hoMDOEzeFvmfO3hON.OQ3OfwFQJfzWUi.3cGlmaw162mVBc_2peFQ; path=/; expires=Fri, 25-Oct-24 15:44:56 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=ieP9K6VrLb2nEaTLDH1tlaImGwoBkuNSxu5evUX1l2I-1729869296957-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d8328bfac1a94fb-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-25 16:14:56,846 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-25 16:14:56,847 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-25 16:14:56,848 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-25 16:14:56,848 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-25 16:14:56,848 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-25 16:14:56,848 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers([('date', 'Fri, 25 Oct 2024 15:14:56 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-allow-origin', '*'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-model', 'text-embedding-3-small'), ('openai-organization', 'uinside'), ('openai-processing-ms', '119'), ('openai-version', '2020-10-01'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '5000000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '4999999'), ('x-ratelimit-reset-requests', '6ms'), ('x-ratelimit-reset-tokens', '0s'), ('x-request-id', 'req_d3c5143f44e2fe1e5015a2dc0ad785c4'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=E0ms7ApJsPLpnmUZCYxsrB4F6ZwJyvItrvcttuFfDhE-1729869296-1.0.1.1-eUjTfP5suzt.P1HryfoWn7v0L2MWMwu98hoMDOEzeFvmfO3hON.OQ3OfwFQJfzWUi.3cGlmaw162mVBc_2peFQ; path=/; expires=Fri, 25-Oct-24 15:44:56 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=ieP9K6VrLb2nEaTLDH1tlaImGwoBkuNSxu5evUX1l2I-1729869296957-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d8328bfac1a94fb-LIS'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-25 16:14:56,849 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_d3c5143f44e2fe1e5015a2dc0ad785c4
2024-10-25 16:14:57,702 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:14:57,714 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 2.63 seconds
2024-10-25 16:14:59,393 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:14:59,393 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:14:59,393 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:14:59,883 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:14:59,884 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:15:00,211 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:15:00,212 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:15:00,215 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x10befd120>, 'json_data': {'input': ['journey journey journey journey journey journey journey journey journey journey journey journey journey journey journey journeying journeying journeying journeying journeying journeying journeying journeying journeying journeying journeying journeying journeying travel travel travel travel travel travel travel travel travel travel travel travel travel travel travel'], 'model': 'text-embedding-3-small', 'encoding_format': 'base64'}}
2024-10-25 16:15:00,217 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-25 16:15:00,217 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-25 16:15:00,218 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-25 16:15:00,218 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-25 16:15:00,219 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-25 16:15:00,219 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-25 16:15:00,676 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 25 Oct 2024 15:15:00 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-3-small'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'79'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999908'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'1ms'), (b'x-request-id', b'req_d8a85c210b87912c9cf094185b733820'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d8328d75dd194fb-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-25 16:15:00,677 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-25 16:15:00,677 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-25 16:15:00,678 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-25 16:15:00,678 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-25 16:15:00,679 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-25 16:15:00,679 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers({'date': 'Fri, 25 Oct 2024 15:15:00 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-allow-origin': '*', 'access-control-expose-headers': 'X-Request-ID', 'openai-model': 'text-embedding-3-small', 'openai-organization': 'uinside', 'openai-processing-ms': '79', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '5000000', 'x-ratelimit-remaining-requests': '9999', 'x-ratelimit-remaining-tokens': '4999908', 'x-ratelimit-reset-requests': '6ms', 'x-ratelimit-reset-tokens': '1ms', 'x-request-id': 'req_d8a85c210b87912c9cf094185b733820', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d8328d75dd194fb-LIS', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-25 16:15:00,679 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_d8a85c210b87912c9cf094185b733820
2024-10-25 16:15:01,602 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:15:01,604 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 116, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 16:15:01,607 - root - DEBUG - search.py:81 - search - BM25 scores shape: (4,), dtype: float64
2024-10-25 16:15:01,607 - root - ERROR - error_handler.py:17 - wrapper - Error in search: Error in hybrid search: 'str' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 82, in search
    logger.debug(f"Embedding scores shape: {embedding_scores.shape}, dtype: {embedding_scores.dtype}")
                                            ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'shape'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 90, in search
    raise RAGError(f"Error in hybrid search: {str(e)}")
src.error_handler.RAGError: Error in hybrid search: 'str' object has no attribute 'shape'
2024-10-25 16:15:01,714 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 4.00 seconds
2024-10-25 16:15:01,715 - root - ERROR - error_handler.py:17 - wrapper - Error in get_search_strategy: Unknown search strategy: unknown
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 161, in get_search_strategy
    raise ValueError(f"Unknown search strategy: {strategy}")
ValueError: Unknown search strategy: unknown
2024-10-25 16:15:01,716 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.00 seconds
2024-10-25 16:15:01,718 - root - ERROR - error_handler.py:17 - wrapper - Error in _create_weighted_query_embedding: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 139, in _create_weighted_query_embedding
    return create_embeddings([weighted_query])[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 16:15:01,720 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'str' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 116, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'shape'
2024-10-25 16:15:01,720 - root - DEBUG - search.py:81 - search - BM25 scores shape: (4,), dtype: float64
2024-10-25 16:15:01,720 - root - ERROR - error_handler.py:17 - wrapper - Error in search: Error in hybrid search: 'str' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 82, in search
    logger.debug(f"Embedding scores shape: {embedding_scores.shape}, dtype: {embedding_scores.dtype}")
                                            ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'shape'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 90, in search
    raise RAGError(f"Error in hybrid search: {str(e)}")
src.error_handler.RAGError: Error in hybrid search: 'str' object has no attribute 'shape'
2024-10-25 16:15:01,723 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.01 seconds
2024-10-25 16:15:01,724 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 16:15:01,725 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 16:15:01,726 - root - ERROR - error_handler.py:17 - wrapper - Error in search: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 50, in search
    query_embedding = create_embeddings([query])[0]
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 16:15:01,729 - root - INFO - conftest.py:58 - timer - Test test_simple_search_error_handling took 0.00 seconds
2024-10-25 16:15:01,730 - root - ERROR - error_handler.py:17 - wrapper - Error in _create_weighted_query_embedding: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 139, in _create_weighted_query_embedding
    return create_embeddings([weighted_query])[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 16:15:01,731 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'str' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 116, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'shape'
2024-10-25 16:15:01,731 - root - DEBUG - search.py:81 - search - BM25 scores shape: (4,), dtype: float64
2024-10-25 16:15:01,731 - root - ERROR - error_handler.py:17 - wrapper - Error in search: Error in hybrid search: 'str' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 82, in search
    logger.debug(f"Embedding scores shape: {embedding_scores.shape}, dtype: {embedding_scores.dtype}")
                                            ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'shape'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 90, in search
    raise RAGError(f"Error in hybrid search: {str(e)}")
src.error_handler.RAGError: Error in hybrid search: 'str' object has no attribute 'shape'
2024-10-25 16:15:01,733 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search_error_handling took 0.00 seconds
2024-10-25 16:25:54,348 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 16:25:54,348 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 16:25:54,355 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:25:54,355 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:25:54,363 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:25:54,849 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:25:54,851 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:25:55,321 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:25:55,321 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:25:55,614 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 16:25:57,297 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-25 16:25:57,312 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1389 chunks
2024-10-25 16:25:57,314 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:25:57,315 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:25:57,315 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:25:57,671 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:25:57,672 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:25:58,067 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:25:58,068 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:26:19,362 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"code":11,"message":"Error, message length too large: found 13124219 bytes, the limit is: 4194304 bytes","details":[]}'
2024-10-25 16:26:20,017 - root - INFO - conftest.py:58 - timer - Test test_main_cli_mode took 0.00 seconds
2024-10-25 16:26:20,018 - root - INFO - conftest.py:58 - timer - Test test_main_api_mode took 0.00 seconds
2024-10-25 16:26:20,019 - root - INFO - conftest.py:58 - timer - Test test_main_invalid_mode took 0.00 seconds
2024-10-25 16:26:20,020 - root - INFO - cli.py:25 - load_and_process_book - Starting to process book content
2024-10-25 16:26:20,020 - root - INFO - cli.py:28 - load_and_process_book - Text preprocessed. Number of chunks: 2
2024-10-25 16:26:20,020 - root - INFO - cli.py:38 - load_and_process_book - Book data created. Number of chunks: 2
2024-10-25 16:26:20,020 - root - INFO - conftest.py:58 - timer - Test test_load_and_process_book took 0.00 seconds
2024-10-25 16:26:20,024 - root - INFO - conftest.py:58 - timer - Test test_answer_question took 0.00 seconds
2024-10-25 16:26:20,025 - root - INFO - cli.py:53 - run_cli - Starting the RAG system
2024-10-25 16:26:20,025 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 16:26:20,026 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 16:26:20,033 - root - INFO - cli.py:64 - run_cli - Loading book from: input1
2024-10-25 16:26:20,033 - root - INFO - cli.py:66 - run_cli - Book loaded and preprocessed. Text split into 2 chunks
2024-10-25 16:26:20,033 - root - ERROR - cli.py:84 - run_cli - An error occurred: 
2024-10-25 16:26:20,033 - root - INFO - cli.py:87 - run_cli - Exiting the RAG system
2024-10-25 16:26:20,034 - root - INFO - conftest.py:58 - timer - Test test_run_cli[input1] took 0.01 seconds
2024-10-25 16:26:20,035 - root - INFO - cli.py:53 - run_cli - Starting the RAG system
2024-10-25 16:26:20,036 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 16:26:20,036 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 16:26:20,042 - root - INFO - cli.py:64 - run_cli - Loading book from: input2
2024-10-25 16:26:20,042 - root - INFO - cli.py:66 - run_cli - Book loaded and preprocessed. Text split into 2 chunks
2024-10-25 16:26:20,043 - root - ERROR - cli.py:84 - run_cli - An error occurred: 
2024-10-25 16:26:20,043 - root - INFO - cli.py:87 - run_cli - Exiting the RAG system
2024-10-25 16:26:20,044 - root - INFO - conftest.py:58 - timer - Test test_run_cli[input2] took 0.01 seconds
2024-10-25 16:26:20,045 - root - INFO - cli.py:53 - run_cli - Starting the RAG system
2024-10-25 16:26:20,045 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 16:26:20,046 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 16:26:20,053 - root - ERROR - cli.py:84 - run_cli - An error occurred: The file nonexistent_file.txt does not exist.
2024-10-25 16:26:20,053 - root - INFO - cli.py:87 - run_cli - Exiting the RAG system
2024-10-25 16:26:20,053 - root - INFO - conftest.py:58 - timer - Test test_run_cli_file_not_found took 0.01 seconds
2024-10-25 16:26:20,054 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:26:20,055 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:26:20,055 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:26:20,570 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:26:20,571 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:26:20,835 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:26:20,835 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:26:21,724 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":2}'
2024-10-25 16:26:21,725 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_length[chunks0-2] took 1.67 seconds
2024-10-25 16:26:21,726 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:26:21,726 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:26:21,726 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:26:22,004 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:26:22,006 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:26:22,240 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:26:22,240 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:26:22,923 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:26:22,924 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_length[chunks1-1] took 1.20 seconds
2024-10-25 16:26:22,926 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:26:22,926 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:26:22,926 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:26:23,247 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:26:23,249 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:26:23,511 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:26:23,511 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:26:23,514 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_length[chunks2-0] took 0.59 seconds
2024-10-25 16:26:23,536 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:26:23,536 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:26:23,537 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:26:23,837 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:26:23,838 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:26:24,137 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:26:24,138 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:26:24,814 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:26:24,817 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_structure took 1.30 seconds
2024-10-25 16:26:24,827 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:26:24,828 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:26:24,828 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:26:25,122 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:26:25,123 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:26:25,447 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:26:25,448 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:26:25,451 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_api_error took 0.63 seconds
2024-10-25 16:26:25,456 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:26:25,457 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:26:25,457 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:26:25,751 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:26:25,752 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:26:26,119 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:26:26,120 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:26:26,123 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_various_lengths[-1536] took 0.67 seconds
2024-10-25 16:26:26,128 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:26:26,128 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:26:26,128 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:26:26,419 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:26:26,421 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:26:26,684 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:26:26,685 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:26:26,689 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_various_lengths[Short text-1536] took 0.56 seconds
2024-10-25 16:26:26,694 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:26:26,695 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:26:26,695 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:26:26,976 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:26:26,977 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:26:27,472 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:26:27,473 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:26:27,477 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_various_lengths[AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA-1536] took 0.79 seconds
2024-10-25 16:26:27,485 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_with_cache took 0.01 seconds
2024-10-25 16:26:27,487 - root - INFO - file_processor.py:15 - process_file - Processing file: /Users/eduardizgorodin/Projects/rag_book_assistant/tests/data/test.pdf with extension: .pdf
2024-10-25 16:26:27,488 - root - INFO - file_processor.py:26 - process_file - Using processor for extension: .pdf
2024-10-25 16:26:27,491 - root - INFO - conftest.py:58 - timer - Test test_process_pdf took 0.00 seconds
2024-10-25 16:26:27,492 - root - INFO - file_processor.py:15 - process_file - Processing file: /Users/eduardizgorodin/Projects/rag_book_assistant/tests/data/test.docx with extension: .docx
2024-10-25 16:26:27,493 - root - INFO - file_processor.py:26 - process_file - Using processor for extension: .docx
2024-10-25 16:26:27,510 - root - INFO - conftest.py:58 - timer - Test test_process_docx took 0.02 seconds
2024-10-25 16:26:27,511 - root - INFO - file_processor.py:15 - process_file - Processing file: /Users/eduardizgorodin/Projects/rag_book_assistant/tests/data/test.odt with extension: .odt
2024-10-25 16:26:27,511 - root - INFO - file_processor.py:26 - process_file - Using processor for extension: .odt
2024-10-25 16:26:27,517 - root - INFO - conftest.py:58 - timer - Test test_process_odt took 0.01 seconds
2024-10-25 16:26:27,518 - root - INFO - file_processor.py:15 - process_file - Processing file: /Users/eduardizgorodin/Projects/rag_book_assistant/tests/data/test.txt with extension: .txt
2024-10-25 16:26:27,518 - root - INFO - file_processor.py:26 - process_file - Using processor for extension: .txt
2024-10-25 16:26:27,519 - root - INFO - conftest.py:58 - timer - Test test_process_txt took 0.00 seconds
2024-10-25 16:26:27,521 - root - INFO - file_processor.py:15 - process_file - Processing file: /private/var/folders/dd/70xsqyd921gd18src4pk119r0000gn/T/pytest-of-eduardizgorodin/pytest-12/test_unsupported_file_format0/test.unsupported with extension: .unsupported
2024-10-25 16:26:27,522 - root - ERROR - file_processor.py:29 - process_file - Unsupported file format: .unsupported
2024-10-25 16:26:27,522 - root - INFO - conftest.py:58 - timer - Test test_unsupported_file_format took 0.00 seconds
2024-10-25 16:26:27,523 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-25 16:26:27,527 - root - INFO - text_processing.py:103 - split_into_chunks - Created 199 chunks
2024-10-25 16:26:27,527 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:26:27,528 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:26:27,528 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:26:27,826 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:26:27,828 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:26:28,277 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:26:28,277 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:26:28,323 - root - INFO - rag.py:67 - rag_query - Processing query: What was the model year of the Ford Pinto involved in the accident?
2024-10-25 16:26:28,323 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:26:28,323 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:26:28,323 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:26:28,616 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:26:28,617 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:26:29,043 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:26:29,043 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:26:29,896 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:26:29,945 - rag_results - INFO - test_ford_pinto_qa.py:94 - test_qa_system - 
Q: What was the model year of the Ford Pinto involved in the accident?
2024-10-25 16:26:29,945 - rag_results - INFO - test_ford_pinto_qa.py:95 - test_qa_system - Expected A: 1972
2024-10-25 16:26:29,946 - rag_results - INFO - test_ford_pinto_qa.py:96 - test_qa_system - System A: This is a mock answer
2024-10-25 16:26:29,946 - rag_results - INFO - test_ford_pinto_qa.py:97 - test_qa_system - Is correct: False
2024-10-25 16:26:29,946 - rag_results - INFO - test_ford_pinto_qa.py:98 - test_qa_system - --------------------------------------------------
2024-10-25 16:26:29,948 - root - INFO - conftest.py:58 - timer - Test test_qa_system[qa_pair0] took 1.63 seconds
2024-10-25 16:26:29,957 - root - INFO - conftest.py:58 - timer - Test test_imports took 0.01 seconds
2024-10-25 16:26:29,957 - root - INFO - conftest.py:58 - timer - Test test_config_import took 0.00 seconds
2024-10-25 16:26:29,958 - root - INFO - conftest.py:58 - timer - Test test_openai_api_key took 0.00 seconds
2024-10-25 16:26:29,959 - root - INFO - text_processing.py:75 - load_and_preprocess_text - Preprocessing text content
2024-10-25 16:26:30,285 - root - INFO - text_processing.py:81 - load_and_preprocess_text - Extracted 0 dates, 0 named entities, and 1 key phrases from the text
2024-10-25 16:26:30,285 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-25 16:26:30,285 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1 chunks
2024-10-25 16:26:30,285 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 1000, overlap: 100)
2024-10-25 16:26:30,285 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1 chunks
2024-10-25 16:26:30,286 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:26:30,286 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:26:30,286 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:26:30,580 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:26:30,580 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:26:30,887 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:26:30,887 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:26:31,763 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:26:31,767 - root - INFO - conftest.py:58 - timer - Test test_different_book_types[True-test_book.txt] took 1.81 seconds
2024-10-25 16:26:31,769 - root - INFO - text_processing.py:75 - load_and_preprocess_text - Preprocessing text content
2024-10-25 16:26:31,954 - root - INFO - text_processing.py:81 - load_and_preprocess_text - Extracted 0 dates, 0 named entities, and 1 key phrases from the text
2024-10-25 16:26:31,954 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-25 16:26:31,954 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1 chunks
2024-10-25 16:26:31,954 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 1000, overlap: 100)
2024-10-25 16:26:31,954 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1 chunks
2024-10-25 16:26:31,955 - root - INFO - conftest.py:58 - timer - Test test_different_book_types[False-test_book.txt] took 0.19 seconds
2024-10-25 16:26:31,956 - root - INFO - conftest.py:58 - timer - Test test_rag_query[True] took 0.00 seconds
2024-10-25 16:26:31,957 - root - INFO - conftest.py:58 - timer - Test test_rag_query[False] took 0.00 seconds
2024-10-25 16:26:32,252 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 16:26:33,531 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:26:34,003 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 16:26:36,447 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:26:36,587 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 16:26:36,656 - root - INFO - conftest.py:58 - timer - Test test_pinecone_integration took 4.70 seconds
2024-10-25 16:26:36,657 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 16:26:36,658 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 16:26:36,666 - root - INFO - openai_service.py:40 - generate_answer - Generating answer for query: Test query
2024-10-25 16:26:36,666 - root - INFO - conftest.py:58 - timer - Test test_generate_answer took 0.01 seconds
2024-10-25 16:26:36,667 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 16:26:36,667 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 16:26:36,675 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings took 0.01 seconds
2024-10-25 16:26:36,676 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 16:26:36,676 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 16:26:36,684 - root - INFO - conftest.py:58 - timer - Test test_handle_openai_error[RateLimitError-Rate limit exceeded] took 0.01 seconds
2024-10-25 16:26:36,684 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 16:26:36,685 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 16:26:36,692 - root - INFO - conftest.py:58 - timer - Test test_handle_openai_error[APIError-API error] took 0.01 seconds
2024-10-25 16:26:36,693 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 16:26:36,693 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 16:26:36,699 - root - INFO - conftest.py:58 - timer - Test test_handle_openai_error[APITimeoutError-Request timed out] took 0.01 seconds
2024-10-25 16:26:36,700 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 16:26:36,700 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 16:26:36,710 - root - INFO - conftest.py:58 - timer - Test test_handle_openai_error[APIConnectionError-Connection error] took 0.01 seconds
2024-10-25 16:26:36,711 - root - INFO - conftest.py:58 - timer - Test test_create_test_exception took 0.00 seconds
2024-10-25 16:26:37,191 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 16:26:37,626 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 16:26:38,837 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 16:26:41,232 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 16:26:41,714 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 16:26:44,906 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 16:26:48,340 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 16:26:48,680 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 16:26:48,738 - root - INFO - conftest.py:58 - timer - Test test_pinecone_manager_initialization took 12.03 seconds
2024-10-25 16:26:49,122 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 16:26:50,281 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 16:26:50,714 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 16:26:52,993 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 16:26:56,140 - root - INFO - pinecone_manager.py:80 - _initialize - Index test-index already exists. Using existing index.
2024-10-25 16:26:56,478 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 16:26:59,691 - root - INFO - pinecone_manager.py:80 - _initialize - Index test-index already exists. Using existing index.
2024-10-25 16:26:59,919 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 16:26:59,976 - root - INFO - conftest.py:58 - timer - Test test_upsert_and_search[chunks0-embeddings0] took 11.24 seconds
2024-10-25 16:27:00,324 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 16:27:00,740 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 16:27:02,061 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 16:27:04,436 - root - INFO - pinecone_manager.py:80 - _initialize - Index test-index already exists. Using existing index.
2024-10-25 16:27:04,600 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 16:27:07,767 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 16:27:11,229 - root - INFO - pinecone_manager.py:80 - _initialize - Index test-index already exists. Using existing index.
2024-10-25 16:27:11,355 - root - INFO - pinecone_manager.py:83 - _initialize - Successfully initialized Pinecone index: test-index
2024-10-25 16:27:11,357 - root - INFO - conftest.py:58 - timer - Test test_upsert_and_search[chunks1-embeddings1] took 11.38 seconds
2024-10-25 16:27:11,643 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 16:27:12,508 - root - INFO - pinecone_manager.py:83 - _initialize - Successfully initialized Pinecone index: test-index
2024-10-25 16:27:12,509 - root - INFO - conftest.py:58 - timer - Test test_upsert_and_search[chunks2-embeddings2] took 1.15 seconds
2024-10-25 16:27:12,928 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 16:27:13,321 - root - INFO - pinecone_manager.py:83 - _initialize - Successfully initialized Pinecone index: test-index
2024-10-25 16:27:13,327 - root - INFO - conftest.py:58 - timer - Test test_get_or_create_embeddings took 0.82 seconds
2024-10-25 16:27:13,654 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 16:27:14,325 - root - INFO - pinecone_manager.py:83 - _initialize - Successfully initialized Pinecone index: test-index
2024-10-25 16:27:14,328 - root - INFO - conftest.py:58 - timer - Test test_clear_index took 1.00 seconds
2024-10-25 16:27:14,720 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 16:27:15,472 - root - INFO - pinecone_manager.py:83 - _initialize - Successfully initialized Pinecone index: test-index
2024-10-25 16:27:15,491 - root - WARNING - pinecone_manager.py:127 - clear_index - Pinecone index is not available. Skipping clear operation.
2024-10-25 16:27:15,492 - root - INFO - conftest.py:58 - timer - Test test_error_handling took 1.16 seconds
2024-10-25 16:27:15,885 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 16:27:16,114 - root - INFO - pinecone_manager.py:83 - _initialize - Successfully initialized Pinecone index: test-index
2024-10-25 16:27:16,117 - root - INFO - conftest.py:58 - timer - Test test_batch_operation[1] took 0.63 seconds
2024-10-25 16:27:16,591 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 16:27:17,922 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 16:27:18,322 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 16:27:20,542 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 16:27:24,019 - root - INFO - pinecone_manager.py:80 - _initialize - Index test-index already exists. Using existing index.
2024-10-25 16:27:24,290 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 16:27:27,786 - root - INFO - pinecone_manager.py:80 - _initialize - Index test-index already exists. Using existing index.
2024-10-25 16:27:28,008 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 16:27:28,046 - root - INFO - conftest.py:58 - timer - Test test_batch_operation[10] took 11.93 seconds
2024-10-25 16:27:28,171 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 16:27:29,550 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 16:27:32,011 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 16:27:32,702 - root - INFO - pinecone_manager.py:83 - _initialize - Successfully initialized Pinecone index: test-index
2024-10-25 16:27:32,705 - root - INFO - conftest.py:58 - timer - Test test_batch_operation[100] took 4.66 seconds
2024-10-25 16:27:34,226 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:27:34,227 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:27:34,227 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:27:34,570 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:27:34,572 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:27:34,876 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:27:34,877 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:27:35,786 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:27:35,792 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 116, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 16:27:35,794 - root - DEBUG - search.py:81 - search - BM25 scores shape: (3,), dtype: float64
2024-10-25 16:27:35,794 - root - ERROR - error_handler.py:17 - wrapper - Error in search: Error in hybrid search: 'str' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 82, in search
    logger.debug(f"Embedding scores shape: {embedding_scores.shape}, dtype: {embedding_scores.dtype}")
                                            ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'shape'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 90, in search
    raise RAGError(f"Error in hybrid search: {str(e)}")
src.error_handler.RAGError: Error in hybrid search: 'str' object has no attribute 'shape'
2024-10-25 16:27:35,800 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[1] took 3.09 seconds
2024-10-25 16:27:35,804 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:27:35,805 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:27:35,805 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:27:36,131 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:27:36,132 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:27:36,392 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:27:36,393 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:27:37,302 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:27:37,311 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 116, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 16:27:37,313 - root - DEBUG - search.py:81 - search - BM25 scores shape: (3,), dtype: float64
2024-10-25 16:27:37,313 - root - ERROR - error_handler.py:17 - wrapper - Error in search: Error in hybrid search: 'str' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 82, in search
    logger.debug(f"Embedding scores shape: {embedding_scores.shape}, dtype: {embedding_scores.dtype}")
                                            ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'shape'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 90, in search
    raise RAGError(f"Error in hybrid search: {str(e)}")
src.error_handler.RAGError: Error in hybrid search: 'str' object has no attribute 'shape'
2024-10-25 16:27:37,320 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[2] took 1.52 seconds
2024-10-25 16:27:37,325 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:27:37,325 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:27:37,325 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:27:37,674 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:27:37,675 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:27:37,939 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:27:37,940 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:27:38,796 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:27:38,798 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 116, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 16:27:38,799 - root - DEBUG - search.py:81 - search - BM25 scores shape: (3,), dtype: float64
2024-10-25 16:27:38,799 - root - ERROR - error_handler.py:17 - wrapper - Error in search: Error in hybrid search: 'str' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 82, in search
    logger.debug(f"Embedding scores shape: {embedding_scores.shape}, dtype: {embedding_scores.dtype}")
                                            ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'shape'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 90, in search
    raise RAGError(f"Error in hybrid search: {str(e)}")
src.error_handler.RAGError: Error in hybrid search: 'str' object has no attribute 'shape'
2024-10-25 16:27:38,802 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[3] took 1.48 seconds
2024-10-25 16:27:38,803 - root - INFO - conftest.py:58 - timer - Test test_generate_answer took 0.00 seconds
2024-10-25 16:27:38,804 - root - INFO - rag.py:67 - rag_query - Processing query: Test question
2024-10-25 16:27:38,805 - root - INFO - conftest.py:58 - timer - Test test_rag_query took 0.00 seconds
2024-10-25 16:27:38,805 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[Short query] took 0.00 seconds
2024-10-25 16:27:38,806 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[A very long query that contains multiple sentences and specific terms] took 0.00 seconds
2024-10-25 16:27:38,806 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[] took 0.00 seconds
2024-10-25 16:27:38,807 - root - INFO - rag.py:67 - rag_query - Processing query: Test query
2024-10-25 16:27:38,807 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:27:38,807 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:27:38,807 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:27:39,132 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:27:39,133 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:27:39,420 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:27:39,420 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:27:40,221 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:27:40,299 - root - INFO - conftest.py:58 - timer - Test test_rag_query_performance took 1.49 seconds
2024-10-25 16:27:40,301 - root - INFO - rag.py:67 - rag_query - Processing query: Test query
2024-10-25 16:27:40,302 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:27:40,302 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:27:40,302 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:27:40,583 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:27:40,584 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:27:40,842 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:27:40,842 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:27:41,683 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:27:41,684 - root - ERROR - error_handler.py:17 - wrapper - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 71, in rag_query
    return openai_service.generate_answer(question, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
src.error_handler.RAGError: Test error
2024-10-25 16:27:41,696 - root - INFO - conftest.py:58 - timer - Test test_rag_error_handling took 1.40 seconds
2024-10-25 16:27:41,699 - root - ERROR - error_handler.py:17 - wrapper - Error in generate_answer: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 63, in generate_answer
    return openai_service.generate_answer(query, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
src.error_handler.RAGError: Test error
2024-10-25 16:27:41,704 - root - INFO - conftest.py:58 - timer - Test test_generate_answer_error_handling[RAGError-Test error] took 0.01 seconds
2024-10-25 16:27:41,706 - root - ERROR - error_handler.py:17 - wrapper - Error in generate_answer: Unexpected error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 63, in generate_answer
    return openai_service.generate_answer(query, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Unexpected error
2024-10-25 16:27:41,707 - root - INFO - conftest.py:58 - timer - Test test_generate_answer_error_handling[Exception-Unexpected error] took 0.00 seconds
2024-10-25 16:27:41,708 - root - INFO - rag.py:67 - rag_query - Processing query: Test question
2024-10-25 16:27:41,708 - root - ERROR - error_handler.py:17 - wrapper - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 68, in rag_query
    search = get_search_strategy(search_strategy, book_data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
src.error_handler.RAGError: Test error
2024-10-25 16:27:41,718 - root - INFO - conftest.py:58 - timer - Test test_rag_query_error_handling took 0.01 seconds
2024-10-25 16:27:41,720 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:27:41,720 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:27:41,720 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:27:42,014 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:27:42,016 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:27:42,310 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:27:42,310 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:27:43,154 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:27:43,156 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 1.44 seconds
2024-10-25 16:27:43,161 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:27:43,161 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:27:43,161 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:27:43,457 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:27:43,459 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:27:43,728 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:27:43,729 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:27:44,588 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:27:44,589 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 116, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 16:27:44,590 - root - DEBUG - search.py:81 - search - BM25 scores shape: (4,), dtype: float64
2024-10-25 16:27:44,590 - root - ERROR - error_handler.py:17 - wrapper - Error in search: Error in hybrid search: 'str' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 82, in search
    logger.debug(f"Embedding scores shape: {embedding_scores.shape}, dtype: {embedding_scores.dtype}")
                                            ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'shape'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 90, in search
    raise RAGError(f"Error in hybrid search: {str(e)}")
src.error_handler.RAGError: Error in hybrid search: 'str' object has no attribute 'shape'
2024-10-25 16:27:44,597 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.44 seconds
2024-10-25 16:27:44,599 - root - ERROR - error_handler.py:17 - wrapper - Error in get_search_strategy: Unknown search strategy: unknown
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 161, in get_search_strategy
    raise ValueError(f"Unknown search strategy: {strategy}")
ValueError: Unknown search strategy: unknown
2024-10-25 16:27:44,605 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.01 seconds
2024-10-25 16:27:44,608 - root - ERROR - error_handler.py:17 - wrapper - Error in _create_weighted_query_embedding: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 139, in _create_weighted_query_embedding
    return create_embeddings([weighted_query])[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 16:27:44,609 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'str' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 116, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'shape'
2024-10-25 16:27:44,609 - root - DEBUG - search.py:81 - search - BM25 scores shape: (4,), dtype: float64
2024-10-25 16:27:44,609 - root - ERROR - error_handler.py:17 - wrapper - Error in search: Error in hybrid search: 'str' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 82, in search
    logger.debug(f"Embedding scores shape: {embedding_scores.shape}, dtype: {embedding_scores.dtype}")
                                            ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'shape'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 90, in search
    raise RAGError(f"Error in hybrid search: {str(e)}")
src.error_handler.RAGError: Error in hybrid search: 'str' object has no attribute 'shape'
2024-10-25 16:27:44,615 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.01 seconds
2024-10-25 16:27:44,618 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 16:27:44,619 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 16:27:44,621 - root - ERROR - error_handler.py:17 - wrapper - Error in search: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 50, in search
    query_embedding = create_embeddings([query])[0]
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 16:27:44,625 - root - INFO - conftest.py:58 - timer - Test test_simple_search_error_handling took 0.00 seconds
2024-10-25 16:27:44,627 - root - ERROR - error_handler.py:17 - wrapper - Error in _create_weighted_query_embedding: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 139, in _create_weighted_query_embedding
    return create_embeddings([weighted_query])[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 16:27:44,627 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'str' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 116, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'shape'
2024-10-25 16:27:44,628 - root - DEBUG - search.py:81 - search - BM25 scores shape: (4,), dtype: float64
2024-10-25 16:27:44,628 - root - ERROR - error_handler.py:17 - wrapper - Error in search: Error in hybrid search: 'str' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 82, in search
    logger.debug(f"Embedding scores shape: {embedding_scores.shape}, dtype: {embedding_scores.dtype}")
                                            ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'shape'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 90, in search
    raise RAGError(f"Error in hybrid search: {str(e)}")
src.error_handler.RAGError: Error in hybrid search: 'str' object has no attribute 'shape'
2024-10-25 16:27:44,631 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search_error_handling took 0.01 seconds
2024-10-25 16:27:44,632 - root - INFO - text_processing.py:75 - load_and_preprocess_text - Preprocessing text content
2024-10-25 16:27:44,797 - root - INFO - text_processing.py:81 - load_and_preprocess_text - Extracted 0 dates, 0 named entities, and 5 key phrases from the text
2024-10-25 16:27:44,797 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-25 16:27:44,797 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1 chunks
2024-10-25 16:27:44,797 - root - INFO - conftest.py:58 - timer - Test test_load_and_preprocess_text took 0.17 seconds
2024-10-25 16:27:44,798 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 100, overlap: 20)
2024-10-25 16:27:44,798 - root - INFO - text_processing.py:103 - split_into_chunks - Created 13 chunks
2024-10-25 16:27:44,798 - root - INFO - conftest.py:58 - timer - Test test_split_into_chunks[100-20] took 0.00 seconds
2024-10-25 16:27:44,798 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 200, overlap: 50)
2024-10-25 16:27:44,799 - root - INFO - text_processing.py:103 - split_into_chunks - Created 7 chunks
2024-10-25 16:27:44,799 - root - INFO - conftest.py:58 - timer - Test test_split_into_chunks[200-50] took 0.00 seconds
2024-10-25 16:27:44,799 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 500, overlap: 100)
2024-10-25 16:27:44,799 - root - INFO - text_processing.py:103 - split_into_chunks - Created 3 chunks
2024-10-25 16:27:44,799 - root - INFO - conftest.py:58 - timer - Test test_split_into_chunks[500-100] took 0.00 seconds
2024-10-25 16:27:44,800 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 100, overlap: 20)
2024-10-25 16:27:44,800 - root - INFO - text_processing.py:103 - split_into_chunks - Created 13 chunks
2024-10-25 16:27:44,800 - root - INFO - conftest.py:58 - timer - Test test_split_into_chunks_with_dict_input took 0.00 seconds
2024-10-25 16:27:46,960 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 16:27:46,961 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 16:27:46,967 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:27:46,967 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:27:46,975 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:27:47,246 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:27:47,248 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:27:47,517 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:27:47,518 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:27:47,714 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 16:27:47,725 - root - INFO - cli.py:53 - run_cli - Starting the RAG system
2024-10-25 16:27:47,726 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 16:27:47,727 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 16:27:56,790 - root - INFO - cli.py:64 - run_cli - Loading book from: tests/data/test.pdf
2024-10-25 16:27:56,791 - root - INFO - cli.py:25 - load_and_process_book - Starting to process book content
2024-10-25 16:27:56,791 - root - INFO - text_processing.py:75 - load_and_preprocess_text - Preprocessing text content
2024-10-25 16:27:57,074 - root - INFO - text_processing.py:81 - load_and_preprocess_text - Extracted 0 dates, 0 named entities, and 1 key phrases from the text
2024-10-25 16:27:57,074 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-25 16:27:57,074 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1 chunks
2024-10-25 16:27:57,074 - root - INFO - cli.py:28 - load_and_process_book - Text preprocessed. Number of chunks: 1
2024-10-25 16:27:57,074 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:27:57,074 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:27:57,075 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:27:57,431 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:27:57,431 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:27:57,743 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:27:57,744 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:27:58,568 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:27:58,733 - root - ERROR - cli.py:84 - run_cli - An error occurred: 'BookDataInterface' object has no attribute 'chunks'
2024-10-25 16:27:58,733 - root - INFO - cli.py:87 - run_cli - Exiting the RAG system
2024-10-25 17:14:55,176 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 17:14:55,177 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 17:14:55,184 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 17:14:55,184 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 17:14:55,192 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 17:14:55,744 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 17:14:55,747 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 17:14:56,069 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 17:14:56,069 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 17:14:56,483 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 17:14:56,502 - root - INFO - cli.py:53 - run_cli - Starting the RAG system
2024-10-25 17:14:56,503 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 17:14:56,503 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 17:15:35,907 - root - INFO - cli.py:64 - run_cli - Loading book from: tests/data/ford.txt
2024-10-25 17:15:35,909 - root - INFO - cli.py:25 - load_and_process_book - Starting to process book content
2024-10-25 17:15:35,909 - root - INFO - text_processing.py:75 - load_and_preprocess_text - Preprocessing text content
2024-10-25 17:15:36,207 - root - INFO - text_processing.py:81 - load_and_preprocess_text - Extracted 0 dates, 0 named entities, and 1 key phrases from the text
2024-10-25 17:15:36,207 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-25 17:15:36,207 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1 chunks
2024-10-25 17:15:36,207 - root - INFO - cli.py:28 - load_and_process_book - Text preprocessed. Number of chunks: 1
2024-10-25 17:15:36,207 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 17:15:36,208 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 17:15:36,208 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 17:15:36,607 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 17:15:36,607 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 17:15:37,041 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 17:15:37,041 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 17:15:37,985 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 17:15:38,172 - root - ERROR - cli.py:84 - run_cli - An error occurred: 'BookDataInterface' object has no attribute 'chunks'
2024-10-25 17:15:38,172 - root - INFO - cli.py:87 - run_cli - Exiting the RAG system
2024-10-25 17:23:01,873 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 17:23:01,874 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 17:23:01,881 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 17:23:01,881 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 17:23:01,889 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 17:23:03,519 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 17:23:03,521 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 17:23:03,909 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 17:23:03,909 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 17:23:05,065 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 17:23:05,071 - root - INFO - cli.py:53 - run_cli - Starting the RAG system
2024-10-25 17:23:05,072 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 17:23:05,073 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 17:23:16,335 - root - INFO - cli.py:64 - run_cli - Loading book from: tests/data/ford.txt
2024-10-25 17:23:16,336 - root - INFO - cli.py:25 - load_and_process_book - Starting to process book content
2024-10-25 17:23:16,336 - root - INFO - text_processing.py:75 - load_and_preprocess_text - Preprocessing text content
2024-10-25 17:23:16,622 - root - INFO - text_processing.py:81 - load_and_preprocess_text - Extracted 0 dates, 0 named entities, and 1 key phrases from the text
2024-10-25 17:23:16,622 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-25 17:23:16,622 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1 chunks
2024-10-25 17:23:16,622 - root - INFO - cli.py:28 - load_and_process_book - Text preprocessed. Number of chunks: 1
2024-10-25 17:23:16,622 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 17:23:16,622 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 17:23:16,623 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 17:23:16,935 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 17:23:16,937 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 17:23:17,896 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 17:23:17,897 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 17:23:18,878 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 17:23:19,069 - root - INFO - embedding.py:51 - save_chunks_and_embeddings - Saving 1 chunks, their embeddings, and processed text to data/embeddings/65d642d83b720a1e924d3ebef3a845fe_chunks_embeddings.pkl.
2024-10-25 17:23:19,069 - root - INFO - embedding.py:54 - save_chunks_and_embeddings - Data saved to data/embeddings/65d642d83b720a1e924d3ebef3a845fe_chunks_embeddings.pkl.
2024-10-25 17:23:19,069 - root - ERROR - cli.py:84 - run_cli - An error occurred: 'BookDataInterface' object has no attribute 'chunks'
2024-10-25 17:23:19,069 - root - INFO - cli.py:87 - run_cli - Exiting the RAG system
2024-10-25 17:23:36,731 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 17:23:36,732 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 17:23:36,738 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 17:23:36,738 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 17:23:36,745 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 17:23:37,534 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 17:23:37,535 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 17:23:38,490 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 17:23:38,490 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 17:23:39,160 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 17:23:39,166 - root - INFO - cli.py:53 - run_cli - Starting the RAG system
2024-10-25 17:23:39,166 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 17:23:39,167 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 17:23:41,773 - root - INFO - cli.py:64 - run_cli - Loading book from: tests/data/ford.txt
2024-10-25 17:23:41,774 - root - INFO - cli.py:25 - load_and_process_book - Starting to process book content
2024-10-25 17:23:41,774 - root - INFO - text_processing.py:75 - load_and_preprocess_text - Preprocessing text content
2024-10-25 17:23:42,059 - root - INFO - text_processing.py:81 - load_and_preprocess_text - Extracted 0 dates, 0 named entities, and 1 key phrases from the text
2024-10-25 17:23:42,059 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-25 17:23:42,059 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1 chunks
2024-10-25 17:23:42,059 - root - INFO - cli.py:28 - load_and_process_book - Text preprocessed. Number of chunks: 1
2024-10-25 17:23:42,059 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 17:23:42,059 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 17:23:42,059 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 17:23:43,167 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 17:23:43,169 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 17:23:45,064 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 17:23:45,065 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 17:23:45,879 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 17:23:46,069 - root - INFO - embedding.py:51 - save_chunks_and_embeddings - Saving 1 chunks, their embeddings, and processed text to data/embeddings/65d642d83b720a1e924d3ebef3a845fe_chunks_embeddings.pkl.
2024-10-25 17:23:46,070 - root - INFO - embedding.py:54 - save_chunks_and_embeddings - Data saved to data/embeddings/65d642d83b720a1e924d3ebef3a845fe_chunks_embeddings.pkl.
2024-10-25 17:23:46,070 - root - ERROR - cli.py:84 - run_cli - An error occurred: 'BookDataInterface' object has no attribute 'chunks'
2024-10-25 17:23:46,071 - root - INFO - cli.py:87 - run_cli - Exiting the RAG system
2024-10-25 17:29:31,367 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 17:29:31,369 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 17:29:31,375 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 17:29:31,375 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 17:29:31,383 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 17:29:32,920 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 17:29:32,922 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 17:29:34,478 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 17:29:34,479 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 17:29:35,650 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 17:29:35,656 - root - INFO - cli.py:53 - run_cli - Starting the RAG system
2024-10-25 17:29:35,657 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 17:29:35,658 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 17:29:38,712 - root - INFO - cli.py:64 - run_cli - Loading book from: tests/data/ford.txt
2024-10-25 17:29:38,712 - root - INFO - cli.py:25 - load_and_process_book - Starting to process book content
2024-10-25 17:29:38,712 - root - INFO - text_processing.py:75 - load_and_preprocess_text - Preprocessing text content
2024-10-25 17:29:39,006 - root - INFO - text_processing.py:81 - load_and_preprocess_text - Extracted 0 dates, 0 named entities, and 1 key phrases from the text
2024-10-25 17:29:39,006 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-25 17:29:39,006 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1 chunks
2024-10-25 17:29:39,006 - root - INFO - cli.py:28 - load_and_process_book - Text preprocessed. Number of chunks: 1
2024-10-25 17:29:39,006 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 17:29:39,007 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 17:29:39,007 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 17:29:40,582 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 17:29:40,583 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 17:29:43,004 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 17:29:43,004 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 17:29:43,930 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 17:29:44,122 - root - INFO - embedding.py:51 - save_chunks_and_embeddings - Saving 1 chunks, their embeddings, and processed text to data/embeddings/65d642d83b720a1e924d3ebef3a845fe_chunks_embeddings.pkl.
2024-10-25 17:29:44,123 - root - INFO - embedding.py:54 - save_chunks_and_embeddings - Data saved to data/embeddings/65d642d83b720a1e924d3ebef3a845fe_chunks_embeddings.pkl.
2024-10-25 17:29:44,123 - root - ERROR - cli.py:84 - run_cli - An error occurred: 'BookDataInterface' object has no attribute 'chunks'
2024-10-25 17:29:44,123 - root - INFO - cli.py:87 - run_cli - Exiting the RAG system
2024-10-25 17:38:13,417 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 17:38:13,418 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 17:38:13,425 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 17:38:13,425 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 17:38:13,433 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 17:38:13,846 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 17:38:13,847 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 17:38:14,127 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 17:38:14,127 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 17:38:14,334 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 17:38:14,344 - root - INFO - cli.py:53 - run_cli - Starting the RAG system
2024-10-25 17:38:14,345 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 17:38:14,346 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 17:38:23,510 - root - INFO - cli.py:64 - run_cli - Loading book from: tests/data/ford.txt
2024-10-25 17:38:23,512 - root - INFO - cli.py:25 - load_and_process_book - Starting to process book content
2024-10-25 17:38:23,512 - root - INFO - text_processing.py:75 - load_and_preprocess_text - Preprocessing text content
2024-10-25 17:38:23,805 - root - INFO - text_processing.py:81 - load_and_preprocess_text - Extracted 0 dates, 0 named entities, and 1 key phrases from the text
2024-10-25 17:38:23,805 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-25 17:38:23,805 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1 chunks
2024-10-25 17:38:23,805 - root - INFO - cli.py:28 - load_and_process_book - Text preprocessed. Number of chunks: 1
2024-10-25 17:38:23,805 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 17:38:23,805 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 17:38:23,805 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 17:38:24,117 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 17:38:24,118 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 17:38:24,389 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 17:38:24,389 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 17:38:25,311 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 17:38:25,465 - root - INFO - embedding.py:51 - save_chunks_and_embeddings - Saving 1 chunks, their embeddings, and processed text to data/embeddings/65d642d83b720a1e924d3ebef3a845fe_chunks_embeddings.pkl.
2024-10-25 17:38:25,466 - root - INFO - embedding.py:54 - save_chunks_and_embeddings - Data saved to data/embeddings/65d642d83b720a1e924d3ebef3a845fe_chunks_embeddings.pkl.
2024-10-25 17:38:25,466 - root - ERROR - cli.py:84 - run_cli - An error occurred: 'BookDataInterface' object has no attribute 'chunks'
2024-10-25 17:38:25,466 - root - INFO - cli.py:87 - run_cli - Exiting the RAG system
2024-10-25 17:47:39,533 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 17:47:39,534 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 17:47:39,540 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 17:47:39,541 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 17:47:39,549 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 17:47:39,987 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 17:47:39,988 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 17:47:40,389 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 17:47:40,389 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 17:47:40,602 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 17:47:40,613 - root - INFO - cli.py:54 - run_cli - Starting the RAG system
2024-10-25 17:47:40,614 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 17:47:40,615 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 17:48:02,359 - root - INFO - cli.py:65 - run_cli - Loading book from: tests/data/ford.txt
2024-10-25 17:48:02,360 - root - INFO - cli.py:24 - load_and_process_book - Starting to process book content
2024-10-25 17:48:02,360 - root - INFO - text_processing.py:75 - load_and_preprocess_text - Preprocessing text content
2024-10-25 17:48:02,665 - root - INFO - text_processing.py:81 - load_and_preprocess_text - Extracted 0 dates, 0 named entities, and 1 key phrases from the text
2024-10-25 17:48:02,665 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-25 17:48:02,665 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1 chunks
2024-10-25 17:48:02,665 - root - INFO - cli.py:27 - load_and_process_book - Text preprocessed. Number of chunks: 1
2024-10-25 17:48:02,665 - root - INFO - embedding.py:65 - get_or_create_chunks_and_embeddings - Loading existing chunks and embeddings from data/embeddings/65d642d83b720a1e924d3ebef3a845fe_chunks_embeddings.pkl
2024-10-25 17:48:02,665 - root - ERROR - error_handler.py:61 - wrapper - RAG Error in from_file: Error loading from file data/embeddings/65d642d83b720a1e924d3ebef3a845fe_chunks_embeddings.pkl: 'BookDataInterface' object is not subscriptable
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/book_data_interface.py", line 19, in from_file
    return cls(data['chunks'], data['embeddings'], data.get('processed_text', {}))
               ~~~~^^^^^^^^^^
TypeError: 'BookDataInterface' object is not subscriptable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 59, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/book_data_interface.py", line 21, in from_file
    raise DataSourceError(f"Error loading from file {file_path}: {str(e)}")
src.error_handler.DataSourceError: Error loading from file data/embeddings/65d642d83b720a1e924d3ebef3a845fe_chunks_embeddings.pkl: 'BookDataInterface' object is not subscriptable
2024-10-25 17:48:02,666 - root - INFO - cli.py:37 - load_and_process_book - Book data created. Type: <class 'str'>
2024-10-25 17:48:02,666 - root - INFO - cli.py:38 - load_and_process_book - Book data attributes: ['__add__', '__class__', '__contains__', '__delattr__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__getitem__', '__getnewargs__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__iter__', '__le__', '__len__', '__lt__', '__mod__', '__mul__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__rmod__', '__rmul__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', 'capitalize', 'casefold', 'center', 'count', 'encode', 'endswith', 'expandtabs', 'find', 'format', 'format_map', 'index', 'isalnum', 'isalpha', 'isascii', 'isdecimal', 'isdigit', 'isidentifier', 'islower', 'isnumeric', 'isprintable', 'isspace', 'istitle', 'isupper', 'join', 'ljust', 'lower', 'lstrip', 'maketrans', 'partition', 'removeprefix', 'removesuffix', 'replace', 'rfind', 'rindex', 'rjust', 'rpartition', 'rsplit', 'rstrip', 'split', 'splitlines', 'startswith', 'strip', 'swapcase', 'title', 'translate', 'upper', 'zfill']
2024-10-25 17:48:02,666 - root - ERROR - cli.py:85 - run_cli - An error occurred: 'str' object has no attribute 'get_chunks'
2024-10-25 17:48:02,666 - root - INFO - cli.py:88 - run_cli - Exiting the RAG system
2024-10-25 17:56:01,890 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 17:56:01,892 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 17:56:01,898 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 17:56:01,899 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 17:56:01,906 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 17:56:02,267 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 17:56:02,267 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 17:56:02,557 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 17:56:02,557 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 17:56:02,767 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 17:56:02,776 - root - INFO - cli.py:57 - run_cli - Starting the RAG system
2024-10-25 17:56:02,777 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 17:56:02,778 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 17:56:05,747 - root - INFO - cli.py:68 - run_cli - Loading book from: tests/data/ford.txt
2024-10-25 17:56:05,748 - root - INFO - cli.py:24 - load_and_process_book - Starting to process book content
2024-10-25 17:56:05,748 - root - INFO - text_processing.py:75 - load_and_preprocess_text - Preprocessing text content
2024-10-25 17:56:06,041 - root - INFO - text_processing.py:81 - load_and_preprocess_text - Extracted 0 dates, 0 named entities, and 1 key phrases from the text
2024-10-25 17:56:06,041 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-25 17:56:06,041 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1 chunks
2024-10-25 17:56:06,041 - root - INFO - cli.py:27 - load_and_process_book - Text preprocessed. Number of chunks: 1
2024-10-25 17:56:06,041 - root - INFO - embedding.py:65 - get_or_create_chunks_and_embeddings - Loading existing chunks and embeddings from data/embeddings/65d642d83b720a1e924d3ebef3a845fe_chunks_embeddings.pkl
2024-10-25 17:56:06,042 - root - ERROR - cli.py:88 - run_cli - An error occurred: 'BookDataInterface' object is not subscriptable
2024-10-25 17:56:06,042 - root - INFO - cli.py:91 - run_cli - Exiting the RAG system
2024-10-25 17:58:20,429 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 17:58:20,430 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 17:58:20,437 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 17:58:20,438 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 17:58:20,449 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 17:58:20,769 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 17:58:20,771 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 17:58:21,000 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 17:58:21,000 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 17:58:21,216 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 17:58:21,225 - root - INFO - cli.py:58 - run_cli - Starting the RAG system
2024-10-25 17:58:21,227 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 17:58:21,227 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 17:58:34,737 - root - INFO - cli.py:69 - run_cli - Loading book from: tests/data/ford.txt
2024-10-25 17:58:34,738 - root - INFO - cli.py:25 - load_and_process_book - Starting to process book content
2024-10-25 17:58:34,738 - root - INFO - text_processing.py:75 - load_and_preprocess_text - Preprocessing text content
2024-10-25 17:58:35,034 - root - INFO - text_processing.py:81 - load_and_preprocess_text - Extracted 0 dates, 0 named entities, and 1 key phrases from the text
2024-10-25 17:58:35,034 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-25 17:58:35,034 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1 chunks
2024-10-25 17:58:35,034 - root - INFO - cli.py:28 - load_and_process_book - Text preprocessed. Number of chunks: 1
2024-10-25 17:58:35,034 - root - INFO - embedding.py:66 - get_or_create_chunks_and_embeddings - Loading existing chunks and embeddings from data/embeddings/65d642d83b720a1e924d3ebef3a845fe_chunks_embeddings.pkl
2024-10-25 17:58:35,035 - root - INFO - embedding.py:69 - get_or_create_chunks_and_embeddings - Loaded data type: <class 'src.book_data_interface.BookDataInterface'>
2024-10-25 17:58:35,035 - root - INFO - embedding.py:74 - get_or_create_chunks_and_embeddings - Loaded BookDataInterface object directly
2024-10-25 17:58:35,035 - root - INFO - cli.py:37 - load_and_process_book - Book data created. Type: <class 'src.book_data_interface.BookDataInterface'>
2024-10-25 17:58:35,035 - root - INFO - cli.py:38 - load_and_process_book - Book data attributes: ['__abstractmethods__', '__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__len__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__slots__', '__str__', '__subclasshook__', '__weakref__', '_abc_impl', '_chunks', '_embeddings', '_processed_text', 'from_file', 'get_chunks', 'get_embeddings', 'get_processed_text', 'save']
2024-10-25 17:58:35,035 - root - INFO - cli.py:41 - load_and_process_book - Book data created. Number of chunks: 1
2024-10-25 17:58:35,035 - root - INFO - cli.py:71 - run_cli - Book loaded and preprocessed. Text split into 1 chunks
2024-10-25 17:58:50,667 - root - INFO - cli.py:81 - run_cli - Received query:   ?
2024-10-25 17:58:50,667 - root - INFO - cli.py:48 - answer_question - Received query:   ?
2024-10-25 17:58:50,667 - root - INFO - rag.py:67 - rag_query - Processing query:   ?
2024-10-25 17:58:50,668 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 17:58:50,668 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 17:58:50,669 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 17:58:51,027 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 17:58:51,029 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 17:58:51,284 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 17:58:51,285 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 17:58:51,289 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x10af7ff60>, 'json_data': {'input': ['  ?'], 'model': 'text-embedding-3-small', 'encoding_format': 'base64'}}
2024-10-25 17:58:51,333 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-25 17:58:51,334 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-25 17:58:51,520 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10f03c2c0>
2024-10-25 17:58:51,520 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.started ssl_context=<ssl.SSLContext object at 0x10aec41d0> server_hostname='api.openai.com' timeout=5.0
2024-10-25 17:58:51,561 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10f03ca10>
2024-10-25 17:58:51,561 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-25 17:58:51,562 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-25 17:58:51,562 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-25 17:58:51,562 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-25 17:58:51,562 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-25 17:58:52,266 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 25 Oct 2024 16:58:52 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-3-small'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'64'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999992'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'0s'), (b'x-request-id', b'req_489f04f6b6b3183be5e7493f676a1d53'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=yXQ4m6hJEpVtWH.6Mr2xuvhFqlzcPvZ_j.WJwHHezgc-1729875532-1.0.1.1-zud3u83Eght8Q0Q5wwNDixVSGugksFVtMoq7kW6IBUtQroifOB9DuClEG0BxgpC97fIHeEm2y4hDrzuDqWFzFw; path=/; expires=Fri, 25-Oct-24 17:28:52 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=C36Zy56Z9Tdm_2cqrBhC81fgy37_EziOn1sFwhDTEzU-1729875532270-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d83c0f8cc9d6914-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-25 17:58:52,268 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-25 17:58:52,269 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-25 17:58:52,270 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-25 17:58:52,270 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-25 17:58:52,270 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-25 17:58:52,270 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers([('date', 'Fri, 25 Oct 2024 16:58:52 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-allow-origin', '*'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-model', 'text-embedding-3-small'), ('openai-organization', 'uinside'), ('openai-processing-ms', '64'), ('openai-version', '2020-10-01'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '5000000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '4999992'), ('x-ratelimit-reset-requests', '6ms'), ('x-ratelimit-reset-tokens', '0s'), ('x-request-id', 'req_489f04f6b6b3183be5e7493f676a1d53'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=yXQ4m6hJEpVtWH.6Mr2xuvhFqlzcPvZ_j.WJwHHezgc-1729875532-1.0.1.1-zud3u83Eght8Q0Q5wwNDixVSGugksFVtMoq7kW6IBUtQroifOB9DuClEG0BxgpC97fIHeEm2y4hDrzuDqWFzFw; path=/; expires=Fri, 25-Oct-24 17:28:52 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=C36Zy56Z9Tdm_2cqrBhC81fgy37_EziOn1sFwhDTEzU-1729875532270-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d83c0f8cc9d6914-LIS'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-25 17:58:52,271 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_489f04f6b6b3183be5e7493f676a1d53
2024-10-25 17:58:53,301 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 17:58:53,310 - root - INFO - openai_service.py:40 - generate_answer - Generating answer for query:   ?
2024-10-25 17:58:53,315 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful assistant specialized in extracting precise information from texts. Focus on providing accurate information. If the exact information is not available, explain what is known and what is missing.'}, {'role': 'user', 'content': 'Context: tests/data/ford.txt\n\nQuestion:   ?\n\nProvide a concise answer based on the context. If specific information is not available, briefly explain what is known and what is missing.'}], 'model': 'gpt-4o-mini', 'max_tokens': 15000}}
2024-10-25 17:58:53,316 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-25 17:58:53,316 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-25 17:58:53,349 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10f034170>
2024-10-25 17:58:53,350 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.started ssl_context=<ssl.SSLContext object at 0x10af78950> server_hostname='api.openai.com' timeout=5.0
2024-10-25 17:58:53,384 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10f034920>
2024-10-25 17:58:53,384 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-25 17:58:53,385 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-25 17:58:53,385 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-25 17:58:53,385 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-25 17:58:53,385 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-25 17:58:55,542 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 25 Oct 2024 16:58:55 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'1942'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9991828'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'49ms'), (b'x-request-id', b'req_3a52baf7550cfbae813100e9d67bdd6a'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=eySIq1FwgO4ysBBF2GA7x302reuMnk4madpNiu3ZkEQ-1729875535-1.0.1.1-kBUUwQEgLUXE_dSdxw3t3ixBss_KkY1JijhJDUTEZv_Hr7hlbTJzbn_vZ_NQAa0AI.noBRgN0Io2SrAiTc_dkA; path=/; expires=Fri, 25-Oct-24 17:28:55 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=M3Uc_0OAe73yy55L1zCr.uzodTeF07AUITXZYsgihbI-1729875535572-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d83c1043f6594ef-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-25 17:58:55,544 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-25 17:58:55,544 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-25 17:58:55,544 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-25 17:58:55,545 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-25 17:58:55,545 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-25 17:58:55,545 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Fri, 25 Oct 2024 16:58:55 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'uinside'), ('openai-processing-ms', '1942'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9991828'), ('x-ratelimit-reset-requests', '6ms'), ('x-ratelimit-reset-tokens', '49ms'), ('x-request-id', 'req_3a52baf7550cfbae813100e9d67bdd6a'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=eySIq1FwgO4ysBBF2GA7x302reuMnk4madpNiu3ZkEQ-1729875535-1.0.1.1-kBUUwQEgLUXE_dSdxw3t3ixBss_KkY1JijhJDUTEZv_Hr7hlbTJzbn_vZ_NQAa0AI.noBRgN0Io2SrAiTc_dkA; path=/; expires=Fri, 25-Oct-24 17:28:55 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=M3Uc_0OAe73yy55L1zCr.uzodTeF07AUITXZYsgihbI-1729875535572-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d83c1043f6594ef-LIS'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-25 17:58:55,545 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_3a52baf7550cfbae813100e9d67bdd6a
2024-10-25 17:58:55,551 - root - INFO - cli.py:51 - answer_question - Generated answer:        .        ,   .
2024-10-25 17:59:23,698 - root - INFO - cli.py:81 - run_cli - Received query: What is model year of the car?
2024-10-25 17:59:23,700 - root - INFO - cli.py:48 - answer_question - Received query: What is model year of the car?
2024-10-25 17:59:23,700 - root - INFO - rag.py:67 - rag_query - Processing query: What is model year of the car?
2024-10-25 17:59:23,701 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 17:59:23,702 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 17:59:23,702 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 17:59:24,327 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 17:59:24,329 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 17:59:24,568 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 17:59:24,568 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 17:59:24,570 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x11326fec0>, 'json_data': {'input': ['What is model year of the car?'], 'model': 'text-embedding-3-small', 'encoding_format': 'base64'}}
2024-10-25 17:59:24,571 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-25 17:59:24,571 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.started
2024-10-25 17:59:24,571 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.complete
2024-10-25 17:59:24,571 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-25 17:59:24,605 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10f0214f0>
2024-10-25 17:59:24,605 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.started ssl_context=<ssl.SSLContext object at 0x10aec41d0> server_hostname='api.openai.com' timeout=5.0
2024-10-25 17:59:24,651 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10f023500>
2024-10-25 17:59:24,651 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-25 17:59:24,652 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-25 17:59:24,652 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-25 17:59:24,652 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-25 17:59:24,652 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-25 17:59:24,894 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 25 Oct 2024 16:59:24 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-3-small'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'53'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999993'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'0s'), (b'x-request-id', b'req_5d9ae224276f6a3ad23f091a9f6de449'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d83c1c7a86ae3c4-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-25 17:59:24,894 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-25 17:59:24,894 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-25 17:59:24,895 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-25 17:59:24,895 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-25 17:59:24,895 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-25 17:59:24,895 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers({'date': 'Fri, 25 Oct 2024 16:59:24 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-allow-origin': '*', 'access-control-expose-headers': 'X-Request-ID', 'openai-model': 'text-embedding-3-small', 'openai-organization': 'uinside', 'openai-processing-ms': '53', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '5000000', 'x-ratelimit-remaining-requests': '9999', 'x-ratelimit-remaining-tokens': '4999993', 'x-ratelimit-reset-requests': '6ms', 'x-ratelimit-reset-tokens': '0s', 'x-request-id': 'req_5d9ae224276f6a3ad23f091a9f6de449', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d83c1c7a86ae3c4-LIS', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-25 17:59:24,895 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_5d9ae224276f6a3ad23f091a9f6de449
2024-10-25 17:59:25,814 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 17:59:25,823 - root - INFO - openai_service.py:40 - generate_answer - Generating answer for query: What is model year of the car?
2024-10-25 17:59:25,827 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful assistant specialized in extracting precise information from texts. Focus on providing accurate information. If the exact information is not available, explain what is known and what is missing.'}, {'role': 'user', 'content': 'Context: tests/data/ford.txt\n\nQuestion: What is model year of the car?\n\nProvide a concise answer based on the context. If specific information is not available, briefly explain what is known and what is missing.'}], 'model': 'gpt-4o-mini', 'max_tokens': 15000}}
2024-10-25 17:59:25,828 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-25 17:59:25,828 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.started
2024-10-25 17:59:25,829 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.complete
2024-10-25 17:59:25,829 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-25 17:59:25,863 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10f021130>
2024-10-25 17:59:25,864 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.started ssl_context=<ssl.SSLContext object at 0x10af78950> server_hostname='api.openai.com' timeout=5.0
2024-10-25 17:59:25,906 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10f021310>
2024-10-25 17:59:25,906 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-25 17:59:25,907 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-25 17:59:25,907 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-25 17:59:25,907 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-25 17:59:25,907 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-25 17:59:26,851 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 25 Oct 2024 16:59:26 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'756'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9991828'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'49ms'), (b'x-request-id', b'req_aafcbb2dff8286ad8541ed9c425b21af'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d83c1cf7a5b6917-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-25 17:59:26,852 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-25 17:59:26,852 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-25 17:59:26,853 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-25 17:59:26,853 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-25 17:59:26,853 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-25 17:59:26,853 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Fri, 25 Oct 2024 16:59:26 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'uinside', 'openai-processing-ms': '756', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000000', 'x-ratelimit-remaining-requests': '9999', 'x-ratelimit-remaining-tokens': '9991828', 'x-ratelimit-reset-requests': '6ms', 'x-ratelimit-reset-tokens': '49ms', 'x-request-id': 'req_aafcbb2dff8286ad8541ed9c425b21af', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d83c1cf7a5b6917-LIS', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-25 17:59:26,854 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_aafcbb2dff8286ad8541ed9c425b21af
2024-10-25 17:59:26,854 - root - INFO - cli.py:51 - answer_question - Generated answer: I'm sorry, but I do not have access to the content of "tests/data/ford.txt" to extract information about the model year of the car. If you can provide the text or relevant details from the file, I would be happy to help you determine the model year.
2024-10-25 18:04:28,211 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 18:04:28,212 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 18:04:28,219 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 18:04:28,219 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 18:04:28,230 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 18:04:29,120 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 18:04:29,122 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 18:04:29,507 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 18:04:29,507 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 18:04:29,946 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 18:04:29,956 - root - INFO - cli.py:61 - run_cli - Starting the RAG system
2024-10-25 18:04:29,957 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 18:04:29,958 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 18:12:16,831 - root - INFO - cli.py:72 - run_cli - Loading book from: tests/data/ford.txt
2024-10-25 18:12:16,832 - root - INFO - cli.py:25 - load_and_process_book - Starting to process book content
2024-10-25 18:12:16,832 - root - INFO - text_processing.py:76 - load_and_preprocess_text - Preprocessing text content
2024-10-25 18:12:17,124 - root - INFO - text_processing.py:82 - load_and_preprocess_text - Extracted 0 dates, 0 named entities, and 1 key phrases from the text
2024-10-25 18:12:17,124 - root - INFO - text_processing.py:96 - split_into_chunks - Splitting text into chunks (size: 200, overlap: 50)
2024-10-25 18:14:10,401 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 18:14:10,402 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 18:14:10,409 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 18:14:10,409 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 18:14:10,418 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 18:14:10,923 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 18:14:10,924 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 18:14:12,474 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 18:14:12,475 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 18:14:12,672 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 18:14:12,677 - root - INFO - cli.py:61 - run_cli - Starting the RAG system
2024-10-25 18:14:12,677 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 18:14:12,678 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 18:14:18,236 - root - INFO - cli.py:72 - run_cli - Loading book from: tests/data/ford.txt
2024-10-25 18:14:18,238 - root - INFO - cli.py:75 - run_cli - File content (178970 chars): Grimshaw v. Ford Motor Co. (1981)
Annotate this Case
[Civ. No. 20095. Court of Appeals of California, Fourth Appellate District, Division Two. May 29, 1981.]
RICHARD GRIMSHAW, a Minor, etc., Plaintiff...
2024-10-25 18:14:18,238 - root - INFO - cli.py:25 - load_and_process_book - Starting to process book content
2024-10-25 18:14:18,238 - root - INFO - text_processing.py:76 - load_and_preprocess_text - Preprocessing text content
2024-10-25 18:14:22,364 - root - INFO - text_processing.py:82 - load_and_preprocess_text - Extracted 10 dates, 1436 named entities, and 5 key phrases from the text
2024-10-25 18:14:22,364 - root - INFO - text_processing.py:96 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-25 18:31:07,141 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 18:31:07,146 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 18:31:07,155 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 18:31:07,155 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 18:31:07,162 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 18:31:07,698 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 18:31:07,701 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 18:31:08,084 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 18:31:08,084 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 18:31:09,317 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 18:31:09,323 - root - INFO - cli.py:61 - run_cli - Starting the RAG system
2024-10-25 18:31:09,325 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 18:31:09,325 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 18:31:21,406 - root - INFO - cli.py:72 - run_cli - Loading book from: tests/data/ford.txt
2024-10-25 18:31:21,408 - root - INFO - cli.py:75 - run_cli - File content (178970 chars): Grimshaw v. Ford Motor Co. (1981)
Annotate this Case
[Civ. No. 20095. Court of Appeals of California, Fourth Appellate District, Division Two. May 29, 1981.]
RICHARD GRIMSHAW, a Minor, etc., Plaintiff...
2024-10-25 18:36:28,227 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 18:36:28,228 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 18:36:28,235 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 18:36:28,235 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 18:36:28,239 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 18:36:28,951 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 18:36:28,951 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 18:36:29,496 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 18:36:29,496 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 18:36:29,734 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 18:36:29,737 - root - INFO - cli.py:64 - run_cli - Starting the RAG system
2024-10-25 18:36:29,737 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 18:36:29,737 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 18:38:40,871 - root - INFO - cli.py:75 - run_cli - Loading book from: tests/data/ford.txt
2024-10-25 18:38:40,874 - root - INFO - cli.py:78 - run_cli - File content (178970 chars): Grimshaw v. Ford Motor Co. (1981)
Annotate this Case
[Civ. No. 20095. Court of Appeals of California, Fourth Appellate District, Division Two. May 29, 1981.]
RICHARD GRIMSHAW, a Minor, etc., Plaintiff...
2024-10-25 18:38:40,874 - root - INFO - cli.py:28 - load_and_process_book - Starting to process book content
2024-10-25 18:38:40,874 - root - INFO - text_processing.py:76 - load_and_preprocess_text - Preprocessing text content
2024-10-25 18:38:45,082 - root - INFO - text_processing.py:82 - load_and_preprocess_text - Extracted 10 dates, 1436 named entities, and 5 key phrases from the text
2024-10-25 18:38:45,082 - root - INFO - text_processing.py:96 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-25 19:03:33,918 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 19:03:33,918 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 19:03:33,925 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 19:03:33,926 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 19:03:33,934 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 19:03:34,485 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 19:03:34,487 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 19:03:36,734 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 19:03:36,735 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 19:03:37,757 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 19:03:39,423 - root - INFO - text_processing.py:96 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-25 19:03:39,559 - root - INFO - conftest.py:58 - timer - Test test_main_cli_mode took 0.00 seconds
2024-10-25 19:03:39,560 - root - INFO - conftest.py:58 - timer - Test test_main_api_mode took 0.00 seconds
2024-10-25 19:03:39,561 - root - INFO - conftest.py:58 - timer - Test test_main_invalid_mode took 0.00 seconds
2024-10-25 19:03:39,562 - root - INFO - cli.py:28 - load_and_process_book - Starting to process book content
2024-10-25 19:03:39,562 - root - INFO - cli.py:31 - load_and_process_book - Text preprocessed. Number of chunks: 2
2024-10-25 19:03:39,562 - root - INFO - cli.py:33 - load_and_process_book - Chunk 1 content (6 chars): chunk1...
2024-10-25 19:03:39,562 - root - INFO - cli.py:33 - load_and_process_book - Chunk 2 content (6 chars): chunk2...
2024-10-25 19:03:39,562 - root - INFO - cli.py:42 - load_and_process_book - Book data created. Type: <class 'unittest.mock.MagicMock'>
2024-10-25 19:03:39,562 - root - INFO - cli.py:43 - load_and_process_book - Book data attributes: ['__abstractmethods__', '__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__len__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__slots__', '__str__', '__subclasshook__', '__weakref__', '_abc_impl', 'assert_any_call', 'assert_called', 'assert_called_once', 'assert_called_once_with', 'assert_called_with', 'assert_has_calls', 'assert_not_called', 'attach_mock', 'call_args', 'call_args_list', 'call_count', 'called', 'chunks', 'configure_mock', 'embeddings', 'from_file', 'get_chunks', 'get_embeddings', 'get_processed_text', 'method_calls', 'mock_add_spec', 'mock_calls', 'reset_mock', 'return_value', 'save', 'side_effect']
2024-10-25 19:03:39,563 - root - INFO - cli.py:46 - load_and_process_book - Book data created. Number of chunks: 0
2024-10-25 19:03:39,563 - root - INFO - cli.py:47 - load_and_process_book - First chunk content: <MagicMock name='get_or_create_chunks_and_embeddings().get_chunks().__getitem__().__getitem__()' id='5914248640'>...
2024-10-25 19:03:39,563 - root - INFO - conftest.py:58 - timer - Test test_load_and_process_book took 0.00 seconds
2024-10-25 19:03:39,567 - root - INFO - conftest.py:58 - timer - Test test_answer_question took 0.00 seconds
2024-10-25 19:03:39,568 - root - INFO - cli.py:64 - run_cli - Starting the RAG system
2024-10-25 19:03:39,568 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 19:03:39,569 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 19:03:39,575 - root - INFO - cli.py:75 - run_cli - Loading book from: input1
2024-10-25 19:03:39,575 - root - ERROR - cli.py:105 - run_cli - An unexpected error occurred: [Errno 2] No such file or directory: 'input1'
2024-10-25 19:03:39,576 - root - INFO - cli.py:108 - run_cli - Exiting the RAG system
2024-10-25 19:03:39,577 - root - INFO - conftest.py:58 - timer - Test test_run_cli[input1] took 0.01 seconds
2024-10-25 19:03:39,578 - root - INFO - cli.py:64 - run_cli - Starting the RAG system
2024-10-25 19:03:39,578 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 19:03:39,578 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 19:03:39,585 - root - INFO - cli.py:75 - run_cli - Loading book from: input2
2024-10-25 19:03:39,585 - root - ERROR - cli.py:105 - run_cli - An unexpected error occurred: [Errno 2] No such file or directory: 'input2'
2024-10-25 19:03:39,586 - root - INFO - cli.py:108 - run_cli - Exiting the RAG system
2024-10-25 19:03:39,588 - root - INFO - conftest.py:58 - timer - Test test_run_cli[input2] took 0.01 seconds
2024-10-25 19:03:39,589 - root - INFO - cli.py:64 - run_cli - Starting the RAG system
2024-10-25 19:03:39,589 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 19:03:39,590 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 19:03:39,596 - root - ERROR - cli.py:105 - run_cli - An unexpected error occurred: The file nonexistent_file.txt does not exist.
2024-10-25 19:03:39,597 - root - INFO - cli.py:108 - run_cli - Exiting the RAG system
2024-10-25 19:03:39,646 - root - INFO - conftest.py:58 - timer - Test test_run_cli_file_not_found took 0.06 seconds
2024-10-25 19:03:39,652 - root - INFO - embedding.py:27 - create_embeddings - Starting to create embeddings for 2 chunks
2024-10-25 19:03:39,654 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 19:03:39,654 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 19:03:39,664 - root - INFO - openai_service.py:94 - create_embedding - Creating embedding for text: Test chunk 1...
2024-10-25 19:03:39,665 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x160f62200>, 'json_data': {'input': 'Test chunk 1', 'model': 'text-embedding-ada-002', 'encoding_format': 'base64'}}
2024-10-25 19:03:39,709 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-25 19:03:39,709 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-25 19:03:39,840 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x1607cdb50>
2024-10-25 19:03:39,841 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.started ssl_context=<ssl.SSLContext object at 0x160897e50> server_hostname='api.openai.com' timeout=5.0
2024-10-25 19:03:39,877 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x160fd7620>
2024-10-25 19:03:39,877 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-25 19:03:39,878 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-25 19:03:39,878 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-25 19:03:39,878 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-25 19:03:39,878 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-25 19:03:40,283 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 25 Oct 2024 18:03:40 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-ada-002'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'41'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999997'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'0s'), (b'x-request-id', b'req_c89be32709dd90cf3006fb325f126c07'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=6xe_Pg1h6mldmIWwZ0D9ZbSLFA6DFJIw7FMLjWO6_u0-1729879420-1.0.1.1-xWYWeZW2PsWcb3rtKM5EJ18vDI66p8FPN1pc1T0ZzxbhPQqusTEWXvWRqs3sPQhkbph_o8MqiIMKE20tuYjP8Q; path=/; expires=Fri, 25-Oct-24 18:33:40 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=q6.YA_HbnUiOb96F3boJeig6ZSxyfOfrDHA4p5yakYE-1729879420341-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d841fe6d820e3b0-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-25 19:03:40,286 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-25 19:03:40,287 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-25 19:03:40,326 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-25 19:03:40,327 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-25 19:03:40,327 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-25 19:03:40,328 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers([('date', 'Fri, 25 Oct 2024 18:03:40 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-allow-origin', '*'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-model', 'text-embedding-ada-002'), ('openai-organization', 'uinside'), ('openai-processing-ms', '41'), ('openai-version', '2020-10-01'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '5000000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '4999997'), ('x-ratelimit-reset-requests', '6ms'), ('x-ratelimit-reset-tokens', '0s'), ('x-request-id', 'req_c89be32709dd90cf3006fb325f126c07'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=6xe_Pg1h6mldmIWwZ0D9ZbSLFA6DFJIw7FMLjWO6_u0-1729879420-1.0.1.1-xWYWeZW2PsWcb3rtKM5EJ18vDI66p8FPN1pc1T0ZzxbhPQqusTEWXvWRqs3sPQhkbph_o8MqiIMKE20tuYjP8Q; path=/; expires=Fri, 25-Oct-24 18:33:40 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=q6.YA_HbnUiOb96F3boJeig6ZSxyfOfrDHA4p5yakYE-1729879420341-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d841fe6d820e3b0-LIS'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-25 19:03:40,328 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_c89be32709dd90cf3006fb325f126c07
2024-10-25 19:03:40,334 - root - INFO - openai_service.py:100 - create_embedding - Successfully created embedding of length 1536
2024-10-25 19:03:40,334 - root - INFO - openai_service.py:94 - create_embedding - Creating embedding for text: Test chunk 2...
2024-10-25 19:03:40,335 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x1611e84a0>, 'json_data': {'input': 'Test chunk 2', 'model': 'text-embedding-ada-002', 'encoding_format': 'base64'}}
2024-10-25 19:03:40,336 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-25 19:03:40,337 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-25 19:03:40,337 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-25 19:03:40,337 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-25 19:03:40,338 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-25 19:03:40,338 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-25 19:03:41,087 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 25 Oct 2024 18:03:41 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-ada-002'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'177'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999997'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'0s'), (b'x-request-id', b'req_86e51dbb336e7a6dac4fd0e5b4d383ae'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d841fe9b818e3b0-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-25 19:03:41,088 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-25 19:03:41,089 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-25 19:03:41,090 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-25 19:03:41,090 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-25 19:03:41,090 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-25 19:03:41,090 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers({'date': 'Fri, 25 Oct 2024 18:03:41 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-allow-origin': '*', 'access-control-expose-headers': 'X-Request-ID', 'openai-model': 'text-embedding-ada-002', 'openai-organization': 'uinside', 'openai-processing-ms': '177', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '5000000', 'x-ratelimit-remaining-requests': '9999', 'x-ratelimit-remaining-tokens': '4999997', 'x-ratelimit-reset-requests': '6ms', 'x-ratelimit-reset-tokens': '0s', 'x-request-id': 'req_86e51dbb336e7a6dac4fd0e5b4d383ae', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d841fe9b818e3b0-LIS', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-25 19:03:41,091 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_86e51dbb336e7a6dac4fd0e5b4d383ae
2024-10-25 19:03:41,092 - root - INFO - openai_service.py:100 - create_embedding - Successfully created embedding of length 1536
2024-10-25 19:03:41,092 - root - INFO - embedding.py:39 - create_embeddings - Finished creating embeddings for 2 chunks
2024-10-25 19:03:41,094 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_length[chunks0-2] took 1.45 seconds
2024-10-25 19:03:41,097 - root - INFO - embedding.py:27 - create_embeddings - Starting to create embeddings for 1 chunks
2024-10-25 19:03:41,098 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 19:03:41,099 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 19:03:41,115 - root - INFO - openai_service.py:94 - create_embedding - Creating embedding for text: Single chunk...
2024-10-25 19:03:41,116 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x1611ea160>, 'json_data': {'input': 'Single chunk', 'model': 'text-embedding-ada-002', 'encoding_format': 'base64'}}
2024-10-25 19:03:41,116 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-25 19:03:41,116 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-25 19:03:41,149 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x160fb1f40>
2024-10-25 19:03:41,149 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.started ssl_context=<ssl.SSLContext object at 0x161196350> server_hostname='api.openai.com' timeout=5.0
2024-10-25 19:03:41,191 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x160fb21b0>
2024-10-25 19:03:41,191 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-25 19:03:41,191 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-25 19:03:41,191 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-25 19:03:41,191 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-25 19:03:41,191 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-25 19:03:41,899 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 25 Oct 2024 18:03:41 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-ada-002'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'128'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999997'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'0s'), (b'x-request-id', b'req_179f965bf56e2b7fefc8d7f669d8bdae'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=ehAeSBORnUhf58bTpNodTvxjw.xUJ7Fd51t4isqHCjg-1729879421-1.0.1.1-PfBHY47iH..DQOWaWTVPrF7vEloWmUZy57m_SvupWEN62OtCBW5pfdoYWz_Ax6B_LDoSYJaL_JhRooVZkpUS1g; path=/; expires=Fri, 25-Oct-24 18:33:41 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=UMstqDSptqtW5P0ypXAsC_tyQ21pPf8XXM9SUIpUPuQ-1729879421960-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d841fef094203e6-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-25 19:03:41,899 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-25 19:03:41,899 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-25 19:03:41,922 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-25 19:03:41,922 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-25 19:03:41,922 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-25 19:03:41,922 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers([('date', 'Fri, 25 Oct 2024 18:03:41 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-allow-origin', '*'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-model', 'text-embedding-ada-002'), ('openai-organization', 'uinside'), ('openai-processing-ms', '128'), ('openai-version', '2020-10-01'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '5000000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '4999997'), ('x-ratelimit-reset-requests', '6ms'), ('x-ratelimit-reset-tokens', '0s'), ('x-request-id', 'req_179f965bf56e2b7fefc8d7f669d8bdae'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=ehAeSBORnUhf58bTpNodTvxjw.xUJ7Fd51t4isqHCjg-1729879421-1.0.1.1-PfBHY47iH..DQOWaWTVPrF7vEloWmUZy57m_SvupWEN62OtCBW5pfdoYWz_Ax6B_LDoSYJaL_JhRooVZkpUS1g; path=/; expires=Fri, 25-Oct-24 18:33:41 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=UMstqDSptqtW5P0ypXAsC_tyQ21pPf8XXM9SUIpUPuQ-1729879421960-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d841fef094203e6-LIS'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-25 19:03:41,923 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_179f965bf56e2b7fefc8d7f669d8bdae
2024-10-25 19:03:41,924 - root - INFO - openai_service.py:100 - create_embedding - Successfully created embedding of length 1536
2024-10-25 19:03:41,924 - root - INFO - embedding.py:39 - create_embeddings - Finished creating embeddings for 1 chunks
2024-10-25 19:03:41,925 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_length[chunks1-1] took 0.83 seconds
2024-10-25 19:03:41,928 - root - INFO - embedding.py:27 - create_embeddings - Starting to create embeddings for 0 chunks
2024-10-25 19:03:41,929 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 19:03:41,930 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 19:03:41,946 - root - INFO - embedding.py:39 - create_embeddings - Finished creating embeddings for 0 chunks
2024-10-25 19:03:41,947 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_length[chunks2-0] took 0.02 seconds
2024-10-25 19:03:41,948 - root - INFO - embedding.py:27 - create_embeddings - Starting to create embeddings for 1 chunks
2024-10-25 19:03:41,949 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 19:03:41,950 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 19:03:41,963 - root - INFO - openai_service.py:94 - create_embedding - Creating embedding for text: Test chunk...
2024-10-25 19:03:41,963 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x1611a1c60>, 'json_data': {'input': 'Test chunk', 'model': 'text-embedding-ada-002', 'encoding_format': 'base64'}}
2024-10-25 19:03:41,963 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-25 19:03:41,964 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-25 19:03:41,998 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x1611403e0>
2024-10-25 19:03:41,998 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.started ssl_context=<ssl.SSLContext object at 0x16182a3d0> server_hostname='api.openai.com' timeout=5.0
2024-10-25 19:03:42,040 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x161141880>
2024-10-25 19:03:42,040 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-25 19:03:42,040 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-25 19:03:42,040 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-25 19:03:42,040 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-25 19:03:42,040 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-25 19:03:42,415 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 25 Oct 2024 18:03:42 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-ada-002'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'121'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999998'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'0s'), (b'x-request-id', b'req_730ff70089dc0cf95ee1b1f7093a354d'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=k9nWl.6hn338ynua.QkhptNfxwECafd7EMjwGro_9DI-1729879422-1.0.1.1-Mqdk1KXIUXc7La3.pwh5LMML5w6m.R.CBIadfg3OKwxYm7ropJX3cV7xgHj0_f3fo8j_KuJZgxz_zdEKQVnT3A; path=/; expires=Fri, 25-Oct-24 18:33:42 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=BsUJX313ZxRlZxxvfFJzEh4QI3hbN0y8GgSWp2nm5dY-1729879422476-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d841ff45a6d6914-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-25 19:03:42,415 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-25 19:03:42,416 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-25 19:03:42,417 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-25 19:03:42,417 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-25 19:03:42,417 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-25 19:03:42,417 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers([('date', 'Fri, 25 Oct 2024 18:03:42 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-allow-origin', '*'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-model', 'text-embedding-ada-002'), ('openai-organization', 'uinside'), ('openai-processing-ms', '121'), ('openai-version', '2020-10-01'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '5000000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '4999998'), ('x-ratelimit-reset-requests', '6ms'), ('x-ratelimit-reset-tokens', '0s'), ('x-request-id', 'req_730ff70089dc0cf95ee1b1f7093a354d'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=k9nWl.6hn338ynua.QkhptNfxwECafd7EMjwGro_9DI-1729879422-1.0.1.1-Mqdk1KXIUXc7La3.pwh5LMML5w6m.R.CBIadfg3OKwxYm7ropJX3cV7xgHj0_f3fo8j_KuJZgxz_zdEKQVnT3A; path=/; expires=Fri, 25-Oct-24 18:33:42 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=BsUJX313ZxRlZxxvfFJzEh4QI3hbN0y8GgSWp2nm5dY-1729879422476-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d841ff45a6d6914-LIS'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-25 19:03:42,417 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_730ff70089dc0cf95ee1b1f7093a354d
2024-10-25 19:03:42,418 - root - INFO - openai_service.py:100 - create_embedding - Successfully created embedding of length 1536
2024-10-25 19:03:42,418 - root - INFO - embedding.py:39 - create_embeddings - Finished creating embeddings for 1 chunks
2024-10-25 19:03:42,419 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_structure took 0.47 seconds
2024-10-25 19:03:42,421 - root - INFO - embedding.py:27 - create_embeddings - Starting to create embeddings for 1 chunks
2024-10-25 19:03:42,423 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 19:03:42,424 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 19:03:42,437 - root - INFO - openai_service.py:94 - create_embedding - Creating embedding for text: Test text...
2024-10-25 19:03:42,437 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x1611a39c0>, 'json_data': {'input': 'Test text', 'model': 'text-embedding-ada-002', 'encoding_format': 'base64'}}
2024-10-25 19:03:42,438 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-25 19:03:42,438 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-25 19:03:42,472 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x161146930>
2024-10-25 19:03:42,472 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.started ssl_context=<ssl.SSLContext object at 0x1611978d0> server_hostname='api.openai.com' timeout=5.0
2024-10-25 19:03:42,511 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x161146750>
2024-10-25 19:03:42,511 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-25 19:03:42,512 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-25 19:03:42,512 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-25 19:03:42,512 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-25 19:03:42,512 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-25 19:03:42,857 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 25 Oct 2024 18:03:42 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-ada-002'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'114'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999998'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'0s'), (b'x-request-id', b'req_621609d7bc00344a988defccfac51672'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=YR.1kSQcXeAqxNR4rA2BNImfjISazdRqk2cAIrtHoZg-1729879422-1.0.1.1-p3tMGWgHF5MjjagEHwm9JJA2xPhum0S2DMn0.P6DjOidMLdmzRUSuif8cnjSAvvxaftYLRZfUhmZEbE4PCo8jA; path=/; expires=Fri, 25-Oct-24 18:33:42 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=y1JW5Ffu442Iatb4zTDmMG82heBKIhaPw_TeY7lVmiM-1729879422915-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d841ff74eb9e3bd-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-25 19:03:42,858 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-25 19:03:42,859 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-25 19:03:42,860 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-25 19:03:42,860 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-25 19:03:42,860 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-25 19:03:42,861 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers([('date', 'Fri, 25 Oct 2024 18:03:42 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-allow-origin', '*'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-model', 'text-embedding-ada-002'), ('openai-organization', 'uinside'), ('openai-processing-ms', '114'), ('openai-version', '2020-10-01'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '5000000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '4999998'), ('x-ratelimit-reset-requests', '6ms'), ('x-ratelimit-reset-tokens', '0s'), ('x-request-id', 'req_621609d7bc00344a988defccfac51672'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=YR.1kSQcXeAqxNR4rA2BNImfjISazdRqk2cAIrtHoZg-1729879422-1.0.1.1-p3tMGWgHF5MjjagEHwm9JJA2xPhum0S2DMn0.P6DjOidMLdmzRUSuif8cnjSAvvxaftYLRZfUhmZEbE4PCo8jA; path=/; expires=Fri, 25-Oct-24 18:33:42 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=y1JW5Ffu442Iatb4zTDmMG82heBKIhaPw_TeY7lVmiM-1729879422915-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d841ff74eb9e3bd-LIS'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-25 19:03:42,861 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_621609d7bc00344a988defccfac51672
2024-10-25 19:03:42,862 - root - INFO - openai_service.py:100 - create_embedding - Successfully created embedding of length 1536
2024-10-25 19:03:42,862 - root - INFO - embedding.py:39 - create_embeddings - Finished creating embeddings for 1 chunks
2024-10-25 19:03:42,870 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_api_error took 0.45 seconds
2024-10-25 19:03:42,873 - root - INFO - embedding.py:27 - create_embeddings - Starting to create embeddings for 1 chunks
2024-10-25 19:03:42,874 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 19:03:42,875 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 19:03:42,889 - root - INFO - openai_service.py:94 - create_embedding - Creating embedding for text: ...
2024-10-25 19:03:42,890 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x1611ba200>, 'json_data': {'input': '', 'model': 'text-embedding-ada-002', 'encoding_format': 'base64'}}
2024-10-25 19:03:42,890 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-25 19:03:42,890 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-25 19:03:42,919 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x1615d4ec0>
2024-10-25 19:03:42,920 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.started ssl_context=<ssl.SSLContext object at 0x1611b6c50> server_hostname='api.openai.com' timeout=5.0
2024-10-25 19:03:42,959 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x161146960>
2024-10-25 19:03:42,959 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-25 19:03:42,959 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-25 19:03:42,959 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-25 19:03:42,959 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-25 19:03:42,959 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-25 19:03:43,644 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 25 Oct 2024 18:03:43 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-ada-002'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'117'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-request-id', b'req_a385745991c417ea59e4c3f864fdc520'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=rYbMUs2tN9iTwmFnlQGiHq7TDC2vBfEt3hoQWZT8KjM-1729879423-1.0.1.1-ZTLP5ZwyWF26X3lMPud4hYk_ABwe4oY0ZgJRUDO_p.L3h2_JOlobr9hwquafni5gjZAG3f6ogITb3ZqkbE.cGg; path=/; expires=Fri, 25-Oct-24 18:33:43 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=R6c5JnsP2nXmnvFLGZ6g2Qudf.Fid5Obd4AAKiSUdPw-1729879423707-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d841ffa1d35e3c3-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-25 19:03:43,646 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-25 19:03:43,646 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-25 19:03:43,660 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-25 19:03:43,661 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-25 19:03:43,661 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-25 19:03:43,661 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers([('date', 'Fri, 25 Oct 2024 18:03:43 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-allow-origin', '*'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-model', 'text-embedding-ada-002'), ('openai-organization', 'uinside'), ('openai-processing-ms', '117'), ('openai-version', '2020-10-01'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-reset-requests', '6ms'), ('x-request-id', 'req_a385745991c417ea59e4c3f864fdc520'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=rYbMUs2tN9iTwmFnlQGiHq7TDC2vBfEt3hoQWZT8KjM-1729879423-1.0.1.1-ZTLP5ZwyWF26X3lMPud4hYk_ABwe4oY0ZgJRUDO_p.L3h2_JOlobr9hwquafni5gjZAG3f6ogITb3ZqkbE.cGg; path=/; expires=Fri, 25-Oct-24 18:33:43 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=R6c5JnsP2nXmnvFLGZ6g2Qudf.Fid5Obd4AAKiSUdPw-1729879423707-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d841ffa1d35e3c3-LIS'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-25 19:03:43,662 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_a385745991c417ea59e4c3f864fdc520
2024-10-25 19:03:43,663 - root - INFO - openai_service.py:100 - create_embedding - Successfully created embedding of length 1536
2024-10-25 19:03:43,664 - root - INFO - embedding.py:39 - create_embeddings - Finished creating embeddings for 1 chunks
2024-10-25 19:03:43,665 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_various_lengths[-1536] took 0.79 seconds
2024-10-25 19:03:43,667 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.started
2024-10-25 19:03:43,668 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.complete
2024-10-25 19:03:43,672 - root - INFO - embedding.py:27 - create_embeddings - Starting to create embeddings for 1 chunks
2024-10-25 19:03:43,673 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 19:03:43,674 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 19:03:43,690 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.started
2024-10-25 19:03:43,690 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.complete
2024-10-25 19:03:43,690 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.started
2024-10-25 19:03:43,690 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.complete
2024-10-25 19:03:43,691 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.started
2024-10-25 19:03:43,691 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.complete
2024-10-25 19:03:43,691 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.started
2024-10-25 19:03:43,691 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.complete
2024-10-25 19:03:43,700 - root - INFO - openai_service.py:94 - create_embedding - Creating embedding for text: Short text...
2024-10-25 19:03:43,701 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x160fd8400>, 'json_data': {'input': 'Short text', 'model': 'text-embedding-ada-002', 'encoding_format': 'base64'}}
2024-10-25 19:03:43,701 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-25 19:03:43,702 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-25 19:03:43,735 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x1611628d0>
2024-10-25 19:03:43,735 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.started ssl_context=<ssl.SSLContext object at 0x1611b7d50> server_hostname='api.openai.com' timeout=5.0
2024-10-25 19:03:43,771 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x161162a20>
2024-10-25 19:03:43,771 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-25 19:03:43,771 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-25 19:03:43,771 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-25 19:03:43,771 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-25 19:03:43,771 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-25 19:03:44,533 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 25 Oct 2024 18:03:44 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-ada-002'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'190'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999998'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'0s'), (b'x-request-id', b'req_1d6372c8d87c4ee5c82d7d86954852a9'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=jPfmpWY4rLy6W6HmwUhrwpBMk2jtMR8gsvhQbQeTTIw-1729879424-1.0.1.1-5tnnc1giXW6XeQtUp2tgnPr0on.oaGQn1sF.Wvl7EkHp5AFM6f6hK8ISmfmX9hJN4ypco1UyN2j9AVTKemY_PA; path=/; expires=Fri, 25-Oct-24 18:33:44 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=qg8wwwuyR4mPOfbLiqAyQdElpV.8N_j1WbvrguwEK4E-1729879424592-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d841fff2cf1488e-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-25 19:03:44,534 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-25 19:03:44,535 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-25 19:03:44,536 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-25 19:03:44,536 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-25 19:03:44,536 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-25 19:03:44,536 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers([('date', 'Fri, 25 Oct 2024 18:03:44 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-allow-origin', '*'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-model', 'text-embedding-ada-002'), ('openai-organization', 'uinside'), ('openai-processing-ms', '190'), ('openai-version', '2020-10-01'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '5000000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '4999998'), ('x-ratelimit-reset-requests', '6ms'), ('x-ratelimit-reset-tokens', '0s'), ('x-request-id', 'req_1d6372c8d87c4ee5c82d7d86954852a9'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=jPfmpWY4rLy6W6HmwUhrwpBMk2jtMR8gsvhQbQeTTIw-1729879424-1.0.1.1-5tnnc1giXW6XeQtUp2tgnPr0on.oaGQn1sF.Wvl7EkHp5AFM6f6hK8ISmfmX9hJN4ypco1UyN2j9AVTKemY_PA; path=/; expires=Fri, 25-Oct-24 18:33:44 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=qg8wwwuyR4mPOfbLiqAyQdElpV.8N_j1WbvrguwEK4E-1729879424592-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d841fff2cf1488e-LIS'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-25 19:03:44,537 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_1d6372c8d87c4ee5c82d7d86954852a9
2024-10-25 19:03:44,537 - root - INFO - openai_service.py:100 - create_embedding - Successfully created embedding of length 1536
2024-10-25 19:03:44,538 - root - INFO - embedding.py:39 - create_embeddings - Finished creating embeddings for 1 chunks
2024-10-25 19:03:44,539 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_various_lengths[Short text-1536] took 0.87 seconds
2024-10-25 19:03:44,542 - root - INFO - embedding.py:27 - create_embeddings - Starting to create embeddings for 1 chunks
2024-10-25 19:03:44,543 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 19:03:44,544 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 19:03:44,557 - root - INFO - openai_service.py:94 - create_embedding - Creating embedding for text: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA...
2024-10-25 19:03:44,558 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x1611a2020>, 'json_data': {'input': 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA', 'model': 'text-embedding-ada-002', 'encoding_format': 'base64'}}
2024-10-25 19:03:44,558 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-25 19:03:44,559 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-25 19:03:44,589 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x1611335f0>
2024-10-25 19:03:44,590 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.started ssl_context=<ssl.SSLContext object at 0x16182a1d0> server_hostname='api.openai.com' timeout=5.0
2024-10-25 19:03:44,633 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x1611333e0>
2024-10-25 19:03:44,633 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-25 19:03:44,633 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-25 19:03:44,633 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-25 19:03:44,633 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-25 19:03:44,633 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-25 19:03:44,920 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 25 Oct 2024 18:03:44 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-ada-002'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'84'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999750'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'3ms'), (b'x-request-id', b'req_0803e4e2a6200c978ca30ed5ee5abc02'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=PdcCBOvhVxu27T5SP2.O3IA59vkFg8L8w3Bu5j0PvaY-1729879424-1.0.1.1-irO6qKSJh1VCt6Vx12n56j1N_GmYoEXWSIVxl4CcCS08FowdFCIeGlSAAAe9FpvuAdB.97a.Ulu8VDuhJUeMBg; path=/; expires=Fri, 25-Oct-24 18:33:44 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=q94hNiE.0bWTEZ.P9a0_MguRTpqueYj.lmwyXq.5i40-1729879424979-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d8420048fb6692c-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-25 19:03:44,922 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-25 19:03:44,923 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-25 19:03:44,924 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-25 19:03:44,924 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-25 19:03:44,924 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-25 19:03:44,924 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers([('date', 'Fri, 25 Oct 2024 18:03:44 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-allow-origin', '*'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-model', 'text-embedding-ada-002'), ('openai-organization', 'uinside'), ('openai-processing-ms', '84'), ('openai-version', '2020-10-01'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '5000000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '4999750'), ('x-ratelimit-reset-requests', '6ms'), ('x-ratelimit-reset-tokens', '3ms'), ('x-request-id', 'req_0803e4e2a6200c978ca30ed5ee5abc02'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=PdcCBOvhVxu27T5SP2.O3IA59vkFg8L8w3Bu5j0PvaY-1729879424-1.0.1.1-irO6qKSJh1VCt6Vx12n56j1N_GmYoEXWSIVxl4CcCS08FowdFCIeGlSAAAe9FpvuAdB.97a.Ulu8VDuhJUeMBg; path=/; expires=Fri, 25-Oct-24 18:33:44 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=q94hNiE.0bWTEZ.P9a0_MguRTpqueYj.lmwyXq.5i40-1729879424979-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d8420048fb6692c-LIS'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-25 19:03:44,925 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_0803e4e2a6200c978ca30ed5ee5abc02
2024-10-25 19:03:44,926 - root - INFO - openai_service.py:100 - create_embedding - Successfully created embedding of length 1536
2024-10-25 19:03:44,926 - root - INFO - embedding.py:39 - create_embeddings - Finished creating embeddings for 1 chunks
2024-10-25 19:03:44,927 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_various_lengths[AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA-1536] took 0.39 seconds
2024-10-25 19:03:44,929 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.started
2024-10-25 19:03:44,930 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.complete
2024-10-25 19:03:44,934 - root - INFO - embedding.py:27 - create_embeddings - Starting to create embeddings for 2 chunks
2024-10-25 19:03:44,935 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 19:03:44,935 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 19:03:44,950 - root - INFO - openai_service.py:94 - create_embedding - Creating embedding for text: Test chunk 1...
2024-10-25 19:03:44,950 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x1611a0180>, 'json_data': {'input': 'Test chunk 1', 'model': 'text-embedding-ada-002', 'encoding_format': 'base64'}}
2024-10-25 19:03:44,951 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-25 19:03:44,951 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-25 19:03:44,987 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x1611476e0>
2024-10-25 19:03:44,987 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.started ssl_context=<ssl.SSLContext object at 0x16182ad50> server_hostname='api.openai.com' timeout=5.0
2024-10-25 19:03:45,024 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x161147290>
2024-10-25 19:03:45,024 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-25 19:03:45,024 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-25 19:03:45,024 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-25 19:03:45,024 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-25 19:03:45,024 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-25 19:03:45,565 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 25 Oct 2024 18:03:45 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-ada-002'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'305'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999997'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'0s'), (b'x-request-id', b'req_680fbee100683b1c0829b9300fbb47c8'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=9naBAUm1zNsOkmxKW5Pe8IM_bysPXrUi4GiwMZPo6dM-1729879425-1.0.1.1-Q2OG8rmCCdSgLrydj_e5DgNJy52PXxM7ol23hyMTVkXU0YrVzYYYNr04N87l.rUOlAcTXAb0ZfIxcCFLJLYUXg; path=/; expires=Fri, 25-Oct-24 18:33:45 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=a48whuLocM8wIaONf39AaWgakN4GRIwcRPZpTQQx6gk-1729879425627-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d842006f96f6935-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-25 19:03:45,566 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-25 19:03:45,566 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-25 19:03:45,567 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-25 19:03:45,568 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-25 19:03:45,568 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-25 19:03:45,568 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers([('date', 'Fri, 25 Oct 2024 18:03:45 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-allow-origin', '*'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-model', 'text-embedding-ada-002'), ('openai-organization', 'uinside'), ('openai-processing-ms', '305'), ('openai-version', '2020-10-01'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '5000000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '4999997'), ('x-ratelimit-reset-requests', '6ms'), ('x-ratelimit-reset-tokens', '0s'), ('x-request-id', 'req_680fbee100683b1c0829b9300fbb47c8'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=9naBAUm1zNsOkmxKW5Pe8IM_bysPXrUi4GiwMZPo6dM-1729879425-1.0.1.1-Q2OG8rmCCdSgLrydj_e5DgNJy52PXxM7ol23hyMTVkXU0YrVzYYYNr04N87l.rUOlAcTXAb0ZfIxcCFLJLYUXg; path=/; expires=Fri, 25-Oct-24 18:33:45 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=a48whuLocM8wIaONf39AaWgakN4GRIwcRPZpTQQx6gk-1729879425627-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d842006f96f6935-LIS'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-25 19:03:45,568 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_680fbee100683b1c0829b9300fbb47c8
2024-10-25 19:03:45,570 - root - INFO - openai_service.py:100 - create_embedding - Successfully created embedding of length 1536
2024-10-25 19:03:45,570 - root - INFO - openai_service.py:94 - create_embedding - Creating embedding for text: Test chunk 2...
2024-10-25 19:03:45,571 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x1611a3b00>, 'json_data': {'input': 'Test chunk 2', 'model': 'text-embedding-ada-002', 'encoding_format': 'base64'}}
2024-10-25 19:03:45,571 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-25 19:03:45,572 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-25 19:03:45,572 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-25 19:03:45,572 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-25 19:03:45,572 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-25 19:03:45,572 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-25 19:03:45,954 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 25 Oct 2024 18:03:45 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-ada-002'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'58'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999997'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'0s'), (b'x-request-id', b'req_8c39f7170beff9539cbcb162e90da685'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d84200a6dfd6935-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-25 19:03:45,955 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-25 19:03:45,956 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-25 19:03:45,957 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-25 19:03:45,957 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-25 19:03:45,957 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-25 19:03:45,957 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers({'date': 'Fri, 25 Oct 2024 18:03:45 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-allow-origin': '*', 'access-control-expose-headers': 'X-Request-ID', 'openai-model': 'text-embedding-ada-002', 'openai-organization': 'uinside', 'openai-processing-ms': '58', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '5000000', 'x-ratelimit-remaining-requests': '9999', 'x-ratelimit-remaining-tokens': '4999997', 'x-ratelimit-reset-requests': '6ms', 'x-ratelimit-reset-tokens': '0s', 'x-request-id': 'req_8c39f7170beff9539cbcb162e90da685', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d84200a6dfd6935-LIS', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-25 19:03:45,957 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_8c39f7170beff9539cbcb162e90da685
2024-10-25 19:03:45,958 - root - INFO - openai_service.py:100 - create_embedding - Successfully created embedding of length 1536
2024-10-25 19:03:45,958 - root - INFO - embedding.py:39 - create_embeddings - Finished creating embeddings for 2 chunks
2024-10-25 19:03:45,963 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.started
2024-10-25 19:03:45,963 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.complete
2024-10-25 19:03:45,968 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_with_cache took 1.04 seconds
2024-10-25 19:03:45,970 - root - INFO - file_processor.py:15 - process_file - Processing file: /Users/eduardizgorodin/Projects/rag_book_assistant/tests/data/test.pdf with extension: .pdf
2024-10-25 19:03:45,970 - root - INFO - file_processor.py:26 - process_file - Using processor for extension: .pdf
2024-10-25 19:03:45,973 - root - INFO - conftest.py:58 - timer - Test test_process_pdf took 0.00 seconds
2024-10-25 19:03:45,974 - root - INFO - file_processor.py:15 - process_file - Processing file: /Users/eduardizgorodin/Projects/rag_book_assistant/tests/data/test.docx with extension: .docx
2024-10-25 19:03:45,975 - root - INFO - file_processor.py:26 - process_file - Using processor for extension: .docx
2024-10-25 19:03:45,991 - root - INFO - conftest.py:58 - timer - Test test_process_docx took 0.02 seconds
2024-10-25 19:03:45,992 - root - INFO - file_processor.py:15 - process_file - Processing file: /Users/eduardizgorodin/Projects/rag_book_assistant/tests/data/test.odt with extension: .odt
2024-10-25 19:03:45,992 - root - INFO - file_processor.py:26 - process_file - Using processor for extension: .odt
2024-10-25 19:03:45,996 - root - INFO - conftest.py:58 - timer - Test test_process_odt took 0.00 seconds
2024-10-25 19:03:45,997 - root - INFO - file_processor.py:15 - process_file - Processing file: /Users/eduardizgorodin/Projects/rag_book_assistant/tests/data/test.txt with extension: .txt
2024-10-25 19:03:45,997 - root - INFO - file_processor.py:26 - process_file - Using processor for extension: .txt
2024-10-25 19:03:45,997 - root - INFO - conftest.py:58 - timer - Test test_process_txt took 0.00 seconds
2024-10-25 19:03:46,001 - root - INFO - file_processor.py:15 - process_file - Processing file: /private/var/folders/dd/70xsqyd921gd18src4pk119r0000gn/T/pytest-of-eduardizgorodin/pytest-13/test_unsupported_file_format0/test.unsupported with extension: .unsupported
2024-10-25 19:03:46,001 - root - ERROR - file_processor.py:29 - process_file - Unsupported file format: .unsupported
2024-10-25 19:03:46,001 - root - INFO - conftest.py:58 - timer - Test test_unsupported_file_format took 0.00 seconds
2024-10-25 19:03:46,003 - root - INFO - text_processing.py:96 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-25 19:03:46,021 - root - INFO - conftest.py:58 - timer - Test test_imports took 0.01 seconds
2024-10-25 19:03:46,022 - root - INFO - conftest.py:58 - timer - Test test_config_import took 0.00 seconds
2024-10-25 19:03:46,024 - root - INFO - conftest.py:58 - timer - Test test_openai_api_key took 0.00 seconds
2024-10-25 19:03:46,024 - root - INFO - text_processing.py:76 - load_and_preprocess_text - Preprocessing text content
2024-10-25 19:03:46,081 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.started
2024-10-25 19:03:46,081 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.complete
2024-10-25 19:03:46,305 - root - INFO - text_processing.py:82 - load_and_preprocess_text - Extracted 0 dates, 0 named entities, and 1 key phrases from the text
2024-10-25 19:03:46,305 - root - INFO - text_processing.py:96 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-25 20:16:59,903 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 20:16:59,903 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 20:16:59,910 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 20:16:59,910 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 20:16:59,918 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 20:17:00,865 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 20:17:00,868 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 20:17:01,285 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 20:17:01,285 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 20:17:01,508 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 20:18:24,660 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 20:18:24,662 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 20:18:24,668 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 20:18:24,668 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 20:18:24,672 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 20:18:24,995 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 20:18:24,996 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 20:18:27,194 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 20:18:27,195 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 20:18:27,497 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 20:18:27,503 - main.log - INFO - main.py:8 - main - Starting the RAG Book Assistant
2024-10-25 20:18:53,904 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 20:18:53,905 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 20:18:53,911 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 20:18:53,911 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 20:18:53,915 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 20:18:54,679 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 20:18:54,681 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 20:18:57,196 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 20:18:57,197 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 20:18:57,564 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 20:18:57,571 - main.log - INFO - main.py:8 - main - Starting the RAG Book Assistant
2024-10-25 20:19:13,160 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 20:19:13,161 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 20:19:13,167 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 20:19:13,167 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 20:19:13,170 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 20:19:13,653 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 20:19:13,654 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 20:19:13,991 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 20:19:13,992 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 20:19:14,227 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 20:19:14,232 - main.log - INFO - main.py:8 - main - Starting the RAG Book Assistant
2024-10-25 20:19:14,233 - root - INFO - cli.py:79 - run_cli - Starting the RAG system
2024-10-25 20:19:14,234 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 20:19:14,234 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 20:19:32,060 - root - INFO - cli.py:88 - run_cli - Loading book from: tests/data/ford.txt
2024-10-25 20:19:32,063 - root - INFO - cli.py:91 - run_cli - File content loaded: 178970 characters
2024-10-25 20:19:32,063 - root - INFO - cli.py:31 - load_and_process_book - Starting to process book content
2024-10-25 20:19:32,064 - root - INFO - text_processing.py:76 - load_and_preprocess_text - Preprocessing text content
2024-10-25 20:19:36,111 - root - INFO - text_processing.py:82 - load_and_preprocess_text - Extracted 10 dates, 1436 named entities, and 5 key phrases from the text
2024-10-25 20:19:36,111 - root - INFO - text_processing.py:96 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-25 21:04:48,749 - root - INFO - file_processor.py:36 - process_file - Processing file: /Users/eduardizgorodin/Projects/rag_book_assistant/tests/data/test.pdf with extension: .pdf
2024-10-25 21:04:48,749 - root - INFO - file_processor.py:47 - process_file - Using processor for extension: .pdf
2024-10-25 21:04:48,750 - root - INFO - conftest.py:58 - timer - Test test_process_pdf took 0.00 seconds
2024-10-25 21:04:48,750 - root - INFO - file_processor.py:36 - process_file - Processing file: /Users/eduardizgorodin/Projects/rag_book_assistant/tests/data/test.docx with extension: .docx
2024-10-25 21:04:48,751 - root - INFO - file_processor.py:47 - process_file - Using processor for extension: .docx
2024-10-25 21:04:48,758 - root - INFO - conftest.py:58 - timer - Test test_process_docx took 0.01 seconds
2024-10-25 21:04:48,759 - root - INFO - file_processor.py:36 - process_file - Processing file: /Users/eduardizgorodin/Projects/rag_book_assistant/tests/data/test.odt with extension: .odt
2024-10-25 21:04:48,759 - root - INFO - file_processor.py:47 - process_file - Using processor for extension: .odt
2024-10-25 21:04:48,760 - root - INFO - conftest.py:58 - timer - Test test_process_odt took 0.00 seconds
2024-10-25 21:04:48,761 - root - INFO - file_processor.py:36 - process_file - Processing file: /Users/eduardizgorodin/Projects/rag_book_assistant/tests/data/test.txt with extension: .txt
2024-10-25 21:04:48,761 - root - INFO - file_processor.py:47 - process_file - Using processor for extension: .txt
2024-10-25 21:04:48,761 - root - INFO - conftest.py:58 - timer - Test test_process_txt took 0.00 seconds
2024-10-25 21:04:48,763 - root - INFO - file_processor.py:36 - process_file - Processing file: /private/var/folders/dd/70xsqyd921gd18src4pk119r0000gn/T/pytest-of-eduardizgorodin/pytest-14/test_unsupported_file_format0/test.unsupported with extension: .unsupported
2024-10-25 21:04:48,763 - root - ERROR - file_processor.py:50 - process_file - Unsupported file format: .unsupported
2024-10-25 21:04:48,763 - root - ERROR - error_handler.py:65 - wrapper - RAG Error in process_file: Unsupported file format: .unsupported
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 63, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/file_processor.py", line 51, in process_file
    raise DataSourceError(f"Unsupported file format: {extension}")
src.error_handler.DataSourceError: Unsupported file format: .unsupported
2024-10-25 21:04:48,801 - root - INFO - conftest.py:58 - timer - Test test_unsupported_file_format took 0.04 seconds
2024-10-26 00:40:00,726 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-26 00:40:00,730 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-26 00:40:00,739 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-26 00:40:00,739 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-26 00:40:00,747 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-26 00:40:01,964 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-26 00:40:01,966 - root - INFO - pinecone_manager.py:107 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-26 00:40:03,021 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-26 00:40:03,022 - root - INFO - pinecone_manager.py:121 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-26 00:40:03,435 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-26 00:41:03,515 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-26 00:41:03,516 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-26 00:41:03,522 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-26 00:41:03,522 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-26 00:41:03,529 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-26 00:41:04,020 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-26 00:41:04,022 - root - INFO - pinecone_manager.py:107 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-26 00:41:04,286 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-26 00:41:04,286 - root - INFO - pinecone_manager.py:121 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-26 00:41:04,484 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-26 00:42:24,282 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-26 00:42:24,283 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-26 00:42:24,290 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-26 00:42:24,290 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-26 00:42:24,298 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-26 00:42:24,717 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-26 00:42:24,719 - root - INFO - pinecone_manager.py:107 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-26 00:42:25,029 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-26 00:42:25,029 - root - INFO - pinecone_manager.py:121 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-26 00:42:25,234 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-26 00:48:52,084 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-26 00:48:52,085 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-26 00:48:52,092 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-26 00:48:52,092 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-26 00:48:52,098 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-26 00:48:52,820 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-26 00:48:52,821 - root - INFO - pinecone_manager.py:107 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-26 00:48:53,884 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-26 00:48:53,885 - root - INFO - pinecone_manager.py:121 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-26 00:48:54,395 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-26 00:48:54,406 - main.log - INFO - main.py:8 - main - Starting the RAG Book Assistant
2024-10-26 00:48:54,407 - root - INFO - cli.py:79 - run_cli - Starting the RAG system
2024-10-26 00:48:54,407 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-26 00:48:54,408 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-26 00:49:05,360 - root - INFO - cli.py:88 - run_cli - Loading book from: tests/data/test_book.txt
2024-10-26 00:49:05,362 - root - INFO - cli.py:91 - run_cli - File content loaded: 108 characters
2024-10-26 00:49:05,362 - root - INFO - cli.py:31 - load_and_process_book - Starting to process book content
2024-10-26 00:49:05,363 - root - INFO - text_processing.py:137 - load_and_preprocess_text - Preprocessing text content
2024-10-26 00:49:05,648 - root - INFO - text_processing.py:143 - load_and_preprocess_text - Extracted 0 dates, 0 named entities, and 5 key phrases from the text
2024-10-26 00:49:05,648 - root - INFO - text_processing.py:168 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-26 09:53:19,664 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-26 09:53:19,668 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-26 09:56:24,261 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-26 09:56:24,262 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-26 09:56:24,269 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-26 09:56:24,269 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-26 09:56:24,277 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-26 09:56:24,741 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-26 09:56:24,744 - root - INFO - pinecone_manager.py:117 - _initialize - Creating new Pinecone index for book default_book_index: book-default_book_index
2024-10-26 09:56:24,952 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"INVALID_ARGUMENT","message":"Name must consist of lower case alphanumeric characters or \'-\'"},"status":400}'
2024-10-26 09:56:24,952 - root - ERROR - pinecone_manager.py:130 - _initialize - Error initializing Pinecone index for book default_book_index: (400)
Reason: Bad Request
HTTP response headers: HTTPHeaderDict({'content-type': 'text/plain; charset=utf-8', 'access-control-allow-origin': '*', 'vary': 'origin,access-control-request-method,access-control-request-headers', 'access-control-expose-headers': '*', 'x-pinecone-api-version': '2024-07', 'X-Cloud-Trace-Context': 'f00f10e48f056360b7b61e5ef9057398', 'Date': 'Sat, 26 Oct 2024 08:56:24 GMT', 'Server': 'Google Frontend', 'Content-Length': '125', 'Via': '1.1 google', 'Alt-Svc': 'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000'})
HTTP response body: {"error":{"code":"INVALID_ARGUMENT","message":"Name must consist of lower case alphanumeric characters or '-'"},"status":400}

2024-10-26 09:56:26,186 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-26 09:56:26,188 - root - INFO - pinecone_manager.py:117 - _initialize - Creating new Pinecone index for book default_book_index: book-default_book_index
2024-10-26 09:56:26,420 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"INVALID_ARGUMENT","message":"Name must consist of lower case alphanumeric characters or \'-\'"},"status":400}'
2024-10-26 09:56:26,420 - root - ERROR - pinecone_manager.py:130 - _initialize - Error initializing Pinecone index for book default_book_index: (400)
Reason: Bad Request
HTTP response headers: HTTPHeaderDict({'content-type': 'text/plain; charset=utf-8', 'access-control-allow-origin': '*', 'vary': 'origin,access-control-request-method,access-control-request-headers', 'access-control-expose-headers': '*', 'x-pinecone-api-version': '2024-07', 'X-Cloud-Trace-Context': '75500c3accdb68cd4cfa08c60407e89a', 'Date': 'Sat, 26 Oct 2024 08:56:26 GMT', 'Server': 'Google Frontend', 'Content-Length': '125', 'Via': '1.1 google', 'Alt-Svc': 'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000'})
HTTP response body: {"error":{"code":"INVALID_ARGUMENT","message":"Name must consist of lower case alphanumeric characters or '-'"},"status":400}

2024-10-26 09:56:28,625 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-26 09:56:28,627 - root - INFO - pinecone_manager.py:117 - _initialize - Creating new Pinecone index for book default_book_index: book-default_book_index
2024-10-26 09:56:28,814 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"INVALID_ARGUMENT","message":"Name must consist of lower case alphanumeric characters or \'-\'"},"status":400}'
2024-10-26 09:56:28,815 - root - ERROR - pinecone_manager.py:130 - _initialize - Error initializing Pinecone index for book default_book_index: (400)
Reason: Bad Request
HTTP response headers: HTTPHeaderDict({'content-type': 'text/plain; charset=utf-8', 'access-control-allow-origin': '*', 'vary': 'origin,access-control-request-method,access-control-request-headers', 'access-control-expose-headers': '*', 'x-pinecone-api-version': '2024-07', 'X-Cloud-Trace-Context': '6373abc6a3842776808aa1cfc3773b58', 'Date': 'Sat, 26 Oct 2024 08:56:28 GMT', 'Server': 'Google Frontend', 'Content-Length': '125', 'Via': '1.1 google', 'Alt-Svc': 'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000'})
HTTP response body: {"error":{"code":"INVALID_ARGUMENT","message":"Name must consist of lower case alphanumeric characters or '-'"},"status":400}

2024-10-26 09:56:28,815 - root - ERROR - error_handler.py:65 - wrapper - RAG Error in _initialize_index: Failed to initialize Pinecone index: (400)
Reason: Bad Request
HTTP response headers: HTTPHeaderDict({'content-type': 'text/plain; charset=utf-8', 'access-control-allow-origin': '*', 'vary': 'origin,access-control-request-method,access-control-request-headers', 'access-control-expose-headers': '*', 'x-pinecone-api-version': '2024-07', 'X-Cloud-Trace-Context': '6373abc6a3842776808aa1cfc3773b58', 'Date': 'Sat, 26 Oct 2024 08:56:28 GMT', 'Server': 'Google Frontend', 'Content-Length': '125', 'Via': '1.1 google', 'Alt-Svc': 'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000'})
HTTP response body: {"error":{"code":"INVALID_ARGUMENT","message":"Name must consist of lower case alphanumeric characters or '-'"},"status":400}
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/pinecone_manager.py", line 118, in _initialize
    self.pc.create_index(
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone/control/pinecone.py", line 384, in create_index
    api_instance.create_index(
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone/core/openapi/shared/api_client.py", line 761, in __call__
    return self.callable(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone/core/openapi/control/api/manage_indexes_api.py", line 273, in __create_index
    return self.call_with_http_info(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone/core/openapi/shared/api_client.py", line 819, in call_with_http_info
    return self.api_client.call_api(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone/core/openapi/shared/api_client.py", line 380, in call_api
    return self.__call_api(
           ^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone/core/openapi/shared/api_client.py", line 187, in __call_api
    raise e
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone/core/openapi/shared/api_client.py", line 175, in __call_api
    response_data = self.request(
                    ^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone/core/openapi/shared/api_client.py", line 460, in request
    return self.rest_client.POST(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone/core/openapi/shared/rest.py", line 345, in POST
    return self.request(
           ^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone/core/openapi/shared/rest.py", line 279, in request
    raise PineconeApiException(http_resp=r)
pinecone.core.openapi.shared.exceptions.PineconeApiException: (400)
Reason: Bad Request
HTTP response headers: HTTPHeaderDict({'content-type': 'text/plain; charset=utf-8', 'access-control-allow-origin': '*', 'vary': 'origin,access-control-request-method,access-control-request-headers', 'access-control-expose-headers': '*', 'x-pinecone-api-version': '2024-07', 'X-Cloud-Trace-Context': '6373abc6a3842776808aa1cfc3773b58', 'Date': 'Sat, 26 Oct 2024 08:56:28 GMT', 'Server': 'Google Frontend', 'Content-Length': '125', 'Via': '1.1 google', 'Alt-Svc': 'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000'})
HTTP response body: {"error":{"code":"INVALID_ARGUMENT","message":"Name must consist of lower case alphanumeric characters or '-'"},"status":400}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 63, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/pinecone_manager.py", line 133, in _initialize_index
    _initialize()
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/tenacity/__init__.py", line 336, in wrapped_f
    return copy(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/tenacity/__init__.py", line 475, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/tenacity/__init__.py", line 478, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/pinecone_manager.py", line 131, in _initialize
    raise DataSourceError(f"Failed to initialize Pinecone index: {str(e)}")
src.error_handler.DataSourceError: Failed to initialize Pinecone index: (400)
Reason: Bad Request
HTTP response headers: HTTPHeaderDict({'content-type': 'text/plain; charset=utf-8', 'access-control-allow-origin': '*', 'vary': 'origin,access-control-request-method,access-control-request-headers', 'access-control-expose-headers': '*', 'x-pinecone-api-version': '2024-07', 'X-Cloud-Trace-Context': '6373abc6a3842776808aa1cfc3773b58', 'Date': 'Sat, 26 Oct 2024 08:56:28 GMT', 'Server': 'Google Frontend', 'Content-Length': '125', 'Via': '1.1 google', 'Alt-Svc': 'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000'})
HTTP response body: {"error":{"code":"INVALID_ARGUMENT","message":"Name must consist of lower case alphanumeric characters or '-'"},"status":400}

2024-10-26 09:56:28,822 - root - WARNING - embedding.py:26 - <module> - Pinecone index is not available. Some functionality may be limited.
2024-10-26 09:57:17,415 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-26 09:57:17,416 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-26 09:57:17,422 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-26 09:57:17,423 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-26 09:57:17,426 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-26 09:57:17,749 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-26 09:57:17,750 - root - INFO - pinecone_manager.py:117 - _initialize - Creating new Pinecone index for book default_book_index: book-default_book_index
2024-10-26 09:57:17,973 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"INVALID_ARGUMENT","message":"Name must consist of lower case alphanumeric characters or \'-\'"},"status":400}'
2024-10-26 09:57:17,974 - root - ERROR - pinecone_manager.py:130 - _initialize - Error initializing Pinecone index for book default_book_index: (400)
Reason: Bad Request
HTTP response headers: HTTPHeaderDict({'content-type': 'text/plain; charset=utf-8', 'access-control-allow-origin': '*', 'vary': 'origin,access-control-request-method,access-control-request-headers', 'access-control-expose-headers': '*', 'x-pinecone-api-version': '2024-07', 'X-Cloud-Trace-Context': '1ceedf8ad8be265c49d26129cb4fb4a7', 'Date': 'Sat, 26 Oct 2024 08:57:18 GMT', 'Server': 'Google Frontend', 'Content-Length': '125', 'Via': '1.1 google', 'Alt-Svc': 'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000'})
HTTP response body: {"error":{"code":"INVALID_ARGUMENT","message":"Name must consist of lower case alphanumeric characters or '-'"},"status":400}

2024-10-26 09:57:19,191 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-26 09:57:19,193 - root - INFO - pinecone_manager.py:117 - _initialize - Creating new Pinecone index for book default_book_index: book-default_book_index
2024-10-26 09:57:19,369 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"INVALID_ARGUMENT","message":"Name must consist of lower case alphanumeric characters or \'-\'"},"status":400}'
2024-10-26 09:57:19,369 - root - ERROR - pinecone_manager.py:130 - _initialize - Error initializing Pinecone index for book default_book_index: (400)
Reason: Bad Request
HTTP response headers: HTTPHeaderDict({'content-type': 'text/plain; charset=utf-8', 'access-control-allow-origin': '*', 'vary': 'origin,access-control-request-method,access-control-request-headers', 'access-control-expose-headers': '*', 'x-pinecone-api-version': '2024-07', 'X-Cloud-Trace-Context': '95d9e577e64707f53d7f63d448c10e54', 'Date': 'Sat, 26 Oct 2024 08:57:19 GMT', 'Server': 'Google Frontend', 'Content-Length': '125', 'Via': '1.1 google', 'Alt-Svc': 'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000'})
HTTP response body: {"error":{"code":"INVALID_ARGUMENT","message":"Name must consist of lower case alphanumeric characters or '-'"},"status":400}

2024-10-26 09:57:21,620 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-26 09:57:21,622 - root - INFO - pinecone_manager.py:117 - _initialize - Creating new Pinecone index for book default_book_index: book-default_book_index
2024-10-26 09:57:21,848 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"INVALID_ARGUMENT","message":"Name must consist of lower case alphanumeric characters or \'-\'"},"status":400}'
2024-10-26 09:57:21,849 - root - ERROR - pinecone_manager.py:130 - _initialize - Error initializing Pinecone index for book default_book_index: (400)
Reason: Bad Request
HTTP response headers: HTTPHeaderDict({'content-type': 'text/plain; charset=utf-8', 'access-control-allow-origin': '*', 'vary': 'origin,access-control-request-method,access-control-request-headers', 'access-control-expose-headers': '*', 'x-pinecone-api-version': '2024-07', 'X-Cloud-Trace-Context': '36dc372a3b8c5b5c6750f7da81ed59ac', 'Date': 'Sat, 26 Oct 2024 08:57:21 GMT', 'Server': 'Google Frontend', 'Content-Length': '125', 'Via': '1.1 google', 'Alt-Svc': 'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000'})
HTTP response body: {"error":{"code":"INVALID_ARGUMENT","message":"Name must consist of lower case alphanumeric characters or '-'"},"status":400}

2024-10-26 09:57:21,849 - root - ERROR - error_handler.py:65 - wrapper - RAG Error in _initialize_index: Failed to initialize Pinecone index: (400)
Reason: Bad Request
HTTP response headers: HTTPHeaderDict({'content-type': 'text/plain; charset=utf-8', 'access-control-allow-origin': '*', 'vary': 'origin,access-control-request-method,access-control-request-headers', 'access-control-expose-headers': '*', 'x-pinecone-api-version': '2024-07', 'X-Cloud-Trace-Context': '36dc372a3b8c5b5c6750f7da81ed59ac', 'Date': 'Sat, 26 Oct 2024 08:57:21 GMT', 'Server': 'Google Frontend', 'Content-Length': '125', 'Via': '1.1 google', 'Alt-Svc': 'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000'})
HTTP response body: {"error":{"code":"INVALID_ARGUMENT","message":"Name must consist of lower case alphanumeric characters or '-'"},"status":400}
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/pinecone_manager.py", line 118, in _initialize
    self.pc.create_index(
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone/control/pinecone.py", line 384, in create_index
    api_instance.create_index(
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone/core/openapi/shared/api_client.py", line 761, in __call__
    return self.callable(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone/core/openapi/control/api/manage_indexes_api.py", line 273, in __create_index
    return self.call_with_http_info(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone/core/openapi/shared/api_client.py", line 819, in call_with_http_info
    return self.api_client.call_api(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone/core/openapi/shared/api_client.py", line 380, in call_api
    return self.__call_api(
           ^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone/core/openapi/shared/api_client.py", line 187, in __call_api
    raise e
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone/core/openapi/shared/api_client.py", line 175, in __call_api
    response_data = self.request(
                    ^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone/core/openapi/shared/api_client.py", line 460, in request
    return self.rest_client.POST(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone/core/openapi/shared/rest.py", line 345, in POST
    return self.request(
           ^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone/core/openapi/shared/rest.py", line 279, in request
    raise PineconeApiException(http_resp=r)
pinecone.core.openapi.shared.exceptions.PineconeApiException: (400)
Reason: Bad Request
HTTP response headers: HTTPHeaderDict({'content-type': 'text/plain; charset=utf-8', 'access-control-allow-origin': '*', 'vary': 'origin,access-control-request-method,access-control-request-headers', 'access-control-expose-headers': '*', 'x-pinecone-api-version': '2024-07', 'X-Cloud-Trace-Context': '36dc372a3b8c5b5c6750f7da81ed59ac', 'Date': 'Sat, 26 Oct 2024 08:57:21 GMT', 'Server': 'Google Frontend', 'Content-Length': '125', 'Via': '1.1 google', 'Alt-Svc': 'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000'})
HTTP response body: {"error":{"code":"INVALID_ARGUMENT","message":"Name must consist of lower case alphanumeric characters or '-'"},"status":400}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 63, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/pinecone_manager.py", line 133, in _initialize_index
    _initialize()
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/tenacity/__init__.py", line 336, in wrapped_f
    return copy(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/tenacity/__init__.py", line 475, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/tenacity/__init__.py", line 478, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/pinecone_manager.py", line 131, in _initialize
    raise DataSourceError(f"Failed to initialize Pinecone index: {str(e)}")
src.error_handler.DataSourceError: Failed to initialize Pinecone index: (400)
Reason: Bad Request
HTTP response headers: HTTPHeaderDict({'content-type': 'text/plain; charset=utf-8', 'access-control-allow-origin': '*', 'vary': 'origin,access-control-request-method,access-control-request-headers', 'access-control-expose-headers': '*', 'x-pinecone-api-version': '2024-07', 'X-Cloud-Trace-Context': '36dc372a3b8c5b5c6750f7da81ed59ac', 'Date': 'Sat, 26 Oct 2024 08:57:21 GMT', 'Server': 'Google Frontend', 'Content-Length': '125', 'Via': '1.1 google', 'Alt-Svc': 'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000'})
HTTP response body: {"error":{"code":"INVALID_ARGUMENT","message":"Name must consist of lower case alphanumeric characters or '-'"},"status":400}

2024-10-26 09:57:21,856 - root - WARNING - embedding.py:26 - <module> - Pinecone index is not available. Some functionality may be limited.
2024-10-26 09:57:21,862 - main.log - INFO - main.py:8 - main - Starting the RAG Book Assistant
2024-10-26 09:57:21,863 - root - INFO - cli.py:80 - run_cli - Starting the RAG system
2024-10-26 09:57:21,863 - root - ERROR - cli.py:111 - run_cli - An unexpected error occurred: OpenAIService.__init__() missing 1 required positional argument: 'api_key'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/cli.py", line 83, in run_cli
    openai_service = OpenAIService()
                     ^^^^^^^^^^^^^^^
TypeError: OpenAIService.__init__() missing 1 required positional argument: 'api_key'
2024-10-26 09:57:21,864 - root - INFO - cli.py:114 - run_cli - Exiting the RAG system
2024-10-26 09:59:37,874 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-26 09:59:37,875 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-26 09:59:37,882 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-26 09:59:37,882 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-26 09:59:37,890 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-26 09:59:38,176 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-26 09:59:38,179 - root - INFO - pinecone_manager.py:119 - _initialize - Creating new Pinecone index for book default_book_index: book-defaultbookindex
2024-10-26 09:59:38,589 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-defaultbookindex","metric":"cosine","dimension":1536,"status":{"ready":false,"state":"Initializing"},"host":"book-defaultbookindex-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-26 09:59:38,803 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-defaultbookindex","metric":"cosine","dimension":1536,"status":{"ready":false,"state":"Initializing"},"host":"book-defaultbookindex-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-26 09:59:44,016 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-defaultbookindex","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-defaultbookindex-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-26 09:59:44,228 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-defaultbookindex","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-defaultbookindex-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-26 09:59:44,231 - root - INFO - pinecone_manager.py:130 - _initialize - Successfully initialized Pinecone index for book default_book_index
2024-10-26 09:59:44,240 - main.log - INFO - main.py:8 - main - Starting the RAG Book Assistant
2024-10-26 09:59:44,241 - root - INFO - cli.py:80 - run_cli - Starting the RAG system
2024-10-26 09:59:44,241 - root - ERROR - cli.py:111 - run_cli - An unexpected error occurred: OpenAIService.__init__() missing 1 required positional argument: 'api_key'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/cli.py", line 83, in run_cli
    openai_service = OpenAIService()
                     ^^^^^^^^^^^^^^^
TypeError: OpenAIService.__init__() missing 1 required positional argument: 'api_key'
2024-10-26 09:59:44,242 - root - INFO - cli.py:114 - run_cli - Exiting the RAG system
2024-10-26 10:01:44,359 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-26 10:01:44,360 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-26 10:01:44,366 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-26 10:01:44,367 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-26 10:01:44,375 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-26 10:01:44,747 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"},{"name":"book-defaultbookindex","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-defaultbookindex-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-26 10:01:44,750 - root - INFO - pinecone_manager.py:119 - _initialize - Creating new Pinecone index for book default_book_index: book-defaultbookindex
2024-10-26 10:01:45,157 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-26 10:01:45,157 - root - ERROR - pinecone_manager.py:132 - _initialize - Error initializing Pinecone index for book default_book_index: (409)
Reason: Conflict
HTTP response headers: HTTPHeaderDict({'content-type': 'text/plain; charset=utf-8', 'access-control-allow-origin': '*', 'vary': 'origin,access-control-request-method,access-control-request-headers', 'access-control-expose-headers': '*', 'x-pinecone-api-version': '2024-07', 'X-Cloud-Trace-Context': 'ce84169e4b5c6f1b506b1b63fa9a6b9d', 'Date': 'Sat, 26 Oct 2024 09:01:45 GMT', 'Server': 'Google Frontend', 'Content-Length': '85', 'Via': '1.1 google', 'Alt-Svc': 'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000'})
HTTP response body: {"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}

2024-10-26 10:01:46,386 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"},{"name":"book-defaultbookindex","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-defaultbookindex-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-26 10:01:46,388 - root - INFO - pinecone_manager.py:119 - _initialize - Creating new Pinecone index for book default_book_index: book-defaultbookindex
2024-10-26 10:01:46,693 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-26 10:01:46,694 - root - ERROR - pinecone_manager.py:132 - _initialize - Error initializing Pinecone index for book default_book_index: (409)
Reason: Conflict
HTTP response headers: HTTPHeaderDict({'content-type': 'text/plain; charset=utf-8', 'access-control-allow-origin': '*', 'vary': 'origin,access-control-request-method,access-control-request-headers', 'access-control-expose-headers': '*', 'x-pinecone-api-version': '2024-07', 'X-Cloud-Trace-Context': 'be914bdae3f4887efdd3cdd24ae5a7da', 'Date': 'Sat, 26 Oct 2024 09:01:46 GMT', 'Server': 'Google Frontend', 'Content-Length': '85', 'Via': '1.1 google', 'Alt-Svc': 'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000'})
HTTP response body: {"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}

2024-10-26 10:01:48,902 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"},{"name":"book-defaultbookindex","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-defaultbookindex-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-26 10:01:48,903 - root - INFO - pinecone_manager.py:119 - _initialize - Creating new Pinecone index for book default_book_index: book-defaultbookindex
2024-10-26 10:01:49,321 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-26 10:01:49,321 - root - ERROR - pinecone_manager.py:132 - _initialize - Error initializing Pinecone index for book default_book_index: (409)
Reason: Conflict
HTTP response headers: HTTPHeaderDict({'content-type': 'text/plain; charset=utf-8', 'access-control-allow-origin': '*', 'vary': 'origin,access-control-request-method,access-control-request-headers', 'access-control-expose-headers': '*', 'x-pinecone-api-version': '2024-07', 'X-Cloud-Trace-Context': '534009a104193cc98d474c2a84580886', 'Date': 'Sat, 26 Oct 2024 09:01:49 GMT', 'Server': 'Google Frontend', 'Content-Length': '85', 'Via': '1.1 google', 'Alt-Svc': 'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000'})
HTTP response body: {"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}

2024-10-26 10:01:49,322 - root - ERROR - error_handler.py:65 - wrapper - RAG Error in _initialize_index: Failed to initialize Pinecone index: (409)
Reason: Conflict
HTTP response headers: HTTPHeaderDict({'content-type': 'text/plain; charset=utf-8', 'access-control-allow-origin': '*', 'vary': 'origin,access-control-request-method,access-control-request-headers', 'access-control-expose-headers': '*', 'x-pinecone-api-version': '2024-07', 'X-Cloud-Trace-Context': '534009a104193cc98d474c2a84580886', 'Date': 'Sat, 26 Oct 2024 09:01:49 GMT', 'Server': 'Google Frontend', 'Content-Length': '85', 'Via': '1.1 google', 'Alt-Svc': 'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000'})
HTTP response body: {"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/pinecone_manager.py", line 120, in _initialize
    self.pc.create_index(
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone/control/pinecone.py", line 384, in create_index
    api_instance.create_index(
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone/core/openapi/shared/api_client.py", line 761, in __call__
    return self.callable(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone/core/openapi/control/api/manage_indexes_api.py", line 273, in __create_index
    return self.call_with_http_info(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone/core/openapi/shared/api_client.py", line 819, in call_with_http_info
    return self.api_client.call_api(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone/core/openapi/shared/api_client.py", line 380, in call_api
    return self.__call_api(
           ^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone/core/openapi/shared/api_client.py", line 187, in __call_api
    raise e
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone/core/openapi/shared/api_client.py", line 175, in __call_api
    response_data = self.request(
                    ^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone/core/openapi/shared/api_client.py", line 460, in request
    return self.rest_client.POST(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone/core/openapi/shared/rest.py", line 345, in POST
    return self.request(
           ^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone/core/openapi/shared/rest.py", line 279, in request
    raise PineconeApiException(http_resp=r)
pinecone.core.openapi.shared.exceptions.PineconeApiException: (409)
Reason: Conflict
HTTP response headers: HTTPHeaderDict({'content-type': 'text/plain; charset=utf-8', 'access-control-allow-origin': '*', 'vary': 'origin,access-control-request-method,access-control-request-headers', 'access-control-expose-headers': '*', 'x-pinecone-api-version': '2024-07', 'X-Cloud-Trace-Context': '534009a104193cc98d474c2a84580886', 'Date': 'Sat, 26 Oct 2024 09:01:49 GMT', 'Server': 'Google Frontend', 'Content-Length': '85', 'Via': '1.1 google', 'Alt-Svc': 'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000'})
HTTP response body: {"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 63, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/pinecone_manager.py", line 135, in _initialize_index
    _initialize()
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/tenacity/__init__.py", line 336, in wrapped_f
    return copy(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/tenacity/__init__.py", line 475, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/tenacity/__init__.py", line 478, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/pinecone_manager.py", line 133, in _initialize
    raise DataSourceError(f"Failed to initialize Pinecone index: {str(e)}")
src.error_handler.DataSourceError: Failed to initialize Pinecone index: (409)
Reason: Conflict
HTTP response headers: HTTPHeaderDict({'content-type': 'text/plain; charset=utf-8', 'access-control-allow-origin': '*', 'vary': 'origin,access-control-request-method,access-control-request-headers', 'access-control-expose-headers': '*', 'x-pinecone-api-version': '2024-07', 'X-Cloud-Trace-Context': '534009a104193cc98d474c2a84580886', 'Date': 'Sat, 26 Oct 2024 09:01:49 GMT', 'Server': 'Google Frontend', 'Content-Length': '85', 'Via': '1.1 google', 'Alt-Svc': 'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000'})
HTTP response body: {"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}

2024-10-26 10:01:49,332 - root - WARNING - embedding.py:26 - <module> - Pinecone index is not available. Some functionality may be limited.
2024-10-26 10:01:49,336 - main.log - INFO - main.py:8 - main - Starting the RAG Book Assistant
2024-10-26 10:01:49,337 - root - INFO - cli.py:80 - run_cli - Starting the RAG system
2024-10-26 10:01:49,338 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-26 10:01:49,339 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-26 10:05:13,086 - root - INFO - cli.py:89 - run_cli - Loading book from: tests/data/ford.txt
2024-10-26 10:05:13,089 - root - INFO - cli.py:92 - run_cli - File content loaded: 178970 characters
2024-10-26 10:05:13,089 - root - INFO - cli.py:32 - load_and_process_book - Starting to process book content
2024-10-26 10:05:13,089 - root - INFO - text_processing.py:137 - load_and_preprocess_text - Preprocessing text content
2024-10-26 10:05:17,061 - root - INFO - text_processing.py:143 - load_and_preprocess_text - Extracted 10 dates, 1436 named entities, and 5 key phrases from the text
2024-10-26 10:05:17,061 - root - INFO - text_processing.py:168 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-26 10:07:55,276 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-26 10:07:55,277 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-26 10:07:55,284 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-26 10:07:55,284 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-26 10:07:55,291 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-26 10:07:55,706 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"},{"name":"book-defaultbookindex","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-defaultbookindex-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-26 10:07:55,709 - root - WARNING - embedding.py:26 - <module> - Pinecone index is not available. Some functionality may be limited.
2024-10-26 10:07:55,715 - main.log - INFO - main.py:8 - main - Starting the RAG Book Assistant
2024-10-26 10:07:55,717 - root - INFO - cli.py:69 - run_cli - Starting the RAG system
2024-10-26 10:07:55,718 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-26 10:07:55,719 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-26 10:08:14,116 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-26 10:08:14,116 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-26 10:08:14,117 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-26 10:08:14,435 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"},{"name":"book-defaultbookindex","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-defaultbookindex-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-26 10:08:14,437 - root - INFO - cli.py:21 - load_and_process_book - === Starting book processing pipeline ===
2024-10-26 10:08:14,437 - root - INFO - cli.py:23 - load_and_process_book - 1. Preprocessing text...
2024-10-26 10:08:14,438 - root - INFO - text_processing.py:137 - load_and_preprocess_text - Preprocessing text content
2024-10-26 10:08:18,508 - root - INFO - text_processing.py:143 - load_and_preprocess_text - Extracted 10 dates, 1436 named entities, and 5 key phrases from the text
2024-10-26 10:08:18,508 - root - INFO - text_processing.py:168 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-26 10:11:18,903 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-26 10:11:18,904 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-26 10:11:18,911 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-26 10:11:18,911 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-26 10:11:18,920 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-26 10:11:19,234 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"},{"name":"book-defaultbookindex","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-defaultbookindex-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-26 10:11:19,235 - root - WARNING - embedding.py:26 - <module> - Pinecone index is not available. Some functionality may be limited.
2024-10-26 10:11:19,239 - main.log - INFO - main.py:8 - main - Starting the RAG Book Assistant
2024-10-26 10:11:19,240 - root - INFO - cli.py:72 - run_cli - Starting the RAG system
2024-10-26 10:11:19,241 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-26 10:11:19,242 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-26 10:11:37,293 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-26 10:11:37,294 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-26 10:11:37,294 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-26 10:11:37,649 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"},{"name":"book-defaultbookindex","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-defaultbookindex-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-26 10:11:37,651 - root - INFO - cli.py:21 - load_and_process_book - === Starting book processing pipeline ===
2024-10-26 10:11:37,652 - root - INFO - cli.py:23 - load_and_process_book - 1. Preprocessing text...
2024-10-26 10:11:37,652 - root - INFO - text_processing.py:137 - load_and_preprocess_text - Preprocessing text content
2024-10-26 10:11:41,683 - root - INFO - text_processing.py:143 - load_and_preprocess_text - Extracted 10 dates, 1436 named entities, and 5 key phrases from the text
2024-10-26 10:11:41,683 - root - INFO - text_processing.py:168 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-26 15:20:55,555 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-26 15:20:55,559 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-26 15:20:55,566 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-26 15:20:55,567 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-26 15:20:55,575 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-26 15:20:55,977 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"},{"name":"book-defaultbookindex","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-defaultbookindex-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-26 15:20:55,978 - root - WARNING - embedding.py:26 - <module> - Pinecone index is not available. Some functionality may be limited.
2024-10-26 15:20:55,982 - main.log - INFO - main.py:8 - main - Starting the RAG Book Assistant
2024-10-26 15:20:55,983 - root - INFO - cli.py:72 - run_cli - Starting the RAG system
2024-10-26 15:20:55,984 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-26 15:20:55,984 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-26 15:21:13,820 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-26 15:21:13,820 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-26 15:21:13,821 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-26 15:21:14,147 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"},{"name":"book-defaultbookindex","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-defaultbookindex-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-26 15:21:14,148 - root - INFO - cli.py:21 - load_and_process_book - === Starting book processing pipeline ===
2024-10-26 15:21:14,148 - root - INFO - cli.py:23 - load_and_process_book - 1. Preprocessing text...
2024-10-26 15:21:14,148 - root - INFO - text_processing.py:137 - load_and_preprocess_text - Preprocessing text content
2024-10-26 15:21:18,195 - root - INFO - text_processing.py:143 - load_and_preprocess_text - Extracted 10 dates, 1436 named entities, and 5 key phrases from the text
2024-10-26 15:21:18,196 - root - INFO - text_processing.py:168 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-26 15:31:15,988 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-26 15:31:15,991 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-26 15:31:15,999 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-26 15:31:15,999 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-26 15:31:16,007 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-26 15:31:16,414 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"},{"name":"book-defaultbookindex","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-defaultbookindex-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-26 15:31:16,417 - root - WARNING - embedding.py:26 - <module> - Pinecone index is not available. Some functionality may be limited.
2024-10-26 15:31:16,423 - main.log - INFO - main.py:8 - main - Starting the RAG Book Assistant
2024-10-26 15:31:16,424 - root - INFO - cli.py:72 - run_cli - Starting the RAG system
2024-10-26 15:31:16,425 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-26 15:31:16,426 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-26 15:31:32,283 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-26 15:31:32,284 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-26 15:31:32,284 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-26 15:31:32,616 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"},{"name":"book-defaultbookindex","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-defaultbookindex-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-26 15:31:32,618 - root - INFO - cli.py:21 - load_and_process_book - === Starting book processing pipeline ===
2024-10-26 15:31:32,618 - root - INFO - cli.py:23 - load_and_process_book - 1. Preprocessing text...
2024-10-26 15:31:32,619 - root - INFO - text_processing.py:137 - load_and_preprocess_text - Preprocessing text content
2024-10-26 15:31:33,102 - root - INFO - text_processing.py:143 - load_and_preprocess_text - Extracted 0 dates, 64 named entities, and 5 key phrases from the text
2024-10-26 15:31:33,102 - root - INFO - text_processing.py:168 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-26 15:35:52,904 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-26 15:35:52,906 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-26 15:35:52,914 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-26 15:35:52,914 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-26 15:35:52,921 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-26 15:35:54,436 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"},{"name":"book-defaultbookindex","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-defaultbookindex-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-26 15:35:54,437 - root - WARNING - embedding.py:26 - <module> - Pinecone index is not available. Some functionality may be limited.
2024-10-26 15:35:54,441 - main.log - INFO - main.py:8 - main - Starting the RAG Book Assistant
2024-10-26 15:35:54,442 - root - INFO - cli.py:72 - run_cli - Starting the RAG system
2024-10-26 15:35:54,443 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-26 15:35:54,443 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-26 15:37:09,186 - root - ERROR - cli.py:107 - run_cli - An unexpected error occurred: 'utf-8' codec can't decode byte 0x83 in position 11: invalid start byte
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/cli.py", line 82, in run_cli
    text_content = file.read()
                   ^^^^^^^^^^^
  File "<frozen codecs>", line 322, in decode
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 11: invalid start byte
2024-10-26 15:37:09,188 - root - INFO - cli.py:110 - run_cli - Exiting the RAG system
2024-10-26 15:37:41,433 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-26 15:37:41,434 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-26 15:37:41,440 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-26 15:37:41,440 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-26 15:37:41,444 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-26 15:37:41,886 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"},{"name":"book-defaultbookindex","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-defaultbookindex-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-26 15:37:41,888 - root - WARNING - embedding.py:26 - <module> - Pinecone index is not available. Some functionality may be limited.
2024-10-26 15:37:41,892 - main.log - INFO - main.py:8 - main - Starting the RAG Book Assistant
2024-10-26 15:37:41,893 - root - INFO - cli.py:72 - run_cli - Starting the RAG system
2024-10-26 15:37:41,894 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-26 15:37:41,895 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-26 15:37:50,543 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-26 15:37:50,543 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-26 15:37:50,544 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-26 15:37:52,097 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"},{"name":"book-defaultbookindex","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-defaultbookindex-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-26 15:37:52,098 - root - INFO - cli.py:21 - load_and_process_book - === Starting book processing pipeline ===
2024-10-26 15:37:52,098 - root - INFO - cli.py:23 - load_and_process_book - 1. Preprocessing text...
2024-10-26 15:37:52,098 - root - INFO - text_processing.py:137 - load_and_preprocess_text - Preprocessing text content
2024-10-26 15:37:56,278 - root - INFO - text_processing.py:143 - load_and_preprocess_text - Extracted 10 dates, 1436 named entities, and 5 key phrases from the text
2024-10-26 15:37:56,278 - root - INFO - text_processing.py:168 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-26 15:42:32,795 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-26 15:42:32,797 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-26 15:42:32,805 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-26 15:42:32,805 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-26 15:42:32,815 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-26 15:42:33,163 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"},{"name":"book-defaultbookindex","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-defaultbookindex-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-26 15:42:33,164 - root - WARNING - embedding.py:26 - <module> - Pinecone index is not available. Some functionality may be limited.
2024-10-26 15:42:33,168 - main.log - INFO - main.py:8 - main - Starting the RAG Book Assistant
2024-10-26 15:42:33,169 - root - INFO - cli.py:90 - run_cli - Starting the RAG system
2024-10-26 15:42:33,171 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-26 15:42:33,171 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-26 15:42:46,521 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-26 15:42:46,523 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-26 15:42:46,523 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-26 15:42:46,836 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"},{"name":"book-defaultbookindex","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-defaultbookindex-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-26 15:42:46,837 - root - INFO - cli.py:25 - load_and_process_book - === Starting book processing pipeline ===
2024-10-26 15:42:46,838 - root - INFO - cli.py:43 - load_and_process_book - 1. Preprocessing text...
2024-10-26 15:42:46,839 - root - INFO - text_processing.py:137 - load_and_preprocess_text - Preprocessing text content
2024-10-26 15:42:46,840 - root - ERROR - error_handler.py:68 - wrapper - Unexpected error in extract_dates: expected string or bytes-like object, got '_io.TextIOWrapper'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 63, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/text_processing.py", line 53, in extract_dates
    return re.findall(date_pattern, text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/re/__init__.py", line 217, in findall
    return _compile(pattern, flags).findall(string)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: expected string or bytes-like object, got '_io.TextIOWrapper'
2024-10-26 15:42:46,868 - root - ERROR - error_handler.py:68 - wrapper - Unexpected error in extract_named_entities: module 'nltk' has no attribute 'exceptions'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/text_processing.py", line 70, in extract_named_entities
    chunks = ne_chunk(pos_tag(word_tokenize(text)))
                              ^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/nltk/tokenize/__init__.py", line 142, in word_tokenize
    sentences = [text] if preserve_line else sent_tokenize(text, language)
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/nltk/tokenize/__init__.py", line 120, in sent_tokenize
    return tokenizer.tokenize(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/nltk/tokenize/punkt.py", line 1280, in tokenize
    return list(self.sentences_from_text(text, realign_boundaries))
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/nltk/tokenize/punkt.py", line 1340, in sentences_from_text
    return [text[s:e] for s, e in self.span_tokenize(text, realign_boundaries)]
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/nltk/tokenize/punkt.py", line 1328, in span_tokenize
    for sentence in slices:
                    ^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/nltk/tokenize/punkt.py", line 1457, in _realign_boundaries
    for sentence1, sentence2 in _pair_iter(slices):
                                ^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/nltk/tokenize/punkt.py", line 321, in _pair_iter
    prev = next(iterator)
           ^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/nltk/tokenize/punkt.py", line 1429, in _slices_from_text
    for match, context in self._match_potential_end_contexts(text):
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/nltk/tokenize/punkt.py", line 1394, in _match_potential_end_contexts
    for match in self._lang_vars.period_context_re().finditer(text):
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: expected string or bytes-like object, got '_io.TextIOWrapper'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 63, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/text_processing.py", line 84, in extract_named_entities
    except nltk.exceptions.NLTKException as e:
           ^^^^^^^^^^^^^^^
AttributeError: module 'nltk' has no attribute 'exceptions'
2024-10-26 15:42:46,878 - root - ERROR - error_handler.py:68 - wrapper - Unexpected error in extract_key_phrases: module 'nltk' has no attribute 'exceptions'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/text_processing.py", line 104, in extract_key_phrases
    words = word_tokenize(text)
            ^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/nltk/tokenize/__init__.py", line 142, in word_tokenize
    sentences = [text] if preserve_line else sent_tokenize(text, language)
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/nltk/tokenize/__init__.py", line 120, in sent_tokenize
    return tokenizer.tokenize(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/nltk/tokenize/punkt.py", line 1280, in tokenize
    return list(self.sentences_from_text(text, realign_boundaries))
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/nltk/tokenize/punkt.py", line 1340, in sentences_from_text
    return [text[s:e] for s, e in self.span_tokenize(text, realign_boundaries)]
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/nltk/tokenize/punkt.py", line 1328, in span_tokenize
    for sentence in slices:
                    ^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/nltk/tokenize/punkt.py", line 1457, in _realign_boundaries
    for sentence1, sentence2 in _pair_iter(slices):
                                ^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/nltk/tokenize/punkt.py", line 321, in _pair_iter
    prev = next(iterator)
           ^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/nltk/tokenize/punkt.py", line 1429, in _slices_from_text
    for match, context in self._match_potential_end_contexts(text):
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/nltk/tokenize/punkt.py", line 1394, in _match_potential_end_contexts
    for match in self._lang_vars.period_context_re().finditer(text):
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: expected string or bytes-like object, got '_io.TextIOWrapper'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 63, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/text_processing.py", line 122, in extract_key_phrases
    except nltk.exceptions.NLTKException as e:
           ^^^^^^^^^^^^^^^
AttributeError: module 'nltk' has no attribute 'exceptions'
2024-10-26 15:42:46,887 - root - ERROR - error_handler.py:68 - wrapper - Unexpected error in load_and_preprocess_text: 'str' object has no attribute 'values'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 63, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/text_processing.py", line 143, in load_and_preprocess_text
    logger.info(f"Extracted {len(dates)} dates, {sum(len(v) for v in entities.values())} named entities, and {len(key_phrases)} key phrases from the text")
                                                                     ^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'values'
2024-10-26 15:42:46,888 - root - ERROR - error_handler.py:68 - wrapper - Unexpected error in load_and_process_book: string indices must be integers, not 'str'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 63, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/cli.py", line 48, in load_and_process_book
    chunk_count = len(processed_text['chunks'])
                      ~~~~~~~~~~~~~~^^^^^^^^^^
TypeError: string indices must be integers, not 'str'
2024-10-26 15:42:58,777 - root - INFO - cli.py:79 - answer_question - Received query:   ?
2024-10-26 15:42:58,778 - root - INFO - rag.py:107 - rag_query - Processing query:   ?
2024-10-26 15:42:58,778 - root - ERROR - error_handler.py:68 - wrapper - Unexpected error in __init__: 'str' object has no attribute 'get_chunks'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 63, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 29, in __init__
    self.chunks: List[Chunk] = data_source.get_chunks()
                               ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get_chunks'
2024-10-26 15:42:58,780 - root - ERROR - error_handler.py:68 - wrapper - Unexpected error in get_search_strategy: __init__() should return None, not 'str'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 63, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 157, in get_search_strategy
    return SimpleSearch(data_source)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: __init__() should return None, not 'str'
2024-10-26 15:42:58,780 - root - ERROR - error_handler.py:68 - wrapper - Unexpected error in rag_query: 'str' object has no attribute 'search'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 63, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 109, in rag_query
    relevant_chunks = search.search(question)
                      ^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'search'
2024-10-26 15:48:32,195 - root - INFO - cli.py:79 - answer_question - Received query: tests/data/test.txt
2024-10-26 15:48:32,196 - root - INFO - rag.py:107 - rag_query - Processing query: tests/data/test.txt
2024-10-26 15:48:32,196 - root - ERROR - error_handler.py:68 - wrapper - Unexpected error in __init__: 'str' object has no attribute 'get_chunks'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 63, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 29, in __init__
    self.chunks: List[Chunk] = data_source.get_chunks()
                               ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get_chunks'
2024-10-26 15:48:32,199 - root - ERROR - error_handler.py:68 - wrapper - Unexpected error in get_search_strategy: __init__() should return None, not 'str'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 63, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 157, in get_search_strategy
    return (1 - self.embedding_weight) * bm25_scores + self.embedding_weight * embedding_scores
           ^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: __init__() should return None, not 'str'
2024-10-26 15:48:32,200 - root - ERROR - error_handler.py:68 - wrapper - Unexpected error in rag_query: 'str' object has no attribute 'search'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 63, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 109, in rag_query
AttributeError: 'str' object has no attribute 'search'
2024-10-26 15:48:42,829 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-26 15:48:42,830 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-26 15:48:42,836 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-26 15:48:42,837 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-26 15:48:42,841 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-26 15:48:43,267 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"},{"name":"book-defaultbookindex","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-defaultbookindex-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-26 15:48:43,268 - root - WARNING - embedding.py:26 - <module> - Pinecone index is not available. Some functionality may be limited.
2024-10-26 15:51:50,287 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-26 15:51:50,288 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-26 15:51:50,294 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-26 15:51:50,294 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-26 15:51:50,300 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-26 15:51:50,615 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"},{"name":"book-defaultbookindex","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-defaultbookindex-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-26 15:51:50,616 - root - WARNING - embedding.py:26 - <module> - Pinecone index is not available. Some functionality may be limited.
2024-10-26 15:52:07,674 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-26 15:52:07,675 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-26 15:52:37,240 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-26 15:52:37,242 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-26 15:53:11,445 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-26 15:53:11,446 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-26 15:53:11,477 - main.log - INFO - main.py:8 - main - Starting the RAG Book Assistant
2024-10-26 15:53:11,477 - root - INFO - cli.py:66 - run_cli - Starting the RAG system
2024-10-26 15:53:11,477 - root - ERROR - cli.py:96 - run_cli - An unexpected error occurred: name 'APIKey' is not defined
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/cli.py", line 69, in run_cli
    openai_service = OpenAIService(api_key=APIKey(OPENAI_CONFIG['api_key']))
                                           ^^^^^^
NameError: name 'APIKey' is not defined
2024-10-26 15:53:11,478 - root - INFO - cli.py:99 - run_cli - Exiting the RAG system
2024-10-26 15:54:51,153 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-26 15:54:51,154 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-26 15:54:51,184 - main.log - INFO - main.py:8 - main - Starting the RAG Book Assistant
2024-10-26 15:54:51,184 - root - INFO - cli.py:66 - run_cli - Starting the RAG system
2024-10-26 15:54:51,185 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-26 15:54:51,185 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-26 15:55:14,394 - root - ERROR - cli.py:96 - run_cli - An unexpected error occurred: The file /Users/eduardizgorodin/Projects/rag_bo does not exist.
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/cli.py", line 73, in run_cli
    raise FileNotFoundError(f"The file {book_path} does not exist.")
FileNotFoundError: The file /Users/eduardizgorodin/Projects/rag_bo does not exist.
2024-10-26 15:55:14,396 - root - INFO - cli.py:99 - run_cli - Exiting the RAG system
2024-10-26 15:55:17,768 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-26 15:55:17,769 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-26 15:55:17,798 - main.log - INFO - main.py:8 - main - Starting the RAG Book Assistant
2024-10-26 15:55:17,799 - root - INFO - cli.py:66 - run_cli - Starting the RAG system
2024-10-26 15:55:17,799 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-26 15:55:17,799 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-26 15:55:29,065 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-26 15:55:29,066 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-26 15:55:29,076 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-26 15:55:29,692 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"},{"name":"book-defaultbookindex","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-defaultbookindex-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-26 15:55:29,695 - root - INFO - cli.py:25 - load_and_process_book - === Starting book processing pipeline ===
2024-10-26 15:55:29,696 - root - INFO - text_processing.py:132 - load_and_preprocess_text - Preprocessing text content
2024-10-26 15:55:29,697 - root - INFO - text_processing.py:163 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
