2024-10-24 18:33:30,289 - httpx - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 18:33:30,289 - httpx - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 18:33:30,289 - httpx - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 18:33:30,290 - httpx - DEBUG - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 18:33:30,290 - httpx - DEBUG - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 18:33:30,290 - httpx - DEBUG - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 18:33:30,296 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 18:33:30,296 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 18:33:30,296 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 18:33:30,296 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 18:33:30,296 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 18:33:30,296 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 18:33:30,306 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 18:33:30,306 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 18:33:30,306 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 18:33:30,620 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 18:33:30,620 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 18:33:30,620 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 18:33:30,623 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 18:33:30,623 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 18:33:30,623 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 18:33:33,555 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 18:33:33,555 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 18:33:33,555 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 18:33:33,555 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 18:33:33,555 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 18:33:33,555 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 18:33:34,298 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 18:33:34,298 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 18:33:34,298 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 18:33:35,169 - root - INFO - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 18:33:35,169 - root - INFO - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 18:33:35,169 - root - INFO - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 18:33:35,169 - root - INFO - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 18:33:35,172 - root - INFO - Created 199 chunks
2024-10-24 18:33:35,172 - root - INFO - Created 199 chunks
2024-10-24 18:33:35,172 - root - INFO - Created 199 chunks
2024-10-24 18:33:35,172 - root - INFO - Created 199 chunks
2024-10-24 18:33:35,172 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 18:33:35,172 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 18:33:35,172 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 18:33:35,172 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 18:33:35,172 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 18:33:35,172 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 18:33:35,172 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 18:33:35,172 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 18:33:35,173 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 18:33:35,173 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 18:33:35,173 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 18:33:35,173 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 18:33:35,542 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 18:33:35,542 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 18:33:35,542 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 18:33:35,542 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 18:33:35,544 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 18:33:35,544 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 18:33:35,544 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 18:33:35,544 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 18:33:35,857 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 18:33:35,857 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 18:33:35,857 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 18:33:35,857 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 18:33:35,858 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 18:33:35,858 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 18:33:35,858 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 18:33:35,858 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 18:33:35,900 - tests.conftest - INFO - Test test_qa_system[qa_pair0] took 0.00 seconds
2024-10-24 18:33:35,900 - tests.conftest - INFO - Test test_qa_system[qa_pair0] took 0.00 seconds
2024-10-24 18:33:35,900 - tests.conftest - INFO - Test test_qa_system[qa_pair0] took 0.00 seconds
2024-10-24 18:33:35,900 - tests.conftest - INFO - Test test_qa_system[qa_pair0] took 0.00 seconds
2024-10-24 18:33:35,901 - tests.conftest - INFO - Test test_qa_system[\n    {\n        "question": "Who was the executive vice president of Ford who conceived the Pinto project?",\n        "answer": "Lee Iacocca",\n        "context": "Mr. Iacocca, then a Ford vice president, conceived the project and was its moving force."\n    },\n    {\n        "question": "What was the weight target for the Pinto set by Ford?",\n        "answer": "2,000 pounds",\n        "context": "Ford's objective was to build a car at or below 2,000 pounds to sell for no more than $2,000."\n    },\n    {\n        "question": "On what date did the accident involving Lily Gray and Richard Grimshaw occur?",\n        "answer": "May 28, 1972",\n        "context": "On May 28, 1972, Mrs. Gray, accompanied by 13-year-old Richard Grimshaw, set out in the Pinto from Anaheim for Barstow to meet Mr. Gray."\n    },\n    {\n        "question": "What was the speed of the Ford Galaxie at the moment of impact with the Pinto?",\n        "answer": "28 to 37 miles per hour",\n        "context": "The Galaxie had been traveling from 50 to 55 miles per hour but before the impact had been braked to a speed of from 28 to 37 miles per hour."\n    },\n    {\n        "question": "What factors influenced the placement of the fuel tank in the Ford Pinto?",\n        "answer": "Styling decisions that preceded engineering design",\n        "context": "The Pinto's styling, however, required the tank to be placed behind the rear axle leaving only 9 or 10 inches of 'crush space'--far less than in any other American automobile or Ford overseas subcompact."\n    },\n    {\n        "question": "How did Ford's crash tests reveal the Pinto's fuel system vulnerabilities?",\n        "answer": "Tests showed fuel tank punctures and fuel leakage at low speeds",\n        "context": "Mechanical prototypes struck from the rear with a moving barrier at 21 miles per hour caused the fuel tank to be driven forward and to be punctured, causing fuel leakage in excess of the standard prescribed by the proposed regulation."\n    },\n    {\n        "question": "What was the estimated cost to fix the Pinto's fuel tank design, and how did Ford justify not implementing it?",\n        "answer": "$6.40 per vehicle, justified by cost-benefit analysis",\n        "context": "The cost to remedy the defective design of the Pinto gas tank was estimated to be $6.40 per vehicle. Ford used a cost-benefit analysis to determine that it was cheaper to pay for potential lawsuits than to fix the design."\n    },\n    {\n        "question": "How did the court define 'malice' in the context of the Ford Pinto case?",\n        "answer": "Conscious disregard for the safety of others",\n        "context": "The court defined 'malice' as conduct evincing 'conscious disregard of the probability that the actor's conduct will result in injury to others.'"\n    },\n    {\n        "question": "What was the initial punitive damage award for Grimshaw, and how was it later modified?",\n        "answer": "$125 million, reduced to $3.5 million",\n        "context": "Grimshaw was awarded $2,516,000 compensatory damages and $125 million punitive damages; the Grays were awarded $559,680 in compensatory damages. On Ford's motion for a new trial, Grimshaw was required to remit all but $3 1/2 million of the punitive award as a condition of denial of the motion."\n    },\n    {\n        "question": "How did Ford's 'rush' development of the Pinto affect its safety design?",\n        "answer": "Styling preceded engineering, dictating design choices",\n        "context": "Pinto, however, was a rush project, so that styling preceded engineering and dictated engineering design to a greater degree than usual."\n    },\n    {\n        "question": "What evidence suggested that Ford was aware of the Pinto's safety issues before its release?",\n        "answer": "Crash test results and engineer testimonies",\n        "context": "Harley Copp, a former Ford engineer and executive in charge of the crash testing program, testified that the highest level of Ford's management made the decision to go forward with the production of the Pinto, knowing that the gas tank was vulnerable to puncture and rupture at low rear impact speeds."\n    },\n    {\n        "question": "How did the Pinto case impact the legal understanding of corporate responsibility and product liability?",\n        "answer": "Established precedent for punitive damages in product liability cases",\n        "context": "The case set a precedent for awarding punitive damages in product liability cases and highlighted the importance of corporate responsibility in product safety."\n    },\n    {\n        "question": "What was the significance of the 'crush space' in the Pinto's design, and how did it compare to other vehicles?",\n        "answer": "9-10 inches, less than other American cars",\n        "context": "The Pinto's styling, however, required the tank to be placed behind the rear axle leaving only 9 or 10 inches of 'crush space'--far less than in any other American automobile or Ford overseas subcompact."\n    },\n    {\n        "question": "How did Ford's internal memo about the cost-benefit analysis of safety improvements come to light during the trial?",\n        "answer": "Through the testimony of Harley Copp",\n        "context": "Harley Copp's testimony revealed the existence of Ford's internal cost-benefit analysis memo, which compared the cost of improvements to the potential costs of lawsuits from deaths and injuries."\n    },\n    ] took 0.00 seconds
2024-10-24 18:33:35,901 - tests.conftest - INFO - Test test_qa_system[\n    {\n        "question": "Who was the executive vice president of Ford who conceived the Pinto project?",\n        "answer": "Lee Iacocca",\n        "context": "Mr. Iacocca, then a Ford vice president, conceived the project and was its moving force."\n    },\n    {\n        "question": "What was the weight target for the Pinto set by Ford?",\n        "answer": "2,000 pounds",\n        "context": "Ford's objective was to build a car at or below 2,000 pounds to sell for no more than $2,000."\n    },\n    {\n        "question": "On what date did the accident involving Lily Gray and Richard Grimshaw occur?",\n        "answer": "May 28, 1972",\n        "context": "On May 28, 1972, Mrs. Gray, accompanied by 13-year-old Richard Grimshaw, set out in the Pinto from Anaheim for Barstow to meet Mr. Gray."\n    },\n    {\n        "question": "What was the speed of the Ford Galaxie at the moment of impact with the Pinto?",\n        "answer": "28 to 37 miles per hour",\n        "context": "The Galaxie had been traveling from 50 to 55 miles per hour but before the impact had been braked to a speed of from 28 to 37 miles per hour."\n    },\n    {\n        "question": "What factors influenced the placement of the fuel tank in the Ford Pinto?",\n        "answer": "Styling decisions that preceded engineering design",\n        "context": "The Pinto's styling, however, required the tank to be placed behind the rear axle leaving only 9 or 10 inches of 'crush space'--far less than in any other American automobile or Ford overseas subcompact."\n    },\n    {\n        "question": "How did Ford's crash tests reveal the Pinto's fuel system vulnerabilities?",\n        "answer": "Tests showed fuel tank punctures and fuel leakage at low speeds",\n        "context": "Mechanical prototypes struck from the rear with a moving barrier at 21 miles per hour caused the fuel tank to be driven forward and to be punctured, causing fuel leakage in excess of the standard prescribed by the proposed regulation."\n    },\n    {\n        "question": "What was the estimated cost to fix the Pinto's fuel tank design, and how did Ford justify not implementing it?",\n        "answer": "$6.40 per vehicle, justified by cost-benefit analysis",\n        "context": "The cost to remedy the defective design of the Pinto gas tank was estimated to be $6.40 per vehicle. Ford used a cost-benefit analysis to determine that it was cheaper to pay for potential lawsuits than to fix the design."\n    },\n    {\n        "question": "How did the court define 'malice' in the context of the Ford Pinto case?",\n        "answer": "Conscious disregard for the safety of others",\n        "context": "The court defined 'malice' as conduct evincing 'conscious disregard of the probability that the actor's conduct will result in injury to others.'"\n    },\n    {\n        "question": "What was the initial punitive damage award for Grimshaw, and how was it later modified?",\n        "answer": "$125 million, reduced to $3.5 million",\n        "context": "Grimshaw was awarded $2,516,000 compensatory damages and $125 million punitive damages; the Grays were awarded $559,680 in compensatory damages. On Ford's motion for a new trial, Grimshaw was required to remit all but $3 1/2 million of the punitive award as a condition of denial of the motion."\n    },\n    {\n        "question": "How did Ford's 'rush' development of the Pinto affect its safety design?",\n        "answer": "Styling preceded engineering, dictating design choices",\n        "context": "Pinto, however, was a rush project, so that styling preceded engineering and dictated engineering design to a greater degree than usual."\n    },\n    {\n        "question": "What evidence suggested that Ford was aware of the Pinto's safety issues before its release?",\n        "answer": "Crash test results and engineer testimonies",\n        "context": "Harley Copp, a former Ford engineer and executive in charge of the crash testing program, testified that the highest level of Ford's management made the decision to go forward with the production of the Pinto, knowing that the gas tank was vulnerable to puncture and rupture at low rear impact speeds."\n    },\n    {\n        "question": "How did the Pinto case impact the legal understanding of corporate responsibility and product liability?",\n        "answer": "Established precedent for punitive damages in product liability cases",\n        "context": "The case set a precedent for awarding punitive damages in product liability cases and highlighted the importance of corporate responsibility in product safety."\n    },\n    {\n        "question": "What was the significance of the 'crush space' in the Pinto's design, and how did it compare to other vehicles?",\n        "answer": "9-10 inches, less than other American cars",\n        "context": "The Pinto's styling, however, required the tank to be placed behind the rear axle leaving only 9 or 10 inches of 'crush space'--far less than in any other American automobile or Ford overseas subcompact."\n    },\n    {\n        "question": "How did Ford's internal memo about the cost-benefit analysis of safety improvements come to light during the trial?",\n        "answer": "Through the testimony of Harley Copp",\n        "context": "Harley Copp's testimony revealed the existence of Ford's internal cost-benefit analysis memo, which compared the cost of improvements to the potential costs of lawsuits from deaths and injuries."\n    },\n    ] took 0.00 seconds
2024-10-24 18:33:35,901 - tests.conftest - INFO - Test test_qa_system[\n    {\n        "question": "Who was the executive vice president of Ford who conceived the Pinto project?",\n        "answer": "Lee Iacocca",\n        "context": "Mr. Iacocca, then a Ford vice president, conceived the project and was its moving force."\n    },\n    {\n        "question": "What was the weight target for the Pinto set by Ford?",\n        "answer": "2,000 pounds",\n        "context": "Ford's objective was to build a car at or below 2,000 pounds to sell for no more than $2,000."\n    },\n    {\n        "question": "On what date did the accident involving Lily Gray and Richard Grimshaw occur?",\n        "answer": "May 28, 1972",\n        "context": "On May 28, 1972, Mrs. Gray, accompanied by 13-year-old Richard Grimshaw, set out in the Pinto from Anaheim for Barstow to meet Mr. Gray."\n    },\n    {\n        "question": "What was the speed of the Ford Galaxie at the moment of impact with the Pinto?",\n        "answer": "28 to 37 miles per hour",\n        "context": "The Galaxie had been traveling from 50 to 55 miles per hour but before the impact had been braked to a speed of from 28 to 37 miles per hour."\n    },\n    {\n        "question": "What factors influenced the placement of the fuel tank in the Ford Pinto?",\n        "answer": "Styling decisions that preceded engineering design",\n        "context": "The Pinto's styling, however, required the tank to be placed behind the rear axle leaving only 9 or 10 inches of 'crush space'--far less than in any other American automobile or Ford overseas subcompact."\n    },\n    {\n        "question": "How did Ford's crash tests reveal the Pinto's fuel system vulnerabilities?",\n        "answer": "Tests showed fuel tank punctures and fuel leakage at low speeds",\n        "context": "Mechanical prototypes struck from the rear with a moving barrier at 21 miles per hour caused the fuel tank to be driven forward and to be punctured, causing fuel leakage in excess of the standard prescribed by the proposed regulation."\n    },\n    {\n        "question": "What was the estimated cost to fix the Pinto's fuel tank design, and how did Ford justify not implementing it?",\n        "answer": "$6.40 per vehicle, justified by cost-benefit analysis",\n        "context": "The cost to remedy the defective design of the Pinto gas tank was estimated to be $6.40 per vehicle. Ford used a cost-benefit analysis to determine that it was cheaper to pay for potential lawsuits than to fix the design."\n    },\n    {\n        "question": "How did the court define 'malice' in the context of the Ford Pinto case?",\n        "answer": "Conscious disregard for the safety of others",\n        "context": "The court defined 'malice' as conduct evincing 'conscious disregard of the probability that the actor's conduct will result in injury to others.'"\n    },\n    {\n        "question": "What was the initial punitive damage award for Grimshaw, and how was it later modified?",\n        "answer": "$125 million, reduced to $3.5 million",\n        "context": "Grimshaw was awarded $2,516,000 compensatory damages and $125 million punitive damages; the Grays were awarded $559,680 in compensatory damages. On Ford's motion for a new trial, Grimshaw was required to remit all but $3 1/2 million of the punitive award as a condition of denial of the motion."\n    },\n    {\n        "question": "How did Ford's 'rush' development of the Pinto affect its safety design?",\n        "answer": "Styling preceded engineering, dictating design choices",\n        "context": "Pinto, however, was a rush project, so that styling preceded engineering and dictated engineering design to a greater degree than usual."\n    },\n    {\n        "question": "What evidence suggested that Ford was aware of the Pinto's safety issues before its release?",\n        "answer": "Crash test results and engineer testimonies",\n        "context": "Harley Copp, a former Ford engineer and executive in charge of the crash testing program, testified that the highest level of Ford's management made the decision to go forward with the production of the Pinto, knowing that the gas tank was vulnerable to puncture and rupture at low rear impact speeds."\n    },\n    {\n        "question": "How did the Pinto case impact the legal understanding of corporate responsibility and product liability?",\n        "answer": "Established precedent for punitive damages in product liability cases",\n        "context": "The case set a precedent for awarding punitive damages in product liability cases and highlighted the importance of corporate responsibility in product safety."\n    },\n    {\n        "question": "What was the significance of the 'crush space' in the Pinto's design, and how did it compare to other vehicles?",\n        "answer": "9-10 inches, less than other American cars",\n        "context": "The Pinto's styling, however, required the tank to be placed behind the rear axle leaving only 9 or 10 inches of 'crush space'--far less than in any other American automobile or Ford overseas subcompact."\n    },\n    {\n        "question": "How did Ford's internal memo about the cost-benefit analysis of safety improvements come to light during the trial?",\n        "answer": "Through the testimony of Harley Copp",\n        "context": "Harley Copp's testimony revealed the existence of Ford's internal cost-benefit analysis memo, which compared the cost of improvements to the potential costs of lawsuits from deaths and injuries."\n    },\n    ] took 0.00 seconds
2024-10-24 18:33:35,901 - tests.conftest - INFO - Test test_qa_system[\n    {\n        "question": "Who was the executive vice president of Ford who conceived the Pinto project?",\n        "answer": "Lee Iacocca",\n        "context": "Mr. Iacocca, then a Ford vice president, conceived the project and was its moving force."\n    },\n    {\n        "question": "What was the weight target for the Pinto set by Ford?",\n        "answer": "2,000 pounds",\n        "context": "Ford's objective was to build a car at or below 2,000 pounds to sell for no more than $2,000."\n    },\n    {\n        "question": "On what date did the accident involving Lily Gray and Richard Grimshaw occur?",\n        "answer": "May 28, 1972",\n        "context": "On May 28, 1972, Mrs. Gray, accompanied by 13-year-old Richard Grimshaw, set out in the Pinto from Anaheim for Barstow to meet Mr. Gray."\n    },\n    {\n        "question": "What was the speed of the Ford Galaxie at the moment of impact with the Pinto?",\n        "answer": "28 to 37 miles per hour",\n        "context": "The Galaxie had been traveling from 50 to 55 miles per hour but before the impact had been braked to a speed of from 28 to 37 miles per hour."\n    },\n    {\n        "question": "What factors influenced the placement of the fuel tank in the Ford Pinto?",\n        "answer": "Styling decisions that preceded engineering design",\n        "context": "The Pinto's styling, however, required the tank to be placed behind the rear axle leaving only 9 or 10 inches of 'crush space'--far less than in any other American automobile or Ford overseas subcompact."\n    },\n    {\n        "question": "How did Ford's crash tests reveal the Pinto's fuel system vulnerabilities?",\n        "answer": "Tests showed fuel tank punctures and fuel leakage at low speeds",\n        "context": "Mechanical prototypes struck from the rear with a moving barrier at 21 miles per hour caused the fuel tank to be driven forward and to be punctured, causing fuel leakage in excess of the standard prescribed by the proposed regulation."\n    },\n    {\n        "question": "What was the estimated cost to fix the Pinto's fuel tank design, and how did Ford justify not implementing it?",\n        "answer": "$6.40 per vehicle, justified by cost-benefit analysis",\n        "context": "The cost to remedy the defective design of the Pinto gas tank was estimated to be $6.40 per vehicle. Ford used a cost-benefit analysis to determine that it was cheaper to pay for potential lawsuits than to fix the design."\n    },\n    {\n        "question": "How did the court define 'malice' in the context of the Ford Pinto case?",\n        "answer": "Conscious disregard for the safety of others",\n        "context": "The court defined 'malice' as conduct evincing 'conscious disregard of the probability that the actor's conduct will result in injury to others.'"\n    },\n    {\n        "question": "What was the initial punitive damage award for Grimshaw, and how was it later modified?",\n        "answer": "$125 million, reduced to $3.5 million",\n        "context": "Grimshaw was awarded $2,516,000 compensatory damages and $125 million punitive damages; the Grays were awarded $559,680 in compensatory damages. On Ford's motion for a new trial, Grimshaw was required to remit all but $3 1/2 million of the punitive award as a condition of denial of the motion."\n    },\n    {\n        "question": "How did Ford's 'rush' development of the Pinto affect its safety design?",\n        "answer": "Styling preceded engineering, dictating design choices",\n        "context": "Pinto, however, was a rush project, so that styling preceded engineering and dictated engineering design to a greater degree than usual."\n    },\n    {\n        "question": "What evidence suggested that Ford was aware of the Pinto's safety issues before its release?",\n        "answer": "Crash test results and engineer testimonies",\n        "context": "Harley Copp, a former Ford engineer and executive in charge of the crash testing program, testified that the highest level of Ford's management made the decision to go forward with the production of the Pinto, knowing that the gas tank was vulnerable to puncture and rupture at low rear impact speeds."\n    },\n    {\n        "question": "How did the Pinto case impact the legal understanding of corporate responsibility and product liability?",\n        "answer": "Established precedent for punitive damages in product liability cases",\n        "context": "The case set a precedent for awarding punitive damages in product liability cases and highlighted the importance of corporate responsibility in product safety."\n    },\n    {\n        "question": "What was the significance of the 'crush space' in the Pinto's design, and how did it compare to other vehicles?",\n        "answer": "9-10 inches, less than other American cars",\n        "context": "The Pinto's styling, however, required the tank to be placed behind the rear axle leaving only 9 or 10 inches of 'crush space'--far less than in any other American automobile or Ford overseas subcompact."\n    },\n    {\n        "question": "How did Ford's internal memo about the cost-benefit analysis of safety improvements come to light during the trial?",\n        "answer": "Through the testimony of Harley Copp",\n        "context": "Harley Copp's testimony revealed the existence of Ford's internal cost-benefit analysis memo, which compared the cost of improvements to the potential costs of lawsuits from deaths and injuries."\n    },\n    ] took 0.00 seconds
2024-10-24 18:54:57,139 - httpx - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 18:54:57,140 - httpx - DEBUG - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 18:54:57,146 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 18:54:57,146 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 18:54:57,155 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 18:54:57,787 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 18:54:57,787 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 18:54:58,754 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 18:54:58,754 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 18:54:59,336 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 18:55:00,994 - root - INFO - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 18:55:00,999 - root - INFO - Created 199 chunks
2024-10-24 18:55:01,002 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 18:55:01,002 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 18:55:01,002 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 18:55:02,234 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 18:55:02,235 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 18:55:02,760 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 18:55:02,761 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 18:55:02,807 - root - INFO - Test test_qa_system[qa_pair0] took 0.00 seconds
2024-10-24 18:55:02,808 - root - INFO - Test test_qa_system[\n    {\n        "question": "Who was the executive vice president of Ford who conceived the Pinto project?",\n        "answer": "Lee Iacocca",\n        "context": "Mr. Iacocca, then a Ford vice president, conceived the project and was its moving force."\n    },\n    {\n        "question": "What was the weight target for the Pinto set by Ford?",\n        "answer": "2,000 pounds",\n        "context": "Ford's objective was to build a car at or below 2,000 pounds to sell for no more than $2,000."\n    },\n    {\n        "question": "On what date did the accident involving Lily Gray and Richard Grimshaw occur?",\n        "answer": "May 28, 1972",\n        "context": "On May 28, 1972, Mrs. Gray, accompanied by 13-year-old Richard Grimshaw, set out in the Pinto from Anaheim for Barstow to meet Mr. Gray."\n    },\n    {\n        "question": "What was the speed of the Ford Galaxie at the moment of impact with the Pinto?",\n        "answer": "28 to 37 miles per hour",\n        "context": "The Galaxie had been traveling from 50 to 55 miles per hour but before the impact had been braked to a speed of from 28 to 37 miles per hour."\n    },\n    {\n        "question": "What factors influenced the placement of the fuel tank in the Ford Pinto?",\n        "answer": "Styling decisions that preceded engineering design",\n        "context": "The Pinto's styling, however, required the tank to be placed behind the rear axle leaving only 9 or 10 inches of 'crush space'--far less than in any other American automobile or Ford overseas subcompact."\n    },\n    {\n        "question": "How did Ford's crash tests reveal the Pinto's fuel system vulnerabilities?",\n        "answer": "Tests showed fuel tank punctures and fuel leakage at low speeds",\n        "context": "Mechanical prototypes struck from the rear with a moving barrier at 21 miles per hour caused the fuel tank to be driven forward and to be punctured, causing fuel leakage in excess of the standard prescribed by the proposed regulation."\n    },\n    {\n        "question": "What was the estimated cost to fix the Pinto's fuel tank design, and how did Ford justify not implementing it?",\n        "answer": "$6.40 per vehicle, justified by cost-benefit analysis",\n        "context": "The cost to remedy the defective design of the Pinto gas tank was estimated to be $6.40 per vehicle. Ford used a cost-benefit analysis to determine that it was cheaper to pay for potential lawsuits than to fix the design."\n    },\n    {\n        "question": "How did the court define 'malice' in the context of the Ford Pinto case?",\n        "answer": "Conscious disregard for the safety of others",\n        "context": "The court defined 'malice' as conduct evincing 'conscious disregard of the probability that the actor's conduct will result in injury to others.'"\n    },\n    {\n        "question": "What was the initial punitive damage award for Grimshaw, and how was it later modified?",\n        "answer": "$125 million, reduced to $3.5 million",\n        "context": "Grimshaw was awarded $2,516,000 compensatory damages and $125 million punitive damages; the Grays were awarded $559,680 in compensatory damages. On Ford's motion for a new trial, Grimshaw was required to remit all but $3 1/2 million of the punitive award as a condition of denial of the motion."\n    },\n    {\n        "question": "How did Ford's 'rush' development of the Pinto affect its safety design?",\n        "answer": "Styling preceded engineering, dictating design choices",\n        "context": "Pinto, however, was a rush project, so that styling preceded engineering and dictated engineering design to a greater degree than usual."\n    },\n    {\n        "question": "What evidence suggested that Ford was aware of the Pinto's safety issues before its release?",\n        "answer": "Crash test results and engineer testimonies",\n        "context": "Harley Copp, a former Ford engineer and executive in charge of the crash testing program, testified that the highest level of Ford's management made the decision to go forward with the production of the Pinto, knowing that the gas tank was vulnerable to puncture and rupture at low rear impact speeds."\n    },\n    {\n        "question": "How did the Pinto case impact the legal understanding of corporate responsibility and product liability?",\n        "answer": "Established precedent for punitive damages in product liability cases",\n        "context": "The case set a precedent for awarding punitive damages in product liability cases and highlighted the importance of corporate responsibility in product safety."\n    },\n    {\n        "question": "What was the significance of the 'crush space' in the Pinto's design, and how did it compare to other vehicles?",\n        "answer": "9-10 inches, less than other American cars",\n        "context": "The Pinto's styling, however, required the tank to be placed behind the rear axle leaving only 9 or 10 inches of 'crush space'--far less than in any other American automobile or Ford overseas subcompact."\n    },\n    {\n        "question": "How did Ford's internal memo about the cost-benefit analysis of safety improvements come to light during the trial?",\n        "answer": "Through the testimony of Harley Copp",\n        "context": "Harley Copp's testimony revealed the existence of Ford's internal cost-benefit analysis memo, which compared the cost of improvements to the potential costs of lawsuits from deaths and injuries."\n    },\n    ] took 0.00 seconds
2024-10-24 22:11:09,673 - httpx - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 22:11:09,673 - httpx - DEBUG - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 22:11:09,679 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:11:09,679 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:11:09,689 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:11:10,155 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:11:10,158 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:11:11,023 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:11:11,023 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:11:11,253 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 22:11:12,105 - root - INFO - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 22:11:12,107 - root - INFO - Created 199 chunks
2024-10-24 22:11:12,107 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:11:12,107 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:11:12,107 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:11:12,434 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:11:12,434 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:11:12,693 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:11:12,694 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:11:12,761 - root - INFO - Processing RAG query: What was the model year of the Ford Pinto involved in the accident?
2024-10-24 22:11:12,761 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:11:12,762 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:11:12,762 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:11:13,111 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:11:13,113 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:11:13,403 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:11:13,403 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:11:13,404 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:11:13,404 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:11:13,405 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:11:13,773 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:11:13,775 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:11:14,168 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:11:14,169 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:11:15,160 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"upsertedCount":1}'
2024-10-24 22:11:16,048 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"results":[],"matches":[{"id":"381ff60ffe74542b971aeaa2148a488c","score":1.00000799,"values":[],"metadata":{"text":"What was the model year of the Ford Pinto involved in the accident?"}},{"id":"7c25ca08798757a5d15caefbcf6d0c6a","score":0.699642897,"values":[],"metadata":{"text":"How did Ford\'s \'rush\' development of the Pinto affect its safety design?"}},{"id":"2ce3084ae5e281f5816fb0b3e11c5cf6","score":0.677877963,"values":[],"metadata":{"text":"How did Ford\'s crash tests reveal the Pinto\'s fuel system vulnerabilities?"}},{"id":"032d6d9f7cf883f483068a2d1d3ea7d0","score":0.649451852,"values":[],"metadata":{"text":"What was the speed of the Ford Galaxie at the moment of impact with the Pinto?"}},{"id":"34d53f2e1e7ce76e0573ae33e295b16d","score":0.640364826,"values":[],"metadata":{"text":"What evidence suggested that Ford was aware of the Pinto\'s safety issues before its release?"}},{"id":"6baf920636bb0e7a14c37c499f0a135f","score":0.591545105,"values":[],"metadata":{"text":"What factors influenced the placement of the fuel tank in the Ford Pinto?"}},{"id":"51bf0066086639adb0a494086a5121ce","score":0.587939262,"values":[],"metadata":{"text":"Who was the executive vice president of Ford who conceived the Pinto project?"}},{"id":"01e59f8ef084bd6a4d99f9067667d768","score":0.578649342,"values":[],"metadata":{"text":"What was the weight target for the Pinto set by Ford?"}},{"id":"4af6bd37a7ac7aa66d6fa4606aaa82b0","score":0.577010334,"values":[],"metadata":{"text":"What was the estimated cost to fix the Pinto\'s fuel tank design, and how did Ford justify not implementing it?"}},{"id":"fc2832187ee0402317d49a6c0df724ae","score":0.566243768,"values":[],"metadata":{"text":"How did the Pinto case impact the legal understanding of corporate responsibility and product liability?"}}],"namespace":"","usage":{"readUnits":6}}'
2024-10-24 22:11:16,051 - root - ERROR - Error in RAG query process: 'chunk'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 72, in rag_query
    relevant_chunks = pinecone_manager.search_similar(query_embedding, top_k=10)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/pinecone_manager.py", line 121, in search_similar
    return [{"chunk": match['metadata']['chunk'], "score": match['score']} for match in results['matches']]
                      ~~~~~~~~~~~~~~~~~^^^^^^^^^
KeyError: 'chunk'
2024-10-24 22:11:16,088 - rag_results - INFO - 
Q: What was the model year of the Ford Pinto involved in the accident?
2024-10-24 22:11:16,088 - rag_results - INFO - Expected A: 1972
2024-10-24 22:11:16,088 - rag_results - INFO - System A: Sorry, I encountered an error while processing your query: 'chunk'
2024-10-24 22:11:16,088 - rag_results - INFO - Is correct: False
2024-10-24 22:11:16,088 - rag_results - INFO - --------------------------------------------------
2024-10-24 22:11:16,181 - root - INFO - Test test_qa_system[qa_pair0] took 3.42 seconds
2024-10-24 22:11:16,183 - root - INFO - Test test_qa_system[\n    {\n        "question": "Who was the executive vice president of Ford who conceived the Pinto project?",\n        "answer": "Lee Iacocca",\n        "context": "Mr. Iacocca, then a Ford vice president, conceived the project and was its moving force."\n    },\n    {\n        "question": "What was the weight target for the Pinto set by Ford?",\n        "answer": "2,000 pounds",\n        "context": "Ford's objective was to build a car at or below 2,000 pounds to sell for no more than $2,000."\n    },\n    {\n        "question": "On what date did the accident involving Lily Gray and Richard Grimshaw occur?",\n        "answer": "May 28, 1972",\n        "context": "On May 28, 1972, Mrs. Gray, accompanied by 13-year-old Richard Grimshaw, set out in the Pinto from Anaheim for Barstow to meet Mr. Gray."\n    },\n    {\n        "question": "What was the speed of the Ford Galaxie at the moment of impact with the Pinto?",\n        "answer": "28 to 37 miles per hour",\n        "context": "The Galaxie had been traveling from 50 to 55 miles per hour but before the impact had been braked to a speed of from 28 to 37 miles per hour."\n    },\n    {\n        "question": "What factors influenced the placement of the fuel tank in the Ford Pinto?",\n        "answer": "Styling decisions that preceded engineering design",\n        "context": "The Pinto's styling, however, required the tank to be placed behind the rear axle leaving only 9 or 10 inches of 'crush space'--far less than in any other American automobile or Ford overseas subcompact."\n    },\n    {\n        "question": "How did Ford's crash tests reveal the Pinto's fuel system vulnerabilities?",\n        "answer": "Tests showed fuel tank punctures and fuel leakage at low speeds",\n        "context": "Mechanical prototypes struck from the rear with a moving barrier at 21 miles per hour caused the fuel tank to be driven forward and to be punctured, causing fuel leakage in excess of the standard prescribed by the proposed regulation."\n    },\n    {\n        "question": "What was the estimated cost to fix the Pinto's fuel tank design, and how did Ford justify not implementing it?",\n        "answer": "$6.40 per vehicle, justified by cost-benefit analysis",\n        "context": "The cost to remedy the defective design of the Pinto gas tank was estimated to be $6.40 per vehicle. Ford used a cost-benefit analysis to determine that it was cheaper to pay for potential lawsuits than to fix the design."\n    },\n    {\n        "question": "How did the court define 'malice' in the context of the Ford Pinto case?",\n        "answer": "Conscious disregard for the safety of others",\n        "context": "The court defined 'malice' as conduct evincing 'conscious disregard of the probability that the actor's conduct will result in injury to others.'"\n    },\n    {\n        "question": "What was the initial punitive damage award for Grimshaw, and how was it later modified?",\n        "answer": "$125 million, reduced to $3.5 million",\n        "context": "Grimshaw was awarded $2,516,000 compensatory damages and $125 million punitive damages; the Grays were awarded $559,680 in compensatory damages. On Ford's motion for a new trial, Grimshaw was required to remit all but $3 1/2 million of the punitive award as a condition of denial of the motion."\n    },\n    {\n        "question": "How did Ford's 'rush' development of the Pinto affect its safety design?",\n        "answer": "Styling preceded engineering, dictating design choices",\n        "context": "Pinto, however, was a rush project, so that styling preceded engineering and dictated engineering design to a greater degree than usual."\n    },\n    {\n        "question": "What evidence suggested that Ford was aware of the Pinto's safety issues before its release?",\n        "answer": "Crash test results and engineer testimonies",\n        "context": "Harley Copp, a former Ford engineer and executive in charge of the crash testing program, testified that the highest level of Ford's management made the decision to go forward with the production of the Pinto, knowing that the gas tank was vulnerable to puncture and rupture at low rear impact speeds."\n    },\n    {\n        "question": "How did the Pinto case impact the legal understanding of corporate responsibility and product liability?",\n        "answer": "Established precedent for punitive damages in product liability cases",\n        "context": "The case set a precedent for awarding punitive damages in product liability cases and highlighted the importance of corporate responsibility in product safety."\n    },\n    {\n        "question": "What was the significance of the 'crush space' in the Pinto's design, and how did it compare to other vehicles?",\n        "answer": "9-10 inches, less than other American cars",\n        "context": "The Pinto's styling, however, required the tank to be placed behind the rear axle leaving only 9 or 10 inches of 'crush space'--far less than in any other American automobile or Ford overseas subcompact."\n    },\n    {\n        "question": "How did Ford's internal memo about the cost-benefit analysis of safety improvements come to light during the trial?",\n        "answer": "Through the testimony of Harley Copp",\n        "context": "Harley Copp's testimony revealed the existence of Ford's internal cost-benefit analysis memo, which compared the cost of improvements to the potential costs of lawsuits from deaths and injuries."\n    },\n    ] took 0.00 seconds
2024-10-24 22:28:02,317 - httpx - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 22:28:02,317 - httpx - DEBUG - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 22:28:02,323 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:28:02,324 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:28:02,332 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:28:03,308 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:28:03,310 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:28:04,998 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:28:04,999 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:28:05,612 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 22:28:06,470 - root - INFO - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 22:28:06,472 - root - INFO - Created 199 chunks
2024-10-24 22:28:06,473 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:28:06,473 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:28:06,473 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:28:06,852 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:28:06,854 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:28:09,505 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:28:09,505 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:28:09,565 - root - INFO - Processing RAG query: What was the model year of the Ford Pinto involved in the accident?
2024-10-24 22:28:09,565 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:28:09,566 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:28:09,566 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:28:11,039 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:28:11,041 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:28:13,700 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:28:13,702 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:28:13,705 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:28:13,705 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:28:13,706 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:28:14,616 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:28:14,617 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:28:16,771 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:28:16,772 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:28:17,724 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"upsertedCount":1}'
2024-10-24 22:28:18,515 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"results":[],"matches":[{"id":"381ff60ffe74542b971aeaa2148a488c","score":1.00000799,"values":[],"metadata":{"text":"What was the model year of the Ford Pinto involved in the accident?"}},{"id":"0","score":1,"values":[],"metadata":{"chunk":"What was the model year of the Ford Pinto involved in the accident?"}},{"id":"7c25ca08798757a5d15caefbcf6d0c6a","score":0.699642897,"values":[],"metadata":{"text":"How did Ford\'s \'rush\' development of the Pinto affect its safety design?"}},{"id":"2ce3084ae5e281f5816fb0b3e11c5cf6","score":0.677877963,"values":[],"metadata":{"text":"How did Ford\'s crash tests reveal the Pinto\'s fuel system vulnerabilities?"}},{"id":"032d6d9f7cf883f483068a2d1d3ea7d0","score":0.649451852,"values":[],"metadata":{"text":"What was the speed of the Ford Galaxie at the moment of impact with the Pinto?"}},{"id":"34d53f2e1e7ce76e0573ae33e295b16d","score":0.640364826,"values":[],"metadata":{"text":"What evidence suggested that Ford was aware of the Pinto\'s safety issues before its release?"}},{"id":"6baf920636bb0e7a14c37c499f0a135f","score":0.591545105,"values":[],"metadata":{"text":"What factors influenced the placement of the fuel tank in the Ford Pinto?"}},{"id":"51bf0066086639adb0a494086a5121ce","score":0.587939262,"values":[],"metadata":{"text":"Who was the executive vice president of Ford who conceived the Pinto project?"}},{"id":"01e59f8ef084bd6a4d99f9067667d768","score":0.578649342,"values":[],"metadata":{"text":"What was the weight target for the Pinto set by Ford?"}},{"id":"4af6bd37a7ac7aa66d6fa4606aaa82b0","score":0.577010334,"values":[],"metadata":{"text":"What was the estimated cost to fix the Pinto\'s fuel tank design, and how did Ford justify not implementing it?"}}],"namespace":"","usage":{"readUnits":6}}'
2024-10-24 22:28:18,518 - root - ERROR - Error in RAG query process: 'chunk'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 72, in rag_query
    relevant_chunks = pinecone_manager.search_similar(query_embedding, top_k=10)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/pinecone_manager.py", line 121, in search_similar
    return [{"chunk": match['metadata']['chunk'], "score": match['score']} for match in results['matches']]
                      ~~~~~~~~~~~~~~~~~^^^^^^^^^
KeyError: 'chunk'
2024-10-24 22:28:18,555 - rag_results - INFO - 
Q: What was the model year of the Ford Pinto involved in the accident?
2024-10-24 22:28:18,556 - rag_results - INFO - Expected A: 1972
2024-10-24 22:28:18,556 - rag_results - INFO - System A: Sorry, I encountered an error while processing your query: 'chunk'
2024-10-24 22:28:18,556 - rag_results - INFO - Is correct: False
2024-10-24 22:28:18,556 - rag_results - INFO - --------------------------------------------------
2024-10-24 22:28:18,651 - root - INFO - Test test_qa_system[qa_pair0] took 9.09 seconds
2024-10-24 22:41:23,686 - httpx - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 22:41:23,687 - httpx - DEBUG - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 22:41:23,693 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:41:23,693 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:41:23,702 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:41:24,112 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:41:24,113 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:41:24,442 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:41:24,442 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:41:24,638 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 22:41:25,514 - root - INFO - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 22:41:25,516 - root - INFO - Created 199 chunks
2024-10-24 22:41:25,516 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:41:25,516 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:41:25,516 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:41:25,808 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:41:25,808 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:41:26,051 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:41:26,052 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:41:26,110 - root - INFO - Processing RAG query: What was the model year of the Ford Pinto involved in the accident?
2024-10-24 22:41:26,111 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:41:26,111 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:41:26,111 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:41:26,435 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:41:26,436 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:41:26,798 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:41:26,798 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:41:26,799 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:41:26,799 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:41:26,799 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:41:27,093 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:41:27,094 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:41:27,516 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:41:27,517 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:41:28,506 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"upsertedCount":1}'
2024-10-24 22:41:29,336 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"results":[],"matches":[{"id":"0","score":1.00000799,"values":[],"metadata":{"chunk":"What was the model year of the Ford Pinto involved in the accident?"}},{"id":"381ff60ffe74542b971aeaa2148a488c","score":1.00000799,"values":[],"metadata":{"text":"What was the model year of the Ford Pinto involved in the accident?"}},{"id":"7c25ca08798757a5d15caefbcf6d0c6a","score":0.699642897,"values":[],"metadata":{"text":"How did Ford\'s \'rush\' development of the Pinto affect its safety design?"}},{"id":"2ce3084ae5e281f5816fb0b3e11c5cf6","score":0.677877963,"values":[],"metadata":{"text":"How did Ford\'s crash tests reveal the Pinto\'s fuel system vulnerabilities?"}},{"id":"032d6d9f7cf883f483068a2d1d3ea7d0","score":0.649451852,"values":[],"metadata":{"text":"What was the speed of the Ford Galaxie at the moment of impact with the Pinto?"}},{"id":"34d53f2e1e7ce76e0573ae33e295b16d","score":0.640364826,"values":[],"metadata":{"text":"What evidence suggested that Ford was aware of the Pinto\'s safety issues before its release?"}},{"id":"6baf920636bb0e7a14c37c499f0a135f","score":0.591545105,"values":[],"metadata":{"text":"What factors influenced the placement of the fuel tank in the Ford Pinto?"}},{"id":"51bf0066086639adb0a494086a5121ce","score":0.587939262,"values":[],"metadata":{"text":"Who was the executive vice president of Ford who conceived the Pinto project?"}},{"id":"01e59f8ef084bd6a4d99f9067667d768","score":0.578649342,"values":[],"metadata":{"text":"What was the weight target for the Pinto set by Ford?"}},{"id":"4af6bd37a7ac7aa66d6fa4606aaa82b0","score":0.577010334,"values":[],"metadata":{"text":"What was the estimated cost to fix the Pinto\'s fuel tank design, and how did Ford justify not implementing it?"}}],"namespace":"","usage":{"readUnits":6}}'
2024-10-24 22:41:29,339 - root - INFO - Generated answer: <MagicMock name='mock.generate_answer()' id='5473217440'>
2024-10-24 22:41:29,478 - root - INFO - Test test_qa_system[qa_pair0] took 3.37 seconds
2024-10-24 22:48:46,760 - httpx - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 22:48:46,760 - httpx - DEBUG - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 22:48:46,767 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:48:46,767 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:48:46,775 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:48:47,635 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:48:47,638 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:48:50,013 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:48:50,014 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:48:50,370 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 22:48:51,200 - root - INFO - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 22:48:51,202 - root - INFO - Created 199 chunks
2024-10-24 22:48:51,203 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:48:51,203 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:48:51,203 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:48:51,519 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:48:51,520 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:48:53,862 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:48:53,863 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:48:53,920 - root - INFO - Processing RAG query: What was the model year of the Ford Pinto involved in the accident?
2024-10-24 22:48:53,922 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:48:53,922 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:48:53,923 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:48:54,429 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:48:54,430 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:48:56,484 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:48:56,484 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:48:56,486 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:48:56,487 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:48:56,487 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:48:57,669 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:48:57,670 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:48:58,284 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:48:58,285 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:48:59,294 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"upsertedCount":1}'
2024-10-24 22:49:00,152 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"results":[],"matches":[{"id":"381ff60ffe74542b971aeaa2148a488c","score":1.00000799,"values":[],"metadata":{"text":"What was the model year of the Ford Pinto involved in the accident?"}},{"id":"0","score":1,"values":[],"metadata":{"chunk":"What was the model year of the Ford Pinto involved in the accident?"}},{"id":"7c25ca08798757a5d15caefbcf6d0c6a","score":0.699642897,"values":[],"metadata":{"text":"How did Ford\'s \'rush\' development of the Pinto affect its safety design?"}},{"id":"2ce3084ae5e281f5816fb0b3e11c5cf6","score":0.677877963,"values":[],"metadata":{"text":"How did Ford\'s crash tests reveal the Pinto\'s fuel system vulnerabilities?"}},{"id":"032d6d9f7cf883f483068a2d1d3ea7d0","score":0.649451852,"values":[],"metadata":{"text":"What was the speed of the Ford Galaxie at the moment of impact with the Pinto?"}},{"id":"34d53f2e1e7ce76e0573ae33e295b16d","score":0.640364826,"values":[],"metadata":{"text":"What evidence suggested that Ford was aware of the Pinto\'s safety issues before its release?"}},{"id":"6baf920636bb0e7a14c37c499f0a135f","score":0.591545105,"values":[],"metadata":{"text":"What factors influenced the placement of the fuel tank in the Ford Pinto?"}},{"id":"51bf0066086639adb0a494086a5121ce","score":0.587939262,"values":[],"metadata":{"text":"Who was the executive vice president of Ford who conceived the Pinto project?"}},{"id":"01e59f8ef084bd6a4d99f9067667d768","score":0.578649342,"values":[],"metadata":{"text":"What was the weight target for the Pinto set by Ford?"}},{"id":"4af6bd37a7ac7aa66d6fa4606aaa82b0","score":0.577010334,"values":[],"metadata":{"text":"What was the estimated cost to fix the Pinto\'s fuel tank design, and how did Ford justify not implementing it?"}}],"namespace":"","usage":{"readUnits":6}}'
2024-10-24 22:49:00,156 - root - INFO - Generated answer: This is a mock answer
2024-10-24 22:49:00,190 - rag_results - INFO - 
Q: What was the model year of the Ford Pinto involved in the accident?
2024-10-24 22:49:00,190 - rag_results - INFO - Expected A: 1972
2024-10-24 22:49:00,190 - rag_results - INFO - System A: This is a mock answer
2024-10-24 22:49:00,190 - rag_results - INFO - Is correct: False
2024-10-24 22:49:00,190 - rag_results - INFO - --------------------------------------------------
2024-10-24 22:49:00,284 - root - INFO - Test test_qa_system[qa_pair0] took 6.36 seconds
2024-10-24 22:50:53,889 - httpx - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 22:50:53,890 - httpx - DEBUG - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 22:50:53,897 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:50:53,897 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:50:53,905 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:50:54,229 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:50:54,231 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:50:56,865 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:50:56,865 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:50:57,051 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 22:53:14,623 - httpx - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 22:53:14,624 - httpx - DEBUG - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 22:53:14,631 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:53:14,631 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:53:14,640 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:53:15,656 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:53:15,656 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:53:15,923 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:53:15,924 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:53:16,158 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 22:53:16,165 - root - INFO - Starting the RAG system
2024-10-24 22:53:54,597 - root - INFO - Loading book from: tests/data/test.pdf
2024-10-24 22:53:54,600 - root - INFO - Starting to process book content
2024-10-24 22:53:54,600 - root - INFO - Preprocessing text content
2024-10-24 22:53:54,945 - root - INFO - Extracted 0 dates, 0 named entities, and 1 key phrases from the text
2024-10-24 22:53:54,945 - root - INFO - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 22:53:54,945 - root - INFO - Created 1 chunks
2024-10-24 22:53:54,945 - root - INFO - Text preprocessed. Number of chunks: 1
2024-10-24 22:53:54,945 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:53:54,946 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:53:54,946 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:53:55,260 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:53:55,260 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:53:55,730 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:53:55,730 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:53:55,733 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x12ab4fb00>, 'json_data': {'input': ['tests/data/test.pdf'], 'model': 'text-embedding-3-small', 'encoding_format': 'base64'}}
2024-10-24 22:53:55,766 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-24 22:53:55,766 - httpcore.connection - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-24 22:53:55,902 - httpcore.connection - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x12ad248f0>
2024-10-24 22:53:55,904 - httpcore.connection - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x12a97f7d0> server_hostname='api.openai.com' timeout=5.0
2024-10-24 22:53:55,946 - httpcore.connection - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x12a9a6210>
2024-10-24 22:53:55,946 - httpcore.http11 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-24 22:53:55,947 - httpcore.http11 - DEBUG - send_request_headers.complete
2024-10-24 22:53:55,947 - httpcore.http11 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-24 22:53:55,947 - httpcore.http11 - DEBUG - send_request_body.complete
2024-10-24 22:53:55,947 - httpcore.http11 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-24 22:53:56,182 - httpcore.http11 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Thu, 24 Oct 2024 21:53:56 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-3-small'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'35'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999996'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'0s'), (b'x-request-id', b'req_589bf42deca44b6afd1b1fa224244951'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=sgOiz5IS9iE4SmqzBX.PpcK2AgQcYJUl7_GWV0I2Q48-1729806836-1.0.1.1-XwYH7mM46Ijn_7IWr1ftp_NFJV85n25rYqPJ0egJfpGPEWOUvJD2N58Fs6lkHlCPcH6m8UnmJEau6kIPf1gPJQ; path=/; expires=Thu, 24-Oct-24 22:23:56 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=Dm9HXmNA8UFVOwf2o75q2bUnXOHn2TIevzelVNu5KsA-1729806836306-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d7d33d5b9a894fb-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-24 22:53:56,185 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-24 22:53:56,186 - httpcore.http11 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-24 22:53:56,189 - httpcore.http11 - DEBUG - receive_response_body.complete
2024-10-24 22:53:56,191 - httpcore.http11 - DEBUG - response_closed.started
2024-10-24 22:53:56,191 - httpcore.http11 - DEBUG - response_closed.complete
2024-10-24 22:53:56,191 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers([('date', 'Thu, 24 Oct 2024 21:53:56 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-allow-origin', '*'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-model', 'text-embedding-3-small'), ('openai-organization', 'uinside'), ('openai-processing-ms', '35'), ('openai-version', '2020-10-01'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '5000000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '4999996'), ('x-ratelimit-reset-requests', '6ms'), ('x-ratelimit-reset-tokens', '0s'), ('x-request-id', 'req_589bf42deca44b6afd1b1fa224244951'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=sgOiz5IS9iE4SmqzBX.PpcK2AgQcYJUl7_GWV0I2Q48-1729806836-1.0.1.1-XwYH7mM46Ijn_7IWr1ftp_NFJV85n25rYqPJ0egJfpGPEWOUvJD2N58Fs6lkHlCPcH6m8UnmJEau6kIPf1gPJQ; path=/; expires=Thu, 24-Oct-24 22:23:56 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=Dm9HXmNA8UFVOwf2o75q2bUnXOHn2TIevzelVNu5KsA-1729806836306-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d7d33d5b9a894fb-LIS'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-24 22:53:56,191 - openai._base_client - DEBUG - request_id: req_589bf42deca44b6afd1b1fa224244951
2024-10-24 22:53:57,148 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"upsertedCount":1}'
2024-10-24 22:53:57,320 - root - INFO - Saving 1 chunks, their embeddings, and processed text to data/embeddings/35c83be7eecaf97ed63d33d440f620b3_chunks_embeddings.pkl.
2024-10-24 22:53:57,322 - root - INFO - Data saved to data/embeddings/35c83be7eecaf97ed63d33d440f620b3_chunks_embeddings.pkl.
2024-10-24 22:53:57,322 - root - INFO - Book data created. Number of chunks: 1
2024-10-24 22:53:57,322 - root - INFO - Book loaded and preprocessed. Text split into 1 chunks
2024-10-24 22:54:08,051 - root - INFO - Received query: О чем?
2024-10-24 22:54:08,052 - root - ERROR - Error generating answer: rag_query() missing 1 required positional argument: 'openai_service'
2024-10-24 22:59:46,436 - httpx - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 22:59:46,437 - httpx - DEBUG - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 22:59:46,444 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 22:59:46,444 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 22:59:46,453 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 22:59:46,861 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 22:59:46,863 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 22:59:47,296 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 22:59:47,297 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 22:59:47,496 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 22:59:47,498 - root - INFO - Starting the RAG system
2024-10-24 23:00:04,865 - root - INFO - Loading book from: tests/data/test.docx
2024-10-24 23:00:04,866 - root - INFO - Starting to process book content
2024-10-24 23:00:04,866 - root - INFO - Preprocessing text content
2024-10-24 23:00:05,158 - root - INFO - Extracted 0 dates, 0 named entities, and 1 key phrases from the text
2024-10-24 23:00:05,158 - root - INFO - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 23:00:05,158 - root - INFO - Created 1 chunks
2024-10-24 23:00:05,158 - root - INFO - Text preprocessed. Number of chunks: 1
2024-10-24 23:00:05,158 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:00:05,158 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:00:05,159 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 23:00:06,419 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:00:06,420 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 23:00:06,777 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:00:06,777 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 23:00:06,779 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x113b4fa60>, 'json_data': {'input': ['tests/data/test.docx'], 'model': 'text-embedding-3-small', 'encoding_format': 'base64'}}
2024-10-24 23:00:06,815 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-24 23:00:06,816 - httpcore.connection - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-24 23:00:06,950 - httpcore.connection - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x114924080>
2024-10-24 23:00:06,950 - httpcore.connection - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x11397f7d0> server_hostname='api.openai.com' timeout=5.0
2024-10-24 23:00:06,987 - httpcore.connection - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x112a2a000>
2024-10-24 23:00:06,987 - httpcore.http11 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-24 23:00:06,988 - httpcore.http11 - DEBUG - send_request_headers.complete
2024-10-24 23:00:06,988 - httpcore.http11 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-24 23:00:06,988 - httpcore.http11 - DEBUG - send_request_body.complete
2024-10-24 23:00:06,988 - httpcore.http11 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-24 23:00:07,346 - httpcore.http11 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Thu, 24 Oct 2024 22:00:07 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-3-small'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'134'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999994'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'0s'), (b'x-request-id', b'req_c40f3598dda3aeec3665d3716c1bda0f'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=munTpX_6yUPeFjiqDGNXhpHxK2r4J5xT7T_QybblXgw-1729807207-1.0.1.1-Bslqj_4UVx4ZR6HEJ7g8IpafNE71O4f4.zwJY6179kT.SJu56xitLJBb6buMGX39EkSm9ptvgDcGTDevCRgtIg; path=/; expires=Thu, 24-Oct-24 22:30:07 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=ED62IBqvfppYcajiSIbeZeU8ksGL_cPn35k03TZbhQI-1729807207415-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d7d3ce4bd25e3b0-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-24 23:00:07,349 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-24 23:00:07,349 - httpcore.http11 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-24 23:00:07,353 - httpcore.http11 - DEBUG - receive_response_body.complete
2024-10-24 23:00:07,353 - httpcore.http11 - DEBUG - response_closed.started
2024-10-24 23:00:07,353 - httpcore.http11 - DEBUG - response_closed.complete
2024-10-24 23:00:07,354 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers([('date', 'Thu, 24 Oct 2024 22:00:07 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-allow-origin', '*'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-model', 'text-embedding-3-small'), ('openai-organization', 'uinside'), ('openai-processing-ms', '134'), ('openai-version', '2020-10-01'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '5000000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '4999994'), ('x-ratelimit-reset-requests', '6ms'), ('x-ratelimit-reset-tokens', '0s'), ('x-request-id', 'req_c40f3598dda3aeec3665d3716c1bda0f'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=munTpX_6yUPeFjiqDGNXhpHxK2r4J5xT7T_QybblXgw-1729807207-1.0.1.1-Bslqj_4UVx4ZR6HEJ7g8IpafNE71O4f4.zwJY6179kT.SJu56xitLJBb6buMGX39EkSm9ptvgDcGTDevCRgtIg; path=/; expires=Thu, 24-Oct-24 22:30:07 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=ED62IBqvfppYcajiSIbeZeU8ksGL_cPn35k03TZbhQI-1729807207415-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d7d3ce4bd25e3b0-LIS'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-24 23:00:07,354 - openai._base_client - DEBUG - request_id: req_c40f3598dda3aeec3665d3716c1bda0f
2024-10-24 23:00:08,336 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"upsertedCount":1}'
2024-10-24 23:00:08,544 - root - INFO - Saving 1 chunks, their embeddings, and processed text to data/embeddings/e4d91ac66e5f5558df574c83384c8ecd_chunks_embeddings.pkl.
2024-10-24 23:00:08,545 - root - INFO - Data saved to data/embeddings/e4d91ac66e5f5558df574c83384c8ecd_chunks_embeddings.pkl.
2024-10-24 23:00:08,545 - root - INFO - Book data created. Number of chunks: 1
2024-10-24 23:00:08,545 - root - INFO - Book loaded and preprocessed. Text split into 1 chunks
2024-10-24 23:00:19,301 - root - INFO - Received query: что тут?
2024-10-24 23:00:19,302 - root - ERROR - Error generating answer: rag_query() missing 1 required positional argument: 'openai_service'
2024-10-24 23:06:24,338 - root - INFO - Received query: ?
2024-10-24 23:06:24,343 - root - ERROR - Error generating answer: rag_query() missing 1 required positional argument: 'openai_service'
2024-10-24 23:06:37,488 - httpx - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 23:06:37,489 - httpx - DEBUG - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 23:06:37,496 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:06:37,496 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:06:37,505 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 23:06:37,966 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:06:37,967 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 23:06:38,463 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:06:38,463 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 23:06:38,675 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 23:06:38,679 - root - INFO - Starting the RAG system
2024-10-24 23:07:08,880 - root - INFO - Loading book from: tests/data/test.odt
2024-10-24 23:07:08,881 - root - INFO - Starting to process book content
2024-10-24 23:07:08,881 - root - INFO - Preprocessing text content
2024-10-24 23:07:09,176 - root - INFO - Extracted 0 dates, 0 named entities, and 1 key phrases from the text
2024-10-24 23:07:09,176 - root - INFO - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 23:07:09,176 - root - INFO - Created 1 chunks
2024-10-24 23:07:09,176 - root - INFO - Text preprocessed. Number of chunks: 1
2024-10-24 23:07:09,177 - pinecone_plugin_interface.logging - INFO - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:07:09,177 - pinecone_plugin_interface.logging - INFO - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:07:09,177 - pinecone_plugin_interface.logging - INFO - Installing plugin inference into Pinecone
2024-10-24 23:07:09,494 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:07:09,494 - root - INFO - Creating new Pinecone index: book-embeddings
2024-10-24 23:07:09,848 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:07:09,849 - root - INFO - Index book-embeddings already exists. Using existing index.
2024-10-24 23:07:09,852 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x1248539c0>, 'json_data': {'input': ['tests/data/test.odt'], 'model': 'text-embedding-3-small', 'encoding_format': 'base64'}}
2024-10-24 23:07:09,893 - openai._base_client - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-24 23:07:09,893 - httpcore.connection - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-24 23:07:10,026 - httpcore.connection - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x124a24380>
2024-10-24 23:07:10,026 - httpcore.connection - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x11f3337d0> server_hostname='api.openai.com' timeout=5.0
2024-10-24 23:07:10,063 - httpcore.connection - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x124a25280>
2024-10-24 23:07:10,064 - httpcore.http11 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-24 23:07:10,064 - httpcore.http11 - DEBUG - send_request_headers.complete
2024-10-24 23:07:10,064 - httpcore.http11 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-24 23:07:10,064 - httpcore.http11 - DEBUG - send_request_body.complete
2024-10-24 23:07:10,064 - httpcore.http11 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-24 23:07:10,403 - httpcore.http11 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Thu, 24 Oct 2024 22:07:10 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-3-small'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'106'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999995'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'0s'), (b'x-request-id', b'req_ea5e4769ec3b8c42ff6aa597a5413df3'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=VOm9jrc1YjMpOFE4QfRBcmZkMlCo80igcDJA05RBQR4-1729807630-1.0.1.1-jGNajBoAoE5WtjVA3fqj19QVx4LXH4h_C.vM0sipUZ0_4QDLVBj0QNqN3szcHXYIcW_tyaXXnvLt30xbimNShQ; path=/; expires=Thu, 24-Oct-24 22:37:10 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=2.FvMGhMkjipV3d_thG2o2vE7gbxc_5jBib_x97qn.E-1729807630535-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d7d4738e84de3b4-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-24 23:07:10,405 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-24 23:07:10,406 - httpcore.http11 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-24 23:07:10,456 - httpcore.http11 - DEBUG - receive_response_body.complete
2024-10-24 23:07:10,456 - httpcore.http11 - DEBUG - response_closed.started
2024-10-24 23:07:10,456 - httpcore.http11 - DEBUG - response_closed.complete
2024-10-24 23:07:10,456 - openai._base_client - DEBUG - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers([('date', 'Thu, 24 Oct 2024 22:07:10 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-allow-origin', '*'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-model', 'text-embedding-3-small'), ('openai-organization', 'uinside'), ('openai-processing-ms', '106'), ('openai-version', '2020-10-01'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '5000000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '4999995'), ('x-ratelimit-reset-requests', '6ms'), ('x-ratelimit-reset-tokens', '0s'), ('x-request-id', 'req_ea5e4769ec3b8c42ff6aa597a5413df3'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=VOm9jrc1YjMpOFE4QfRBcmZkMlCo80igcDJA05RBQR4-1729807630-1.0.1.1-jGNajBoAoE5WtjVA3fqj19QVx4LXH4h_C.vM0sipUZ0_4QDLVBj0QNqN3szcHXYIcW_tyaXXnvLt30xbimNShQ; path=/; expires=Thu, 24-Oct-24 22:37:10 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=2.FvMGhMkjipV3d_thG2o2vE7gbxc_5jBib_x97qn.E-1729807630535-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d7d4738e84de3b4-LIS'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-24 23:07:10,456 - openai._base_client - DEBUG - request_id: req_ea5e4769ec3b8c42ff6aa597a5413df3
2024-10-24 23:07:11,505 - pinecone.core.openapi.shared.rest - DEBUG - response body: b'{"upsertedCount":1}'
2024-10-24 23:07:11,700 - root - INFO - Saving 1 chunks, their embeddings, and processed text to data/embeddings/6ee7dca7817d3b2f28a88d5e7e6121f0_chunks_embeddings.pkl.
2024-10-24 23:07:11,701 - root - INFO - Data saved to data/embeddings/6ee7dca7817d3b2f28a88d5e7e6121f0_chunks_embeddings.pkl.
2024-10-24 23:07:11,701 - root - INFO - Book data created. Number of chunks: 1
2024-10-24 23:07:11,701 - root - INFO - Book loaded and preprocessed. Text split into 1 chunks
2024-10-24 23:07:22,491 - root - INFO - Received query: Что в файле?
2024-10-24 23:07:22,491 - root - ERROR - An error occurred: name 'openai_service' is not defined
2024-10-24 23:07:22,491 - root - INFO - Exiting the RAG system
2024-10-24 23:07:22,584 - httpcore.connection - DEBUG - close.started
2024-10-24 23:07:22,584 - httpcore.connection - DEBUG - close.complete
2024-10-24 23:10:06,340 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 23:10:06,341 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 23:10:06,347 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:10:06,348 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:10:06,356 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:10:06,831 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:10:06,832 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:10:07,545 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:10:07,546 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:10:07,852 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 23:10:07,859 - root - INFO - cli.py:54 - run_cli - Starting the RAG system
2024-10-24 23:10:11,888 - root - INFO - cli.py:62 - run_cli - Loading book from: tests/data/test.odt
2024-10-24 23:10:11,889 - root - INFO - cli.py:25 - load_and_process_book - Starting to process book content
2024-10-24 23:10:11,890 - root - INFO - text_processing.py:75 - load_and_preprocess_text - Preprocessing text content
2024-10-24 23:10:12,232 - root - INFO - text_processing.py:81 - load_and_preprocess_text - Extracted 0 dates, 0 named entities, and 1 key phrases from the text
2024-10-24 23:10:12,232 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 23:10:12,232 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1 chunks
2024-10-24 23:10:12,232 - root - INFO - cli.py:28 - load_and_process_book - Text preprocessed. Number of chunks: 1
2024-10-24 23:10:12,232 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:10:12,232 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:10:12,233 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:10:12,538 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:10:12,539 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:10:12,973 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:10:12,973 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:10:13,911 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-24 23:10:14,101 - root - INFO - embedding.py:46 - save_chunks_and_embeddings - Saving 1 chunks, their embeddings, and processed text to data/embeddings/6ee7dca7817d3b2f28a88d5e7e6121f0_chunks_embeddings.pkl.
2024-10-24 23:10:14,103 - root - INFO - embedding.py:49 - save_chunks_and_embeddings - Data saved to data/embeddings/6ee7dca7817d3b2f28a88d5e7e6121f0_chunks_embeddings.pkl.
2024-10-24 23:10:14,103 - root - INFO - cli.py:38 - load_and_process_book - Book data created. Number of chunks: 1
2024-10-24 23:10:14,103 - root - INFO - cli.py:64 - run_cli - Book loaded and preprocessed. Text split into 1 chunks
2024-10-24 23:10:23,415 - root - INFO - cli.py:74 - run_cli - Received query: ?
2024-10-24 23:10:23,416 - root - ERROR - cli.py:82 - run_cli - An error occurred: name 'openai_service' is not defined
2024-10-24 23:10:23,416 - root - INFO - cli.py:85 - run_cli - Exiting the RAG system
2024-10-24 23:12:39,242 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 23:12:39,243 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 23:12:39,251 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:12:39,252 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:12:39,261 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:12:39,581 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:12:39,583 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:12:40,799 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:12:40,799 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:12:41,147 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 23:12:41,150 - root - INFO - cli.py:54 - run_cli - Starting the RAG system
2024-10-24 23:13:23,254 - root - INFO - cli.py:62 - run_cli - Loading book from: tests/data/test.odt
2024-10-24 23:13:23,256 - root - INFO - cli.py:25 - load_and_process_book - Starting to process book content
2024-10-24 23:13:23,256 - root - INFO - text_processing.py:75 - load_and_preprocess_text - Preprocessing text content
2024-10-24 23:13:23,597 - root - INFO - text_processing.py:81 - load_and_preprocess_text - Extracted 0 dates, 0 named entities, and 1 key phrases from the text
2024-10-24 23:13:23,598 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 23:13:23,598 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1 chunks
2024-10-24 23:13:23,598 - root - INFO - cli.py:28 - load_and_process_book - Text preprocessed. Number of chunks: 1
2024-10-24 23:13:23,598 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:13:23,598 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:13:23,598 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:13:23,986 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:13:23,988 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:13:24,307 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:13:24,307 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:13:25,254 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-24 23:13:25,444 - root - INFO - embedding.py:46 - save_chunks_and_embeddings - Saving 1 chunks, their embeddings, and processed text to data/embeddings/6ee7dca7817d3b2f28a88d5e7e6121f0_chunks_embeddings.pkl.
2024-10-24 23:13:25,445 - root - INFO - embedding.py:49 - save_chunks_and_embeddings - Data saved to data/embeddings/6ee7dca7817d3b2f28a88d5e7e6121f0_chunks_embeddings.pkl.
2024-10-24 23:13:25,445 - root - INFO - cli.py:38 - load_and_process_book - Book data created. Number of chunks: 1
2024-10-24 23:13:25,445 - root - INFO - cli.py:64 - run_cli - Book loaded and preprocessed. Text split into 1 chunks
2024-10-24 23:13:47,161 - root - INFO - cli.py:74 - run_cli - Received query: ?
2024-10-24 23:13:47,162 - root - ERROR - cli.py:82 - run_cli - An error occurred: name 'openai_service' is not defined
2024-10-24 23:13:47,163 - root - INFO - cli.py:85 - run_cli - Exiting the RAG system
2024-10-24 23:19:30,918 - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:19:31,210 - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:19:31,415 - INFO - src/cli.py:54 - run_cli - Starting the RAG system
2024-10-24 23:21:10,171 - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:21:10,539 - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:21:10,907 - INFO - src/cli.py:54 - run_cli - Starting the RAG system
2024-10-24 23:21:14,822 - INFO - src/cli.py:65 - run_cli - Loading book from: tests/data/test.odt
2024-10-24 23:21:14,823 - INFO - src/cli.py:25 - load_and_process_book - Starting to process book content
2024-10-24 23:21:14,823 - INFO - src/text_processing.py:75 - load_and_preprocess_text - Preprocessing text content
2024-10-24 23:21:15,105 - INFO - src/text_processing.py:81 - load_and_preprocess_text - Extracted 0 dates, 0 named entities, and 1 key phrases from the text
2024-10-24 23:21:15,105 - INFO - src/text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 23:21:15,105 - INFO - src/text_processing.py:103 - split_into_chunks - Created 1 chunks
2024-10-24 23:21:15,105 - INFO - src/cli.py:28 - load_and_process_book - Text preprocessed. Number of chunks: 1
2024-10-24 23:21:15,797 - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:21:16,055 - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:21:17,145 - INFO - src/embedding.py:46 - save_chunks_and_embeddings - Saving 1 chunks, their embeddings, and processed text to data/embeddings/6ee7dca7817d3b2f28a88d5e7e6121f0_chunks_embeddings.pkl.
2024-10-24 23:21:17,146 - INFO - src/embedding.py:49 - save_chunks_and_embeddings - Data saved to data/embeddings/6ee7dca7817d3b2f28a88d5e7e6121f0_chunks_embeddings.pkl.
2024-10-24 23:21:17,146 - INFO - src/cli.py:38 - load_and_process_book - Book data created. Number of chunks: 1
2024-10-24 23:21:17,146 - INFO - src/cli.py:67 - run_cli - Book loaded and preprocessed. Text split into 1 chunks
2024-10-24 23:21:24,405 - INFO - src/cli.py:77 - run_cli - Received query: Что тут,
2024-10-24 23:21:24,406 - INFO - src/cli.py:43 - answer_question - Received query: Что тут,
2024-10-24 23:21:24,407 - INFO - src/rag.py:68 - rag_query - Processing RAG query: Что тут,
2024-10-24 23:21:24,726 - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:21:24,972 - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:21:25,392 - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:21:25,638 - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:21:28,317 - INFO - src/openai_service.py:40 - generate_answer - Generating answer for query: Что тут,
2024-10-24 23:21:29,626 - INFO - src/rag.py:80 - rag_query - Generated answer: The text "Что тут," translates to "What is here," but the context does not provide any additional information or content to clarify what is being referred to. The original chunk only consists of this phrase, leaving the context and meaning unclear. We do not have further details about the subject, situation, or items being referenced.
2024-10-24 23:21:29,628 - INFO - src/cli.py:46 - answer_question - Generated answer: The text "Что тут," translates to "What is here," but the context does not provide any additional information or content to clarify what is being referred to. The original chunk only consists of this phrase, leaving the context and meaning unclear. We do not have further details about the subject, situation, or items being referenced.
2024-10-24 23:23:10,658 - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:23:12,341 - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:23:13,276 - INFO - app.py:96 - <module> - Starting Flask app on port 5001
2024-10-24 23:23:14,813 - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:23:15,483 - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:23:15,802 - INFO - app.py:96 - <module> - Starting Flask app on port 5001
2024-10-24 23:24:06,127 - INFO - app.py:34 - index - Index route accessed
2024-10-24 23:24:06,129 - INFO - app.py:60 - index - Rendering index.html
2024-10-24 23:24:20,031 - INFO - app.py:34 - index - Index route accessed
2024-10-24 23:24:20,032 - INFO - app.py:36 - index - POST request received
2024-10-24 23:24:20,040 - INFO - src/file_processor.py:15 - process_file - Processing file: uploads/A_Byte_of_Python_Rus_2.01.pdf with extension: .pdf
2024-10-24 23:24:20,040 - INFO - src/file_processor.py:26 - process_file - Using processor for extension: .pdf
2024-10-24 23:24:21,175 - INFO - src/cli.py:25 - load_and_process_book - Starting to process book content
2024-10-24 23:24:21,175 - INFO - src/text_processing.py:75 - load_and_preprocess_text - Preprocessing text content
2024-10-24 23:24:25,597 - INFO - src/text_processing.py:81 - load_and_preprocess_text - Extracted 22 dates, 1232 named entities, and 5 key phrases from the text
2024-10-24 23:24:25,598 - INFO - src/text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 23:24:25,600 - INFO - src/text_processing.py:103 - split_into_chunks - Created 183 chunks
2024-10-24 23:24:25,601 - INFO - src/cli.py:28 - load_and_process_book - Text preprocessed. Number of chunks: 183
2024-10-24 23:24:25,931 - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:24:26,210 - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:25:11,189 - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:25:11,670 - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:25:12,023 - INFO - app.py:96 - <module> - Starting Flask app on port 5001
2024-10-24 23:25:19,169 - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:25:19,452 - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:25:19,747 - INFO - app.py:96 - <module> - Starting Flask app on port 5001
2024-10-24 23:25:34,044 - root - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:25:34,598 - root - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:25:34,913 - root - INFO - app.py:96 - <module> - Starting Flask app on port 5001
2024-10-24 23:25:40,974 - root - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:25:41,259 - root - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:25:41,880 - root - INFO - app.py:96 - <module> - Starting Flask app on port 5001
2024-10-24 23:25:56,962 - root - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:25:57,225 - root - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:25:57,553 - root - INFO - app.py:96 - <module> - Starting Flask app on port 5001
2024-10-24 23:26:17,399 - root - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:26:17,823 - root - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:26:18,262 - root - INFO - app.py:96 - <module> - Starting Flask app on port 5001
2024-10-24 23:26:19,291 - root - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:26:19,664 - root - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:26:20,173 - root - INFO - app.py:96 - <module> - Starting Flask app on port 5001
2024-10-24 23:26:25,094 - root - INFO - app.py:34 - index - Index route accessed
2024-10-24 23:26:25,096 - root - INFO - app.py:60 - index - Rendering index.html
2024-10-24 23:26:25,602 - root - INFO - app.py:34 - index - Index route accessed
2024-10-24 23:26:25,602 - root - INFO - app.py:60 - index - Rendering index.html
2024-10-24 23:26:31,942 - root - INFO - app.py:34 - index - Index route accessed
2024-10-24 23:26:31,942 - root - INFO - app.py:36 - index - POST request received
2024-10-24 23:26:31,950 - root - INFO - src/file_processor.py:15 - process_file - Processing file: uploads/A_Byte_of_Python_Rus_2.01.pdf with extension: .pdf
2024-10-24 23:26:31,951 - root - INFO - src/file_processor.py:26 - process_file - Using processor for extension: .pdf
2024-10-24 23:26:32,945 - root - INFO - src/cli.py:25 - load_and_process_book - Starting to process book content
2024-10-24 23:26:32,945 - root - INFO - src/text_processing.py:75 - load_and_preprocess_text - Preprocessing text content
2024-10-24 23:26:37,389 - root - INFO - src/text_processing.py:81 - load_and_preprocess_text - Extracted 22 dates, 1232 named entities, and 5 key phrases from the text
2024-10-24 23:26:37,389 - root - INFO - src/text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 23:26:37,391 - root - INFO - src/text_processing.py:103 - split_into_chunks - Created 183 chunks
2024-10-24 23:26:37,392 - root - INFO - src/cli.py:28 - load_and_process_book - Text preprocessed. Number of chunks: 183
2024-10-24 23:26:37,725 - root - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:26:38,037 - root - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:27:40,146 - root - INFO - src/embedding.py:46 - save_chunks_and_embeddings - Saving 183 chunks, their embeddings, and processed text to data/embeddings/2874edd83f926b01da779ebb81f68a45_chunks_embeddings.pkl.
2024-10-24 23:27:40,152 - root - INFO - src/embedding.py:49 - save_chunks_and_embeddings - Data saved to data/embeddings/2874edd83f926b01da779ebb81f68a45_chunks_embeddings.pkl.
2024-10-24 23:27:40,153 - root - INFO - src/cli.py:38 - load_and_process_book - Book data created. Number of chunks: 183
2024-10-24 23:27:40,153 - root - INFO - app.py:53 - index - Book data loaded: 183 chunks
2024-10-24 23:29:19,323 - root - INFO - app.py:34 - index - Index route accessed
2024-10-24 23:29:19,324 - root - INFO - app.py:36 - index - POST request received
2024-10-24 23:29:19,327 - root - WARNING - app.py:38 - index - No file part in the request
2024-10-24 23:30:34,898 - root - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:30:35,307 - root - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:30:35,674 - root - INFO - src/cli.py:54 - run_cli - Starting the RAG system
2024-10-24 23:31:15,304 - root - INFO - src/pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:31:19,092 - root - INFO - src/pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:31:19,320 - root - INFO - src/cli.py:54 - run_cli - Starting the RAG system
2024-10-24 23:34:53,274 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 23:34:53,275 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 23:34:53,282 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:34:53,283 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:34:53,292 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:34:54,979 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:34:54,982 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:34:56,579 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:34:56,579 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:34:56,812 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 23:34:56,815 - root - INFO - cli.py:54 - run_cli - Starting the RAG system
2024-10-24 23:34:56,816 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 23:34:56,817 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 23:35:11,527 - root - INFO - cli.py:65 - run_cli - Loading book from: tests/data/ford.txt
2024-10-24 23:35:11,528 - root - INFO - cli.py:25 - load_and_process_book - Starting to process book content
2024-10-24 23:35:11,528 - root - INFO - text_processing.py:75 - load_and_preprocess_text - Preprocessing text content
2024-10-24 23:35:11,825 - root - INFO - text_processing.py:81 - load_and_preprocess_text - Extracted 0 dates, 0 named entities, and 1 key phrases from the text
2024-10-24 23:35:11,825 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 23:35:11,825 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1 chunks
2024-10-24 23:35:11,825 - root - INFO - cli.py:28 - load_and_process_book - Text preprocessed. Number of chunks: 1
2024-10-24 23:35:11,825 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:35:11,826 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:35:11,826 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:35:12,203 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:35:12,203 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:35:12,596 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:35:12,596 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:35:12,598 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x10b219580>, 'json_data': {'input': ['tests/data/ford.txt'], 'model': 'text-embedding-3-small', 'encoding_format': 'base64'}}
2024-10-24 23:35:12,626 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-24 23:35:12,627 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-24 23:35:12,759 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b2c8a70>
2024-10-24 23:35:12,759 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.started ssl_context=<ssl.SSLContext object at 0x10b1237d0> server_hostname='api.openai.com' timeout=5.0
2024-10-24 23:35:12,797 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b2c9d00>
2024-10-24 23:35:12,797 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-24 23:35:12,798 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-24 23:35:12,798 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-24 23:35:12,798 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-24 23:35:12,798 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-24 23:35:13,257 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Thu, 24 Oct 2024 22:35:13 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-3-small'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'60'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999996'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'0s'), (b'x-request-id', b'req_0df48eb255c2864c8890f6ceebaea2d4'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=kfoN7.mIsyEiHfD9qMtMs5UlxzrFQwg6ykmHSZHkUwM-1729809313-1.0.1.1-uO52BWBmkdVKYIN7rSrDyhG9eInAgmzvNXa7vbi8B_KjZRqYk0wxvitjrK4A7lJWMTlO7f_mCUDWidE7d64aKg; path=/; expires=Thu, 24-Oct-24 23:05:13 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=Uxe5tyi8XzZSkhnEYxf0F_eNKsfyzKhO2OTkTWdrnB4-1729809313334-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d7d704da97d03e6-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-24 23:35:13,258 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-24 23:35:13,258 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-24 23:35:13,281 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-24 23:35:13,281 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-24 23:35:13,281 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-24 23:35:13,281 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers([('date', 'Thu, 24 Oct 2024 22:35:13 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-allow-origin', '*'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-model', 'text-embedding-3-small'), ('openai-organization', 'uinside'), ('openai-processing-ms', '60'), ('openai-version', '2020-10-01'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '5000000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '4999996'), ('x-ratelimit-reset-requests', '6ms'), ('x-ratelimit-reset-tokens', '0s'), ('x-request-id', 'req_0df48eb255c2864c8890f6ceebaea2d4'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=kfoN7.mIsyEiHfD9qMtMs5UlxzrFQwg6ykmHSZHkUwM-1729809313-1.0.1.1-uO52BWBmkdVKYIN7rSrDyhG9eInAgmzvNXa7vbi8B_KjZRqYk0wxvitjrK4A7lJWMTlO7f_mCUDWidE7d64aKg; path=/; expires=Thu, 24-Oct-24 23:05:13 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=Uxe5tyi8XzZSkhnEYxf0F_eNKsfyzKhO2OTkTWdrnB4-1729809313334-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d7d704da97d03e6-LIS'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-24 23:35:13,281 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_0df48eb255c2864c8890f6ceebaea2d4
2024-10-24 23:35:14,188 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-24 23:35:14,346 - root - INFO - embedding.py:46 - save_chunks_and_embeddings - Saving 1 chunks, their embeddings, and processed text to data/embeddings/65d642d83b720a1e924d3ebef3a845fe_chunks_embeddings.pkl.
2024-10-24 23:35:14,346 - root - INFO - embedding.py:49 - save_chunks_and_embeddings - Data saved to data/embeddings/65d642d83b720a1e924d3ebef3a845fe_chunks_embeddings.pkl.
2024-10-24 23:35:14,347 - root - INFO - cli.py:38 - load_and_process_book - Book data created. Number of chunks: 1
2024-10-24 23:35:14,347 - root - INFO - cli.py:67 - run_cli - Book loaded and preprocessed. Text split into 1 chunks
2024-10-24 23:35:29,904 - root - INFO - cli.py:77 - run_cli - Received query: Какого цвета авто?
2024-10-24 23:35:29,904 - root - INFO - cli.py:43 - answer_question - Received query: Какого цвета авто?
2024-10-24 23:35:29,905 - root - INFO - rag.py:68 - rag_query - Processing RAG query: Какого цвета авто?
2024-10-24 23:35:29,905 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:35:29,907 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:35:29,908 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:35:30,327 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:35:30,328 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:35:30,603 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:35:30,603 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:35:30,611 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:35:30,611 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:35:30,611 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:35:31,192 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:35:31,193 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:35:31,462 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:35:31,463 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:35:31,465 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x11355d9e0>, 'json_data': {'input': ['Какого цвета авто?'], 'model': 'text-embedding-3-small', 'encoding_format': 'base64'}}
2024-10-24 23:35:31,465 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-24 23:35:31,466 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.started
2024-10-24 23:35:31,466 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.complete
2024-10-24 23:35:31,466 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-24 23:35:31,502 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b2fb7a0>
2024-10-24 23:35:31,502 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.started ssl_context=<ssl.SSLContext object at 0x10b1237d0> server_hostname='api.openai.com' timeout=5.0
2024-10-24 23:35:31,542 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b2fa810>
2024-10-24 23:35:31,543 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-24 23:35:31,543 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-24 23:35:31,543 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-24 23:35:31,543 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-24 23:35:31,543 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-24 23:35:31,988 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Thu, 24 Oct 2024 22:35:32 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-3-small'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'72'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999992'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'0s'), (b'x-request-id', b'req_b5e0b85fb06abc18143b17a9ebd759f3'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d7d70c2dc08e3c4-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-24 23:35:31,990 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-24 23:35:31,990 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-24 23:35:31,998 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-24 23:35:31,998 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-24 23:35:31,998 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-24 23:35:31,998 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers({'date': 'Thu, 24 Oct 2024 22:35:32 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-allow-origin': '*', 'access-control-expose-headers': 'X-Request-ID', 'openai-model': 'text-embedding-3-small', 'openai-organization': 'uinside', 'openai-processing-ms': '72', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '5000000', 'x-ratelimit-remaining-requests': '9999', 'x-ratelimit-remaining-tokens': '4999992', 'x-ratelimit-reset-requests': '6ms', 'x-ratelimit-reset-tokens': '0s', 'x-request-id': 'req_b5e0b85fb06abc18143b17a9ebd759f3', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d7d70c2dc08e3c4-LIS', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-24 23:35:31,999 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_b5e0b85fb06abc18143b17a9ebd759f3
2024-10-24 23:35:32,792 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-24 23:35:33,726 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"results":[],"matches":[{"id":"0","score":1,"values":[],"metadata":{"chunk":"\xd0\x9a\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82\xd0\xb0 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe?"}},{"id":"c4532a84961f92ab47be24889d3090b0","score":0.25741294,"values":[],"metadata":{"text":"What was the significance of the \'crush space\' in the Pinto\'s design, and how did it compare to other vehicles?"}},{"id":"381ff60ffe74542b971aeaa2148a488c","score":0.24771373,"values":[],"metadata":{"text":"What was the model year of the Ford Pinto involved in the accident?"}},{"id":"d5ecdbd9489bb32b1d887074f67e7fa5","score":0.221266523,"values":[],"metadata":{"text":"How did the court define \'malice\' in the context of the Ford Pinto case?"}},{"id":"7c25ca08798757a5d15caefbcf6d0c6a","score":0.2174308,"values":[],"metadata":{"text":"How did Ford\'s \'rush\' development of the Pinto affect its safety design?"}},{"id":"51bf0066086639adb0a494086a5121ce","score":0.209419027,"values":[],"metadata":{"text":"Who was the executive vice president of Ford who conceived the Pinto project?"}},{"id":"032d6d9f7cf883f483068a2d1d3ea7d0","score":0.202357724,"values":[],"metadata":{"text":"What was the speed of the Ford Galaxie at the moment of impact with the Pinto?"}},{"id":"cb1f75b9db1ebda19c630ecdc7e299f0","score":0.195930511,"values":[],"metadata":{"text":"How did Ford\'s internal memo about the cost-benefit analysis of safety improvements come to light during the trial?"}},{"id":"01e59f8ef084bd6a4d99f9067667d768","score":0.192188159,"values":[],"metadata":{"text":"What was the weight target for the Pinto set by Ford?"}},{"id":"6baf920636bb0e7a14c37c499f0a135f","score":0.190332636,"values":[],"metadata":{"text":"What factors influenced the placement of the fuel tank in the Ford Pinto?"}}],"namespace":"","usage":{"readUnits":6}}'
2024-10-24 23:35:33,729 - root - INFO - openai_service.py:40 - generate_answer - Generating answer for query: Какого цвета авто?
2024-10-24 23:35:33,737 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful assistant specialized in extracting precise information from texts. Focus on providing accurate information. If the exact information is not available, explain what is known and what is missing.'}, {'role': 'user', 'content': 'Context: Original text chunks and metadata:\n\nChunk 1 (score: 1.00): Какого цвета авто?\n\nChunk 2 (score: 0.26): \n\nChunk 3 (score: 0.25): \n\nChunk 4 (score: 0.22): \n\nChunk 5 (score: 0.22): \n\nChunk 6 (score: 0.21): \n\nChunk 7 (score: 0.20): \n\nChunk 8 (score: 0.20): \n\nChunk 9 (score: 0.19): \n\nChunk 10 (score: 0.19): \n\nQuestion: Какого цвета авто?\n\nQuestion: Какого цвета авто?\n\nProvide a concise answer based on the context. If specific information is not available, briefly explain what is known and what is missing.'}], 'model': 'gpt-4o-mini', 'max_tokens': 15000}}
2024-10-24 23:35:33,737 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-24 23:35:33,738 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-24 23:35:33,773 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b2d9c10>
2024-10-24 23:35:33,773 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.started ssl_context=<ssl.SSLContext object at 0x10b1cef50> server_hostname='api.openai.com' timeout=5.0
2024-10-24 23:35:33,810 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b2d8e00>
2024-10-24 23:35:33,810 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-24 23:35:33,810 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-24 23:35:33,810 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-24 23:35:33,810 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-24 23:35:33,810 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-24 23:35:35,112 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Thu, 24 Oct 2024 22:35:35 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'1103'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9991828'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'49ms'), (b'x-request-id', b'req_f6915bc70065c3f353c1157bb5716266'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=pXdubV2CJhI87CV_cuLDriWjCoN2mOOvf.7PJlEwITM-1729809335-1.0.1.1-1QoXEavmeQkXzAKNzBFwUOBHgSt3hN_rIQHotj9KFGzfwgE9sSStrFiD4DPZ3OkPwXxtRD_IeUdGPAIPmWPadw; path=/; expires=Thu, 24-Oct-24 23:05:35 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=VwKxo.jKuhRAkHxOVoTswXlBCBA1pK7vPVVqlbUn0A8-1729809335188-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d7d70d0f981e3bd-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-24 23:35:35,112 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-24 23:35:35,113 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-24 23:35:35,113 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-24 23:35:35,113 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-24 23:35:35,113 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-24 23:35:35,113 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Thu, 24 Oct 2024 22:35:35 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'uinside'), ('openai-processing-ms', '1103'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9991828'), ('x-ratelimit-reset-requests', '6ms'), ('x-ratelimit-reset-tokens', '49ms'), ('x-request-id', 'req_f6915bc70065c3f353c1157bb5716266'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=pXdubV2CJhI87CV_cuLDriWjCoN2mOOvf.7PJlEwITM-1729809335-1.0.1.1-1QoXEavmeQkXzAKNzBFwUOBHgSt3hN_rIQHotj9KFGzfwgE9sSStrFiD4DPZ3OkPwXxtRD_IeUdGPAIPmWPadw; path=/; expires=Thu, 24-Oct-24 23:05:35 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=VwKxo.jKuhRAkHxOVoTswXlBCBA1pK7vPVVqlbUn0A8-1729809335188-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d7d70d0f981e3bd-LIS'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-24 23:35:35,113 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_f6915bc70065c3f353c1157bb5716266
2024-10-24 23:35:35,119 - root - INFO - rag.py:80 - rag_query - Generated answer: The context does not provide specific information about the color of the car. The only available text is a repeated question, "Какого цвета авто?" (which means "What color is the car?"). Therefore, we know the question being asked but lack any details regarding the actual color of the car.
2024-10-24 23:35:35,123 - root - INFO - cli.py:46 - answer_question - Generated answer: The context does not provide specific information about the color of the car. The only available text is a repeated question, "Какого цвета авто?" (which means "What color is the car?"). Therefore, we know the question being asked but lack any details regarding the actual color of the car.
2024-10-24 23:35:58,923 - root - INFO - cli.py:77 - run_cli - Received query: Какой модельный год и марка?
2024-10-24 23:35:58,924 - root - INFO - cli.py:43 - answer_question - Received query: Какой модельный год и марка?
2024-10-24 23:35:58,924 - root - INFO - rag.py:68 - rag_query - Processing RAG query: Какой модельный год и марка?
2024-10-24 23:35:58,924 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:35:58,925 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:35:58,925 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:35:59,342 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:35:59,343 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:35:59,971 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:35:59,971 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:35:59,972 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:35:59,972 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:35:59,972 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:36:00,373 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:36:00,374 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:36:00,687 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:36:00,688 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:36:00,689 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x11355da80>, 'json_data': {'input': ['Какой модельный год и марка?'], 'model': 'text-embedding-3-small', 'encoding_format': 'base64'}}
2024-10-24 23:36:00,690 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-24 23:36:00,691 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.started
2024-10-24 23:36:00,691 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.complete
2024-10-24 23:36:00,691 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-24 23:36:00,816 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b2e7a70>
2024-10-24 23:36:00,817 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.started ssl_context=<ssl.SSLContext object at 0x10b1237d0> server_hostname='api.openai.com' timeout=5.0
2024-10-24 23:36:00,863 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b2e7740>
2024-10-24 23:36:00,864 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-24 23:36:00,864 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-24 23:36:00,864 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-24 23:36:00,867 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-24 23:36:00,872 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-24 23:36:01,095 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Thu, 24 Oct 2024 22:36:01 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-3-small'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'67'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999987'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'0s'), (b'x-request-id', b'req_6490e4374ddfffe072cd4a1dc6a6af31'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d7d717a1f127113-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-24 23:36:01,095 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-24 23:36:01,096 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-24 23:36:01,096 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-24 23:36:01,096 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-24 23:36:01,096 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-24 23:36:01,097 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers({'date': 'Thu, 24 Oct 2024 22:36:01 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-allow-origin': '*', 'access-control-expose-headers': 'X-Request-ID', 'openai-model': 'text-embedding-3-small', 'openai-organization': 'uinside', 'openai-processing-ms': '67', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '5000000', 'x-ratelimit-remaining-requests': '9999', 'x-ratelimit-remaining-tokens': '4999987', 'x-ratelimit-reset-requests': '6ms', 'x-ratelimit-reset-tokens': '0s', 'x-request-id': 'req_6490e4374ddfffe072cd4a1dc6a6af31', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d7d717a1f127113-LIS', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-24 23:36:01,097 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_6490e4374ddfffe072cd4a1dc6a6af31
2024-10-24 23:36:01,920 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-24 23:36:02,685 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"results":[],"matches":[{"id":"0","score":1,"values":[],"metadata":{"chunk":"\xd0\x9a\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xb4\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd0\xb9 \xd0\xb3\xd0\xbe\xd0\xb4 \xd0\xb8 \xd0\xbc\xd0\xb0\xd1\x80\xd0\xba\xd0\xb0?"}},{"id":"381ff60ffe74542b971aeaa2148a488c","score":0.413662314,"values":[],"metadata":{"text":"What was the model year of the Ford Pinto involved in the accident?"}},{"id":"c4532a84961f92ab47be24889d3090b0","score":0.260540605,"values":[],"metadata":{"text":"What was the significance of the \'crush space\' in the Pinto\'s design, and how did it compare to other vehicles?"}},{"id":"27","score":0.246054545,"values":[],"metadata":{"chunk":". . 125 17.2 \xd0\x9c\xd0\xbe\xd0\xb4\xd1\x83\xd0\xbb\xd1\x8clogging . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 126 17.3 \xd0\xa1\xd0\xb5\xd1\x80\xd0\xb8\xd1\x8f\xc2\xab\xd0\x9c\xd0\xbe\xd0\xb4\xd1\x83\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xc2\xbb . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 128 17.4 \xd0\xa0\xd0\xb5\xd0\xb7\xd1\x8e\xd0\xbc\xd0\xb5 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 128 18 \xd0\x94\xd0\xbe\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xbd\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe 129 18.1 \xd0\x9f\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb0\xd0\xba\xd0\xbe\xd1\x80\xd1\x82\xd0\xb5\xd0\xb6\xd0\xb5\xd0\xb9 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 129 18.2 \xd0\xa1\xd0\xbf\xd0\xb5\xd1\x86\xd0\xb8\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd0\xb5\xd0\xbc\xd0\xb5\xd1\x82\xd0\xbe\xd0\xb4\xd1\x8b . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 130 18.3 \xd0\x91\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb8\xd0\xb2\xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb2\xd1\x8b\xd1\x80\xd0\xb0\xd0\xb6\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 130 18.4 Lambda-\xd1\x84\xd0\xbe\xd1\x80\xd0\xbc\xd1\x8b . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 131 18.5 \xd0\x93\xd0\xb5\xd0\xbd\xd0\xb5\xd1\x80\xd0\xb0\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd1\x81\xd0\xbf\xd0\xb8\xd1\x81\xd0\xba\xd0\xbe\xd0\xb2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ."}},{"id":"7c25ca08798757a5d15caefbcf6d0c6a","score":0.245544374,"values":[],"metadata":{"text":"How did Ford\'s \'rush\' development of the Pinto affect its safety design?"}},{"id":"4af6bd37a7ac7aa66d6fa4606aaa82b0","score":0.223532379,"values":[],"metadata":{"text":"What was the estimated cost to fix the Pinto\'s fuel tank design, and how did Ford justify not implementing it?"}},{"id":"34d53f2e1e7ce76e0573ae33e295b16d","score":0.222371861,"values":[],"metadata":{"text":"What evidence suggested that Ford was aware of the Pinto\'s safety issues before its release?"}},{"id":"51bf0066086639adb0a494086a5121ce","score":0.217901215,"values":[],"metadata":{"text":"Who was the executive vice president of Ford who conceived the Pinto project?"}},{"id":"032d6d9f7cf883f483068a2d1d3ea7d0","score":0.213339031,"values":[],"metadata":{"text":"What was the speed of the Ford Galaxie at the moment of impact with the Pinto?"}},{"id":"01e59f8ef084bd6a4d99f9067667d768","score":0.211256489,"values":[],"metadata":{"text":"What was the weight target for the Pinto set by Ford?"}}],"namespace":"","usage":{"readUnits":6}}'
2024-10-24 23:36:02,687 - root - INFO - openai_service.py:40 - generate_answer - Generating answer for query: Какой модельный год и марка?
2024-10-24 23:36:02,700 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': 'You are a helpful assistant specialized in extracting precise information from texts. Focus on providing accurate information. If the exact information is not available, explain what is known and what is missing.'}, {'role': 'user', 'content': 'Context: Original text chunks and metadata:\n\nChunk 1 (score: 1.00): Какой модельный год и марка?\n\nChunk 2 (score: 0.41): \n\nChunk 3 (score: 0.26): \n\nChunk 4 (score: 0.25): . . 125 17.2 Модульlogging . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 126 17.3 Серия«Модульнедели» . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 128 17.4 Резюме . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 128 18 Дополнительно 129 18.1 Передачакортежей . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 129 18.2 Специальныеметоды . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 130 18.3 Блокиводновыражение . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 130 18.4 Lambda-формы . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 131 18.5 Генераторысписков . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n\nChunk 5 (score: 0.25): \n\nChunk 6 (score: 0.22): \n\nChunk 7 (score: 0.22): \n\nChunk 8 (score: 0.22): \n\nChunk 9 (score: 0.21): \n\nChunk 10 (score: 0.21): \n\nQuestion: Какой модельный год и марка?\n\nQuestion: Какой модельный год и марка?\n\nProvide a concise answer based on the context. If specific information is not available, briefly explain what is known and what is missing.'}], 'model': 'gpt-4o-mini', 'max_tokens': 15000}}
2024-10-24 23:36:02,701 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-24 23:36:02,701 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.started
2024-10-24 23:36:02,702 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.complete
2024-10-24 23:36:02,702 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-24 23:36:02,740 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b2f34d0>
2024-10-24 23:36:02,741 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.started ssl_context=<ssl.SSLContext object at 0x10b1cef50> server_hostname='api.openai.com' timeout=5.0
2024-10-24 23:36:02,783 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b2fa2d0>
2024-10-24 23:36:02,783 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-24 23:36:02,784 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-24 23:36:02,784 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-24 23:36:02,784 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-24 23:36:02,784 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-24 23:36:03,656 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Thu, 24 Oct 2024 22:36:03 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'687'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9991828'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'49ms'), (b'x-request-id', b'req_e2fc74bf3598bcd3188ed07ff28345d1'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d7d71860d7c48a4-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-24 23:36:03,657 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-24 23:36:03,657 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-24 23:36:03,657 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-24 23:36:03,657 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-24 23:36:03,657 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-24 23:36:03,657 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Thu, 24 Oct 2024 22:36:03 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'uinside', 'openai-processing-ms': '687', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000000', 'x-ratelimit-remaining-requests': '9999', 'x-ratelimit-remaining-tokens': '9991828', 'x-ratelimit-reset-requests': '6ms', 'x-ratelimit-reset-tokens': '49ms', 'x-request-id': 'req_e2fc74bf3598bcd3188ed07ff28345d1', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d7d71860d7c48a4-LIS', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-24 23:36:03,657 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_e2fc74bf3598bcd3188ed07ff28345d1
2024-10-24 23:36:03,658 - root - INFO - rag.py:80 - rag_query - Generated answer: The context provided does not contain any information regarding the model year or brand of a vehicle. It only includes a question asking for that information and some unrelated text chunks that do not address the inquiry. Therefore, the specific information about the model year and brand is missing.
2024-10-24 23:36:03,661 - root - INFO - cli.py:46 - answer_question - Generated answer: The context provided does not contain any information regarding the model year or brand of a vehicle. It only includes a question asking for that information and some unrelated text chunks that do not address the inquiry. Therefore, the specific information about the model year and brand is missing.
2024-10-24 23:36:50,922 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 23:36:50,923 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 23:36:50,930 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:36:50,930 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:36:50,938 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:36:51,266 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:36:51,269 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:36:51,599 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:36:51,600 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:36:51,832 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 23:36:51,840 - root - INFO - cli.py:54 - run_cli - Starting the RAG system
2024-10-24 23:36:51,841 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 23:36:51,842 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 23:37:06,298 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 23:37:06,299 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 23:37:06,306 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:37:06,306 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:37:06,317 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:37:06,645 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:37:06,647 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:37:07,156 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:37:07,156 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:37:07,553 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 23:37:08,517 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 23:37:08,519 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 23:37:08,525 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:37:08,525 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:37:08,529 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:37:08,836 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:37:08,837 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:37:09,195 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:37:09,195 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:37:09,506 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 23:44:42,934 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 23:44:42,935 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 23:44:42,942 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:44:42,943 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:44:42,951 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:44:43,513 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:44:43,513 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:44:43,839 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:44:43,839 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:44:45,061 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 23:45:33,108 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 23:45:33,109 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 23:45:33,117 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:45:33,117 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:45:33,126 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:45:34,597 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:45:34,597 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:45:36,976 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:45:36,977 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:45:37,204 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 23:47:00,208 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 23:47:00,209 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 23:47:00,216 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:47:00,216 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:47:00,224 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:47:00,545 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:47:00,547 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:47:00,886 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:47:00,886 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:47:01,173 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 23:47:34,229 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 23:47:34,230 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 23:47:34,238 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:47:34,239 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:47:34,248 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:47:34,607 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:47:34,609 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:47:35,105 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:47:35,106 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:47:35,366 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 23:49:22,741 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 23:49:22,741 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 23:49:22,748 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:49:22,748 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:49:22,756 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:49:23,076 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:49:23,077 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:49:23,430 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:49:23,430 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:49:23,662 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-24 23:49:23,668 - root - INFO - cli.py:53 - run_cli - Starting the RAG system
2024-10-24 23:49:23,669 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-24 23:49:23,670 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-24 23:49:37,109 - root - INFO - cli.py:64 - run_cli - Loading book from: uploads/ford.txt
2024-10-24 23:49:37,109 - root - INFO - cli.py:25 - load_and_process_book - Starting to process book content
2024-10-24 23:49:37,109 - root - INFO - text_processing.py:75 - load_and_preprocess_text - Preprocessing text content
2024-10-24 23:49:37,391 - root - INFO - text_processing.py:81 - load_and_preprocess_text - Extracted 0 dates, 0 named entities, and 1 key phrases from the text
2024-10-24 23:49:37,392 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-24 23:49:37,392 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1 chunks
2024-10-24 23:49:37,392 - root - INFO - cli.py:28 - load_and_process_book - Text preprocessed. Number of chunks: 1
2024-10-24 23:49:37,392 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-24 23:49:37,392 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-24 23:49:37,392 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-24 23:49:37,869 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-24 23:49:37,869 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-24 23:49:38,130 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-24 23:49:38,130 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-24 23:49:38,131 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x10b2a5580>, 'json_data': {'input': ['uploads/ford.txt'], 'model': 'text-embedding-3-small', 'encoding_format': 'base64'}}
2024-10-24 23:49:38,157 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-24 23:49:38,158 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-24 23:49:38,333 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b3546e0>
2024-10-24 23:49:38,333 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.started ssl_context=<ssl.SSLContext object at 0x10b1af7d0> server_hostname='api.openai.com' timeout=5.0
2024-10-24 23:49:38,374 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10b355580>
2024-10-24 23:49:38,374 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-24 23:49:38,375 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-24 23:49:38,375 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-24 23:49:38,375 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-24 23:49:38,376 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-24 23:49:38,614 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Thu, 24 Oct 2024 22:49:38 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-3-small'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'81'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999995'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'0s'), (b'x-request-id', b'req_c7732d411f6065ec06feb83fd0d2d681'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=r.UFYyjc0_cKbWE895adTbhJKBmD5N0vllmcL66LWZM-1729810178-1.0.1.1-f5TzV564f3wVQExD5xK44NGFw3od_D9BC2UIUDSpziLtaeT_2B_EsI1mkuZVvbE14Lb6SDFchwkXsm3rfbeghA; path=/; expires=Thu, 24-Oct-24 23:19:38 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=83TyLY6shvFwCQREEkLzj7WwUJloVPEJtBnI8tHB5_Q-1729810178669-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d7d856f6c92785f-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-24 23:49:38,616 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-24 23:49:38,616 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-24 23:49:38,617 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-24 23:49:38,617 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-24 23:49:38,618 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-24 23:49:38,618 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers([('date', 'Thu, 24 Oct 2024 22:49:38 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-allow-origin', '*'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-model', 'text-embedding-3-small'), ('openai-organization', 'uinside'), ('openai-processing-ms', '81'), ('openai-version', '2020-10-01'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '5000000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '4999995'), ('x-ratelimit-reset-requests', '6ms'), ('x-ratelimit-reset-tokens', '0s'), ('x-request-id', 'req_c7732d411f6065ec06feb83fd0d2d681'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=r.UFYyjc0_cKbWE895adTbhJKBmD5N0vllmcL66LWZM-1729810178-1.0.1.1-f5TzV564f3wVQExD5xK44NGFw3od_D9BC2UIUDSpziLtaeT_2B_EsI1mkuZVvbE14Lb6SDFchwkXsm3rfbeghA; path=/; expires=Thu, 24-Oct-24 23:19:38 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=83TyLY6shvFwCQREEkLzj7WwUJloVPEJtBnI8tHB5_Q-1729810178669-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d7d856f6c92785f-LIS'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-24 23:49:38,618 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_c7732d411f6065ec06feb83fd0d2d681
2024-10-24 23:49:39,643 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-24 23:49:39,835 - root - INFO - embedding.py:46 - save_chunks_and_embeddings - Saving 1 chunks, their embeddings, and processed text to data/embeddings/f516f4df12faa415bf60a3e635a5fd4a_chunks_embeddings.pkl.
2024-10-24 23:49:39,835 - root - INFO - embedding.py:49 - save_chunks_and_embeddings - Data saved to data/embeddings/f516f4df12faa415bf60a3e635a5fd4a_chunks_embeddings.pkl.
2024-10-24 23:49:39,835 - root - INFO - cli.py:38 - load_and_process_book - Book data created. Number of chunks: 1
2024-10-24 23:49:39,835 - root - INFO - cli.py:66 - run_cli - Book loaded and preprocessed. Text split into 1 chunks
2024-10-24 23:50:08,102 - root - INFO - cli.py:76 - run_cli - Received query: Опиши инцидент произошедший с машиной
2024-10-24 23:50:08,103 - root - INFO - cli.py:43 - answer_question - Received query: Опиши инцидент произошедший с машиной
2024-10-24 23:50:08,103 - root - INFO - rag.py:67 - rag_query - Processing query: Опиши инцидент произошедший с машиной
2024-10-24 23:50:08,103 - root - ERROR - rag.py:76 - rag_query - Error in rag_query: 'BookDataInterface' object has no attribute 'get_relevant_chunks'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 69, in rag_query
    relevant_chunks = book_data.get_relevant_chunks(question)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'BookDataInterface' object has no attribute 'get_relevant_chunks'
2024-10-24 23:50:08,106 - root - INFO - cli.py:46 - answer_question - Generated answer: An error occurred while processing the query: 'BookDataInterface' object has no attribute 'get_relevant_chunks'
2024-10-25 13:52:01,401 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 13:52:01,402 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 13:52:01,408 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:52:01,409 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:52:01,418 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:52:02,084 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:52:02,087 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:52:02,427 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:52:02,428 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:52:02,823 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 13:52:04,552 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-25 13:52:04,566 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1389 chunks
2024-10-25 13:52:04,569 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:52:04,569 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:52:04,569 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:52:05,017 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:52:05,019 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:52:06,465 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:52:06,465 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:52:33,410 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"code":11,"message":"Error, message length too large: found 13124219 bytes, the limit is: 4194304 bytes","details":[]}'
2024-10-25 13:52:34,020 - root - INFO - conftest.py:58 - timer - Test test_main_cli_mode took 0.00 seconds
2024-10-25 13:52:34,021 - root - INFO - conftest.py:58 - timer - Test test_main_api_mode took 0.00 seconds
2024-10-25 13:52:34,021 - root - INFO - conftest.py:58 - timer - Test test_main_invalid_mode took 0.00 seconds
2024-10-25 13:52:34,022 - root - INFO - cli.py:25 - load_and_process_book - Starting to process book content
2024-10-25 13:52:34,022 - root - INFO - cli.py:28 - load_and_process_book - Text preprocessed. Number of chunks: 2
2024-10-25 13:52:34,022 - root - INFO - cli.py:38 - load_and_process_book - Book data created. Number of chunks: 2
2024-10-25 13:52:34,022 - root - INFO - conftest.py:58 - timer - Test test_load_and_process_book took 0.00 seconds
2024-10-25 13:52:34,025 - root - INFO - conftest.py:58 - timer - Test test_answer_question took 0.00 seconds
2024-10-25 13:52:34,026 - root - INFO - cli.py:53 - run_cli - Starting the RAG system
2024-10-25 13:52:34,027 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 13:52:34,027 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 13:52:34,034 - root - INFO - cli.py:64 - run_cli - Loading book from: input1
2024-10-25 13:52:34,035 - root - INFO - cli.py:66 - run_cli - Book loaded and preprocessed. Text split into 2 chunks
2024-10-25 13:52:34,035 - root - ERROR - cli.py:84 - run_cli - An error occurred: 
2024-10-25 13:52:34,035 - root - INFO - cli.py:87 - run_cli - Exiting the RAG system
2024-10-25 13:52:34,036 - root - INFO - conftest.py:58 - timer - Test test_run_cli[input1] took 0.01 seconds
2024-10-25 13:52:34,037 - root - INFO - cli.py:53 - run_cli - Starting the RAG system
2024-10-25 13:52:34,038 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 13:52:34,038 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 13:52:34,044 - root - INFO - cli.py:64 - run_cli - Loading book from: input2
2024-10-25 13:52:34,044 - root - INFO - cli.py:66 - run_cli - Book loaded and preprocessed. Text split into 2 chunks
2024-10-25 13:52:34,044 - root - ERROR - cli.py:84 - run_cli - An error occurred: 
2024-10-25 13:52:34,044 - root - INFO - cli.py:87 - run_cli - Exiting the RAG system
2024-10-25 13:52:34,045 - root - INFO - conftest.py:58 - timer - Test test_run_cli[input2] took 0.01 seconds
2024-10-25 13:52:34,046 - root - INFO - cli.py:53 - run_cli - Starting the RAG system
2024-10-25 13:52:34,046 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 13:52:34,046 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 13:52:34,052 - root - ERROR - cli.py:84 - run_cli - An error occurred: The file nonexistent_file.txt does not exist.
2024-10-25 13:52:34,052 - root - INFO - cli.py:87 - run_cli - Exiting the RAG system
2024-10-25 13:52:34,053 - root - INFO - conftest.py:58 - timer - Test test_run_cli_file_not_found took 0.01 seconds
2024-10-25 13:52:34,053 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:52:34,054 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:52:34,054 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:52:34,555 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:52:34,557 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:52:34,928 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:52:34,928 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:52:35,891 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":2}'
2024-10-25 13:52:35,893 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_length[chunks0-2] took 1.84 seconds
2024-10-25 13:52:35,897 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:52:35,897 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:52:35,898 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:52:36,420 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:52:36,422 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:52:36,700 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:52:36,701 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:52:37,445 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 13:52:37,448 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_length[chunks1-1] took 1.55 seconds
2024-10-25 13:52:37,452 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:52:37,453 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:52:37,453 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:52:38,044 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:52:38,046 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:52:38,449 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:52:38,449 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:52:38,452 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_length[chunks2-0] took 1.00 seconds
2024-10-25 13:52:38,455 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:52:38,455 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:52:38,456 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:52:38,796 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:52:38,798 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:52:39,475 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:52:39,476 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:52:40,248 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 13:52:40,257 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_structure took 1.80 seconds
2024-10-25 13:52:40,259 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:52:40,260 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:52:40,260 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:52:40,629 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:52:40,631 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:52:40,951 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:52:40,952 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:52:40,979 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_api_error took 0.72 seconds
2024-10-25 13:52:40,982 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:52:40,982 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:52:40,982 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:52:41,297 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:52:41,298 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:52:41,713 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:52:41,714 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:52:41,717 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_various_lengths[-1536] took 0.74 seconds
2024-10-25 13:52:41,723 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:52:41,723 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:52:41,724 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:52:42,105 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:52:42,107 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:52:42,797 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:52:42,798 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:52:42,801 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_various_lengths[Short text-1536] took 1.08 seconds
2024-10-25 13:52:42,806 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:52:42,806 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:52:42,807 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:52:43,113 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:52:43,114 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:52:43,624 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:52:43,625 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:52:43,630 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_various_lengths[AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA-1536] took 0.83 seconds
2024-10-25 13:52:43,635 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings_with_cache took 0.00 seconds
2024-10-25 13:52:43,637 - root - INFO - file_processor.py:15 - process_file - Processing file: /Users/eduardizgorodin/Projects/rag_book_assistant/tests/data/test.pdf with extension: .pdf
2024-10-25 13:52:43,638 - root - INFO - file_processor.py:26 - process_file - Using processor for extension: .pdf
2024-10-25 13:52:43,641 - root - INFO - conftest.py:58 - timer - Test test_process_pdf took 0.00 seconds
2024-10-25 13:52:43,643 - root - INFO - file_processor.py:15 - process_file - Processing file: /Users/eduardizgorodin/Projects/rag_book_assistant/tests/data/test.docx with extension: .docx
2024-10-25 13:52:43,643 - root - INFO - file_processor.py:26 - process_file - Using processor for extension: .docx
2024-10-25 13:52:43,660 - root - INFO - conftest.py:58 - timer - Test test_process_docx took 0.02 seconds
2024-10-25 13:52:43,661 - root - INFO - file_processor.py:15 - process_file - Processing file: /Users/eduardizgorodin/Projects/rag_book_assistant/tests/data/test.odt with extension: .odt
2024-10-25 13:52:43,661 - root - INFO - file_processor.py:26 - process_file - Using processor for extension: .odt
2024-10-25 13:52:43,665 - root - INFO - conftest.py:58 - timer - Test test_process_odt took 0.00 seconds
2024-10-25 13:52:43,666 - root - INFO - file_processor.py:15 - process_file - Processing file: /Users/eduardizgorodin/Projects/rag_book_assistant/tests/data/test.txt with extension: .txt
2024-10-25 13:52:43,666 - root - INFO - file_processor.py:26 - process_file - Using processor for extension: .txt
2024-10-25 13:52:43,667 - root - INFO - conftest.py:58 - timer - Test test_process_txt took 0.00 seconds
2024-10-25 13:52:43,669 - root - INFO - file_processor.py:15 - process_file - Processing file: /private/var/folders/dd/70xsqyd921gd18src4pk119r0000gn/T/pytest-of-eduardizgorodin/pytest-11/test_unsupported_file_format0/test.unsupported with extension: .unsupported
2024-10-25 13:52:43,669 - root - ERROR - file_processor.py:29 - process_file - Unsupported file format: .unsupported
2024-10-25 13:52:43,670 - root - INFO - conftest.py:58 - timer - Test test_unsupported_file_format took 0.00 seconds
2024-10-25 13:52:43,671 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-25 13:52:43,674 - root - INFO - text_processing.py:103 - split_into_chunks - Created 199 chunks
2024-10-25 13:52:43,678 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:52:43,678 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:52:43,678 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:52:44,113 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:52:44,114 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:52:44,770 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:52:44,770 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:52:44,817 - root - INFO - rag.py:67 - rag_query - Processing query: What was the model year of the Ford Pinto involved in the accident?
2024-10-25 13:52:44,817 - root - ERROR - rag.py:76 - rag_query - Error in rag_query: 'BookDataInterface' object has no attribute 'get_relevant_chunks'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 69, in rag_query
    relevant_chunks = book_data.get_relevant_chunks(question)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'BookDataInterface' object has no attribute 'get_relevant_chunks'
2024-10-25 13:52:44,841 - rag_results - INFO - test_ford_pinto_qa.py:94 - test_qa_system - 
Q: What was the model year of the Ford Pinto involved in the accident?
2024-10-25 13:52:44,841 - rag_results - INFO - test_ford_pinto_qa.py:95 - test_qa_system - Expected A: 1972
2024-10-25 13:52:44,841 - rag_results - INFO - test_ford_pinto_qa.py:96 - test_qa_system - System A: An error occurred while processing the query: 'BookDataInterface' object has no attribute 'get_relevant_chunks'
2024-10-25 13:52:44,841 - rag_results - INFO - test_ford_pinto_qa.py:97 - test_qa_system - Is correct: False
2024-10-25 13:52:44,841 - rag_results - INFO - test_ford_pinto_qa.py:98 - test_qa_system - --------------------------------------------------
2024-10-25 13:52:44,844 - root - INFO - conftest.py:58 - timer - Test test_qa_system[qa_pair0] took 0.03 seconds
2024-10-25 13:52:44,851 - root - INFO - conftest.py:58 - timer - Test test_search took 0.01 seconds
2024-10-25 13:52:44,854 - root - INFO - conftest.py:58 - timer - Test test_embedding_weight took 0.00 seconds
2024-10-25 13:52:44,855 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search_initialization took 0.00 seconds
2024-10-25 13:52:46,197 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:52:46,197 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:52:46,197 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:52:46,497 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:52:46,498 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:52:46,797 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:52:46,797 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:52:46,803 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x158a1e020>, 'json_data': {'input': ['AI AI AI AI AI AI AI AI AI AI AI AI AI AI AI ai ai ai ai ai ai ai ai ai ai ai ai ai Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence and and and and and and and and and and machine machine machine machine machine machine machine machine machine machine machine machine machine machine machine simple_machine simple_machine simple_machine simple_machine simple_machine simple_machine simple_machine simple_machine simple_machine simple_machine simple_machine simple_machine simple_machine simple_machine simple_machine motorcar motorcar motorcar motorcar motorcar motorcar motorcar motorcar motorcar motorcar motorcar motorcar motorcar motorcar motorcar learning learning learning learning learning learning learning learning learning learning learning learning learning find_out find_out find_out find_out find_out find_out find_out find_out find_out find_out find_out find_out find_out find_out find_out learnedness learnedness learnedness learnedness learnedness learnedness learnedness learnedness learnedness learnedness learnedness learnedness learnedness learnedness learnedness'], 'model': 'text-embedding-3-small', 'encoding_format': 'base64'}}
2024-10-25 13:52:46,859 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-25 13:52:46,859 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-25 13:52:47,003 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x10bff1ee0>
2024-10-25 13:52:47,003 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.started ssl_context=<ssl.SSLContext object at 0x10d2f7b50> server_hostname='api.openai.com' timeout=5.0
2024-10-25 13:52:47,048 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x1621d9640>
2024-10-25 13:52:47,048 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-25 13:52:47,049 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-25 13:52:47,050 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-25 13:52:47,050 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-25 13:52:47,050 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-25 13:52:47,605 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 25 Oct 2024 12:52:47 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-3-small'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'174'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999673'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'3ms'), (b'x-request-id', b'req_bd03629d3992fc42166bcdaf66c2bc36'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=BDLCyGwvYUCQ9YXeeVV6S.KP7e8vswhLN5qqYV5wH.8-1729860767-1.0.1.1-b3Le1P9chGlXoLFWmEByUqdKp806wLy9oWXDw3Uq66hZpq9mQ542KCy7Vp6wdm4NVZ1fiO7kaEwvPWCM6I9fQQ; path=/; expires=Fri, 25-Oct-24 13:22:47 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=BnkyF.7MTbJn3AggY7XCnPuvxlQjiXc5uNnRofXRvzo-1729860767688-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d825882cc44e3bd-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-25 13:52:47,607 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-25 13:52:47,608 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-25 13:52:47,609 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-25 13:52:47,609 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-25 13:52:47,609 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-25 13:52:47,610 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers([('date', 'Fri, 25 Oct 2024 12:52:47 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-allow-origin', '*'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-model', 'text-embedding-3-small'), ('openai-organization', 'uinside'), ('openai-processing-ms', '174'), ('openai-version', '2020-10-01'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '5000000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '4999673'), ('x-ratelimit-reset-requests', '6ms'), ('x-ratelimit-reset-tokens', '3ms'), ('x-request-id', 'req_bd03629d3992fc42166bcdaf66c2bc36'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=BDLCyGwvYUCQ9YXeeVV6S.KP7e8vswhLN5qqYV5wH.8-1729860767-1.0.1.1-b3Le1P9chGlXoLFWmEByUqdKp806wLy9oWXDw3Uq66hZpq9mQ542KCy7Vp6wdm4NVZ1fiO7kaEwvPWCM6I9fQQ; path=/; expires=Fri, 25-Oct-24 13:22:47 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=BnkyF.7MTbJn3AggY7XCnPuvxlQjiXc5uNnRofXRvzo-1729860767688-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d825882cc44e3bd-LIS'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-25 13:52:47,610 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_bd03629d3992fc42166bcdaf66c2bc36
2024-10-25 13:52:48,431 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 13:52:48,438 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search_search took 3.58 seconds
2024-10-25 13:52:48,442 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:52:48,443 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:52:48,443 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:52:48,776 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:52:48,777 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:52:49,146 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:52:49,147 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:52:49,150 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x15dfb7e20>, 'json_data': {'input': ['AI AI AI AI AI AI AI AI AI AI AI AI AI AI AI ai ai ai ai ai ai ai ai ai ai ai ai ai Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence Army_Intelligence'], 'model': 'text-embedding-3-small', 'encoding_format': 'base64'}}
2024-10-25 13:52:49,152 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-25 13:52:49,153 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-25 13:52:49,153 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-25 13:52:49,153 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-25 13:52:49,154 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-25 13:52:49,154 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-25 13:52:49,926 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 25 Oct 2024 12:52:50 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-3-small'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'205'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999912'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'1ms'), (b'x-request-id', b'req_e17e3eedb2da9aa0c634836032950f4f'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d82588febeae3bd-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-25 13:52:49,927 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-25 13:52:49,928 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-25 13:52:49,929 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-25 13:52:49,930 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-25 13:52:49,930 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-25 13:52:49,930 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers({'date': 'Fri, 25 Oct 2024 12:52:50 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-allow-origin': '*', 'access-control-expose-headers': 'X-Request-ID', 'openai-model': 'text-embedding-3-small', 'openai-organization': 'uinside', 'openai-processing-ms': '205', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '5000000', 'x-ratelimit-remaining-requests': '9999', 'x-ratelimit-remaining-tokens': '4999912', 'x-ratelimit-reset-requests': '6ms', 'x-ratelimit-reset-tokens': '1ms', 'x-request-id': 'req_e17e3eedb2da9aa0c634836032950f4f', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d82588febeae3bd-LIS', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-25 13:52:49,930 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_e17e3eedb2da9aa0c634836032950f4f
2024-10-25 13:52:50,795 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 13:52:50,800 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:52:50,802 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:52:50,802 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:52:51,126 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:52:51,128 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:52:51,760 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:52:51,761 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:52:52,682 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 13:52:52,686 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search_embedding_weight took 4.25 seconds
2024-10-25 13:52:52,713 - root - INFO - conftest.py:58 - timer - Test test_imports took 0.03 seconds
2024-10-25 13:52:52,714 - root - INFO - conftest.py:58 - timer - Test test_config_import took 0.00 seconds
2024-10-25 13:52:52,716 - root - INFO - conftest.py:58 - timer - Test test_openai_api_key took 0.00 seconds
2024-10-25 13:52:52,717 - root - INFO - text_processing.py:75 - load_and_preprocess_text - Preprocessing text content
2024-10-25 13:52:52,894 - root - INFO - text_processing.py:81 - load_and_preprocess_text - Extracted 0 dates, 0 named entities, and 1 key phrases from the text
2024-10-25 13:52:52,894 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-25 13:52:52,894 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1 chunks
2024-10-25 13:52:52,894 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 1000, overlap: 100)
2024-10-25 13:52:52,894 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1 chunks
2024-10-25 13:52:52,895 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:52:52,895 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:52:52,895 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:52:53,399 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:52:53,401 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:52:53,804 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:52:53,805 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:52:54,689 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 13:52:54,690 - root - INFO - conftest.py:58 - timer - Test test_different_book_types[True-test_book.txt] took 1.97 seconds
2024-10-25 13:52:54,691 - root - INFO - text_processing.py:75 - load_and_preprocess_text - Preprocessing text content
2024-10-25 13:52:54,841 - root - INFO - text_processing.py:81 - load_and_preprocess_text - Extracted 0 dates, 0 named entities, and 1 key phrases from the text
2024-10-25 13:52:54,841 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-25 13:52:54,841 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1 chunks
2024-10-25 13:52:54,841 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 1000, overlap: 100)
2024-10-25 13:52:54,841 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1 chunks
2024-10-25 13:52:54,841 - root - INFO - conftest.py:58 - timer - Test test_different_book_types[False-test_book.txt] took 0.15 seconds
2024-10-25 13:52:54,842 - root - INFO - conftest.py:58 - timer - Test test_rag_query[True] took 0.00 seconds
2024-10-25 13:52:54,843 - root - INFO - conftest.py:58 - timer - Test test_rag_query[False] took 0.00 seconds
2024-10-25 13:52:54,950 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:52:55,602 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:52:56,834 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:52:59,065 - root - INFO - pinecone_manager.py:80 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:52:59,477 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:52:59,546 - root - INFO - conftest.py:58 - timer - Test test_pinecone_integration took 4.70 seconds
2024-10-25 13:52:59,547 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 13:52:59,547 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 13:52:59,555 - root - INFO - openai_service.py:40 - generate_answer - Generating answer for query: Test query
2024-10-25 13:52:59,556 - root - INFO - conftest.py:58 - timer - Test test_generate_answer took 0.01 seconds
2024-10-25 13:52:59,556 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 13:52:59,557 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 13:52:59,565 - root - INFO - conftest.py:58 - timer - Test test_create_embeddings took 0.01 seconds
2024-10-25 13:52:59,565 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 13:52:59,566 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 13:52:59,573 - root - INFO - conftest.py:58 - timer - Test test_handle_openai_error[RateLimitError-Rate limit exceeded] took 0.01 seconds
2024-10-25 13:52:59,574 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 13:52:59,574 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 13:52:59,581 - root - INFO - conftest.py:58 - timer - Test test_handle_openai_error[APIError-API error] took 0.01 seconds
2024-10-25 13:52:59,581 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 13:52:59,582 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 13:52:59,588 - root - INFO - conftest.py:58 - timer - Test test_handle_openai_error[APITimeoutError-Request timed out] took 0.01 seconds
2024-10-25 13:52:59,589 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 13:52:59,589 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 13:52:59,595 - root - INFO - conftest.py:58 - timer - Test test_handle_openai_error[APIConnectionError-Connection error] took 0.01 seconds
2024-10-25 13:52:59,598 - root - INFO - conftest.py:58 - timer - Test test_create_test_exception took 0.00 seconds
2024-10-25 13:52:59,865 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 13:53:00,164 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:01,393 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:03,643 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 13:53:04,137 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:07,299 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:10,662 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 13:53:11,388 - root - INFO - pinecone_manager.py:83 - _initialize - Successfully initialized Pinecone index: test-index
2024-10-25 13:53:11,390 - root - INFO - conftest.py:58 - timer - Test test_pinecone_manager_initialization took 11.79 seconds
2024-10-25 13:53:11,837 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 13:53:12,351 - root - INFO - pinecone_manager.py:83 - _initialize - Successfully initialized Pinecone index: test-index
2024-10-25 13:53:12,355 - root - INFO - conftest.py:58 - timer - Test test_upsert_and_search[chunks0-embeddings0] took 0.96 seconds
2024-10-25 13:53:12,702 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 13:53:13,351 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:14,777 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:17,243 - root - INFO - pinecone_manager.py:80 - _initialize - Index test-index already exists. Using existing index.
2024-10-25 13:53:17,637 - root - INFO - pinecone_manager.py:83 - _initialize - Successfully initialized Pinecone index: test-index
2024-10-25 13:53:17,641 - root - INFO - conftest.py:58 - timer - Test test_upsert_and_search[chunks1-embeddings1] took 5.29 seconds
2024-10-25 13:53:18,098 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:19,395 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:21,713 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 13:53:22,115 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:25,313 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 13:53:25,691 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:28,973 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:29,034 - root - INFO - conftest.py:58 - timer - Test test_upsert_and_search[chunks2-embeddings2] took 11.39 seconds
2024-10-25 13:53:29,269 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 13:53:29,784 - root - INFO - pinecone_manager.py:83 - _initialize - Successfully initialized Pinecone index: test-index
2024-10-25 13:53:29,788 - root - INFO - conftest.py:58 - timer - Test test_get_or_create_embeddings took 0.75 seconds
2024-10-25 13:53:29,958 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:31,195 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 13:53:31,383 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:33,557 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 13:53:34,094 - root - INFO - pinecone_manager.py:83 - _initialize - Successfully initialized Pinecone index: test-index
2024-10-25 13:53:34,096 - root - INFO - conftest.py:58 - timer - Test test_clear_index took 4.31 seconds
2024-10-25 13:53:34,576 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 13:53:35,448 - root - INFO - pinecone_manager.py:83 - _initialize - Successfully initialized Pinecone index: test-index
2024-10-25 13:53:35,462 - root - WARNING - pinecone_manager.py:127 - clear_index - Pinecone index is not available. Skipping clear operation.
2024-10-25 13:53:35,462 - root - INFO - conftest.py:58 - timer - Test test_error_handling took 1.37 seconds
2024-10-25 13:53:35,862 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 13:53:36,298 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:37,462 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:39,688 - root - INFO - pinecone_manager.py:80 - _initialize - Index test-index already exists. Using existing index.
2024-10-25 13:53:39,897 - root - INFO - pinecone_manager.py:83 - _initialize - Successfully initialized Pinecone index: test-index
2024-10-25 13:53:39,899 - root - INFO - conftest.py:58 - timer - Test test_batch_operation[1] took 4.44 seconds
2024-10-25 13:53:40,190 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 13:53:40,772 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:41,882 - root - INFO - pinecone_manager.py:80 - _initialize - Index test-index already exists. Using existing index.
2024-10-25 13:53:42,296 - root - INFO - pinecone_manager.py:83 - _initialize - Successfully initialized Pinecone index: test-index
2024-10-25 13:53:42,298 - root - INFO - conftest.py:58 - timer - Test test_batch_operation[10] took 2.40 seconds
2024-10-25 13:53:42,593 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: test-index
2024-10-25 13:53:43,008 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:44,322 - root - ERROR - pinecone_manager.py:92 - _initialize - Unexpected error initializing Pinecone: Simulated Pinecone error
2024-10-25 13:53:46,509 - root - INFO - pinecone_manager.py:80 - _initialize - Index test-index already exists. Using existing index.
2024-10-25 13:53:47,002 - root - INFO - pinecone_manager.py:83 - _initialize - Successfully initialized Pinecone index: test-index
2024-10-25 13:53:47,007 - root - INFO - conftest.py:58 - timer - Test test_batch_operation[100] took 4.71 seconds
2024-10-25 13:53:47,014 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:53:47,016 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:53:47,016 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:53:47,868 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:53:47,870 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:53:48,131 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:53:48,131 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:53:48,135 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x15dfb6f20>, 'json_data': {'input': ['Test Test Test Test Test Test Test Test Test Test Test Test Test Test Test try_out try_out try_out try_out try_out try_out try_out try_out try_out try_out try_out try_out try_out try_out try_out trial_run trial_run trial_run trial_run trial_run trial_run trial_run trial_run trial_run trial_run trial_run trial_run trial_run trial_run trial_run query query query query query query query query query query query query query query query interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry'], 'model': 'text-embedding-3-small', 'encoding_format': 'base64'}}
2024-10-25 13:53:48,136 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-25 13:53:48,137 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.started
2024-10-25 13:53:48,137 - httpcore.connection - DEBUG - _trace.py:45 - trace - close.complete
2024-10-25 13:53:48,137 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-25 13:53:48,172 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x162114b30>
2024-10-25 13:53:48,173 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.started ssl_context=<ssl.SSLContext object at 0x10d2f7b50> server_hostname='api.openai.com' timeout=5.0
2024-10-25 13:53:48,215 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x162117680>
2024-10-25 13:53:48,215 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-25 13:53:48,216 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-25 13:53:48,216 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-25 13:53:48,216 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-25 13:53:48,216 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-25 13:53:48,500 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 25 Oct 2024 12:53:48 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-3-small'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'57'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999809'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'2ms'), (b'x-request-id', b'req_e15b09327b632e08cd6032a83e5829b0'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d825a011ab0e3b1-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-25 13:53:48,501 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-25 13:53:48,501 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-25 13:53:48,502 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-25 13:53:48,502 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-25 13:53:48,502 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-25 13:53:48,503 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers({'date': 'Fri, 25 Oct 2024 12:53:48 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-allow-origin': '*', 'access-control-expose-headers': 'X-Request-ID', 'openai-model': 'text-embedding-3-small', 'openai-organization': 'uinside', 'openai-processing-ms': '57', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '5000000', 'x-ratelimit-remaining-requests': '9999', 'x-ratelimit-remaining-tokens': '4999809', 'x-ratelimit-reset-requests': '6ms', 'x-ratelimit-reset-tokens': '2ms', 'x-request-id': 'req_e15b09327b632e08cd6032a83e5829b0', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d825a011ab0e3b1-LIS', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-25 13:53:48,503 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_e15b09327b632e08cd6032a83e5829b0
2024-10-25 13:53:49,406 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 13:53:49,410 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[1] took 2.40 seconds
2024-10-25 13:53:49,414 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:53:49,415 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:53:49,415 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:53:49,702 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:53:49,704 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:53:50,193 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:53:50,193 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:53:51,153 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 13:53:51,156 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[2] took 1.74 seconds
2024-10-25 13:53:51,160 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 13:53:51,161 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 13:53:51,161 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 13:53:51,499 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 13:53:51,500 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 13:53:51,796 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 13:53:51,797 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 13:53:52,717 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 13:53:52,718 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[3] took 1.56 seconds
2024-10-25 13:53:52,720 - root - INFO - conftest.py:58 - timer - Test test_generate_answer took 0.00 seconds
2024-10-25 13:53:52,721 - root - INFO - rag.py:67 - rag_query - Processing query: Test query
2024-10-25 13:53:52,722 - root - ERROR - rag.py:76 - rag_query - Error in rag_query: 'BookDataInterface' object has no attribute 'get_relevant_chunks'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 69, in rag_query
    relevant_chunks = book_data.get_relevant_chunks(question)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'BookDataInterface' object has no attribute 'get_relevant_chunks'
2024-10-25 13:53:52,758 - root - INFO - conftest.py:58 - timer - Test test_rag_query took 0.04 seconds
2024-10-25 13:53:52,759 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[Short query] took 0.00 seconds
2024-10-25 13:53:52,759 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[A very long query that contains multiple sentences and specific terms] took 0.00 seconds
2024-10-25 13:53:52,760 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[] took 0.00 seconds
2024-10-25 13:53:52,760 - root - INFO - rag.py:67 - rag_query - Processing query: Test query
2024-10-25 13:53:52,760 - root - ERROR - rag.py:76 - rag_query - Error in rag_query: 'BookDataInterface' object has no attribute 'get_relevant_chunks'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 69, in rag_query
    relevant_chunks = book_data.get_relevant_chunks(question)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'BookDataInterface' object has no attribute 'get_relevant_chunks'
2024-10-25 13:53:52,761 - root - INFO - conftest.py:58 - timer - Test test_rag_query_performance took 0.00 seconds
2024-10-25 13:53:52,761 - root - INFO - rag.py:67 - rag_query - Processing query: Test query
2024-10-25 13:53:52,761 - root - ERROR - rag.py:76 - rag_query - Error in rag_query: 'BookDataInterface' object has no attribute 'get_relevant_chunks'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 69, in rag_query
    relevant_chunks = book_data.get_relevant_chunks(question)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'BookDataInterface' object has no attribute 'get_relevant_chunks'
2024-10-25 13:53:52,764 - root - INFO - conftest.py:58 - timer - Test test_rag_error_handling took 0.00 seconds
2024-10-25 13:53:52,764 - root - ERROR - rag.py:63 - generate_answer - Error in generate_answer: Test error
2024-10-25 13:53:52,765 - root - INFO - conftest.py:58 - timer - Test test_generate_answer_error_handling[Exception-Test error] took 0.00 seconds
2024-10-25 13:53:52,765 - root - INFO - text_processing.py:75 - load_and_preprocess_text - Preprocessing text content
2024-10-25 13:53:52,917 - root - INFO - text_processing.py:81 - load_and_preprocess_text - Extracted 0 dates, 0 named entities, and 5 key phrases from the text
2024-10-25 13:53:52,917 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 300, overlap: 150)
2024-10-25 13:53:52,917 - root - INFO - text_processing.py:103 - split_into_chunks - Created 1 chunks
2024-10-25 13:53:52,918 - root - INFO - conftest.py:58 - timer - Test test_load_and_preprocess_text took 0.15 seconds
2024-10-25 13:53:52,918 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 100, overlap: 20)
2024-10-25 13:53:52,918 - root - INFO - text_processing.py:103 - split_into_chunks - Created 13 chunks
2024-10-25 13:53:52,918 - root - INFO - conftest.py:58 - timer - Test test_split_into_chunks[100-20] took 0.00 seconds
2024-10-25 13:53:52,919 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 200, overlap: 50)
2024-10-25 13:53:52,919 - root - INFO - text_processing.py:103 - split_into_chunks - Created 7 chunks
2024-10-25 13:53:52,919 - root - INFO - conftest.py:58 - timer - Test test_split_into_chunks[200-50] took 0.00 seconds
2024-10-25 13:53:52,919 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 500, overlap: 100)
2024-10-25 13:53:52,919 - root - INFO - text_processing.py:103 - split_into_chunks - Created 3 chunks
2024-10-25 13:53:52,920 - root - INFO - conftest.py:58 - timer - Test test_split_into_chunks[500-100] took 0.00 seconds
2024-10-25 13:53:52,920 - root - INFO - text_processing.py:93 - split_into_chunks - Splitting text into chunks (size: 100, overlap: 20)
2024-10-25 13:53:52,920 - root - INFO - text_processing.py:103 - split_into_chunks - Created 13 chunks
2024-10-25 13:53:52,920 - root - INFO - conftest.py:58 - timer - Test test_split_into_chunks_with_dict_input took 0.00 seconds
2024-10-25 14:20:13,268 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 14:20:13,269 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 14:20:13,275 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 14:20:13,276 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 14:20:13,285 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 14:20:13,660 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 14:20:13,661 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 14:20:13,938 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 14:20:13,938 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 14:20:14,120 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 14:20:14,206 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[1] took 0.08 seconds
2024-10-25 14:20:14,211 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[2] took 0.00 seconds
2024-10-25 14:20:14,244 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[3] took 0.03 seconds
2024-10-25 14:20:14,245 - root - INFO - conftest.py:58 - timer - Test test_generate_answer took 0.00 seconds
2024-10-25 14:20:14,246 - root - INFO - rag.py:68 - rag_query - Processing query: Test question
2024-10-25 14:20:14,246 - root - INFO - conftest.py:58 - timer - Test test_rag_query took 0.00 seconds
2024-10-25 14:20:14,246 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[Short query] took 0.00 seconds
2024-10-25 14:20:14,247 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[A very long query that contains multiple sentences and specific terms] took 0.00 seconds
2024-10-25 14:20:14,247 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[] took 0.00 seconds
2024-10-25 14:20:14,247 - root - INFO - rag.py:68 - rag_query - Processing query: Test query
2024-10-25 14:20:14,248 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 14:20:14,248 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 14:20:14,248 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 14:20:14,566 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 14:20:14,567 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 14:20:14,832 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 14:20:14,832 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 14:20:15,848 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 14:20:15,921 - root - INFO - conftest.py:58 - timer - Test test_rag_query_performance took 1.67 seconds
2024-10-25 14:20:15,922 - root - INFO - rag.py:68 - rag_query - Processing query: Test query
2024-10-25 14:20:15,922 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 14:20:15,922 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 14:20:15,922 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 14:20:16,251 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 14:20:16,252 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 14:20:16,470 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 14:20:16,470 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 14:20:17,424 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 14:20:17,425 - root - ERROR - rag.py:76 - rag_query - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 73, in rag_query
    answer = openai_service.generate_answer(question, context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 14:20:17,430 - root - INFO - conftest.py:58 - timer - Test test_rag_error_handling took 1.51 seconds
2024-10-25 14:20:17,431 - root - ERROR - rag.py:64 - generate_answer - Error in generate_answer: Test error
2024-10-25 14:20:17,432 - root - INFO - conftest.py:58 - timer - Test test_generate_answer_error_handling[Exception-Test error] took 0.00 seconds
2024-10-25 14:20:17,433 - root - INFO - rag.py:68 - rag_query - Processing query: Test question
2024-10-25 14:20:17,433 - root - ERROR - rag.py:76 - rag_query - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 70, in rag_query
    search = get_search_strategy(search_strategy, book_data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 14:20:17,433 - root - INFO - conftest.py:58 - timer - Test test_rag_query_error_handling took 0.00 seconds
2024-10-25 14:21:44,597 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 14:21:44,598 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 14:21:44,605 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 14:21:44,606 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 14:21:44,614 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 14:21:44,940 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 14:21:44,943 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 14:21:45,199 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 14:21:45,199 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 14:21:45,404 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 14:21:45,418 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 14:21:46,716 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.30 seconds
2024-10-25 14:21:46,800 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.08 seconds
2024-10-25 14:21:46,802 - root - ERROR - search.py:54 - search - Error in hybrid search: Test error
2024-10-25 14:21:46,802 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.00 seconds
2024-10-25 14:21:46,805 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 14:21:46,808 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 14:21:46,809 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 14:21:46,809 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 14:21:46,831 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.02 seconds
2024-10-25 14:21:46,832 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 14:22:48,436 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 14:22:48,437 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 14:22:48,445 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 14:22:48,445 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 14:22:48,452 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 14:22:48,749 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 14:22:48,755 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 14:22:48,988 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 14:22:48,989 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 14:22:49,203 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 14:22:49,217 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 14:22:50,510 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.29 seconds
2024-10-25 14:22:50,595 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.08 seconds
2024-10-25 14:22:50,596 - root - ERROR - search.py:54 - search - Error in hybrid search: Test error
2024-10-25 14:22:50,596 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.00 seconds
2024-10-25 14:22:50,599 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 14:22:50,601 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 14:22:50,602 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 14:22:50,602 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 14:22:50,625 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.02 seconds
2024-10-25 14:22:50,626 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 14:22:54,340 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 14:22:54,341 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 14:22:54,347 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 14:22:54,347 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 14:22:54,351 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 14:22:54,779 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 14:22:54,782 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 14:22:55,085 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 14:22:55,085 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 14:22:55,260 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 14:22:55,372 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[1] took 0.10 seconds
2024-10-25 14:22:55,409 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[2] took 0.04 seconds
2024-10-25 14:22:55,414 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[3] took 0.00 seconds
2024-10-25 14:22:55,415 - root - INFO - conftest.py:58 - timer - Test test_generate_answer took 0.00 seconds
2024-10-25 14:22:55,416 - root - INFO - rag.py:68 - rag_query - Processing query: Test question
2024-10-25 14:22:55,416 - root - INFO - conftest.py:58 - timer - Test test_rag_query took 0.00 seconds
2024-10-25 14:22:55,417 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[Short query] took 0.00 seconds
2024-10-25 14:22:55,417 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[A very long query that contains multiple sentences and specific terms] took 0.00 seconds
2024-10-25 14:22:55,418 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[] took 0.00 seconds
2024-10-25 14:22:55,418 - root - INFO - rag.py:68 - rag_query - Processing query: Test query
2024-10-25 14:22:55,419 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 14:22:55,419 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 14:22:55,419 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 14:22:55,712 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 14:22:55,713 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 14:22:55,962 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 14:22:55,963 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 14:22:56,964 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 14:22:57,074 - root - INFO - conftest.py:58 - timer - Test test_rag_query_performance took 1.66 seconds
2024-10-25 14:22:57,075 - root - INFO - rag.py:68 - rag_query - Processing query: Test query
2024-10-25 14:22:57,075 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 14:22:57,075 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 14:22:57,075 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 14:22:57,418 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 14:22:57,420 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 14:22:57,669 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 14:22:57,670 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 14:22:58,653 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 14:22:58,654 - root - ERROR - rag.py:76 - rag_query - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 73, in rag_query
    answer = openai_service.generate_answer(question, context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 14:22:58,665 - root - INFO - conftest.py:58 - timer - Test test_rag_error_handling took 1.59 seconds
2024-10-25 14:22:58,668 - root - ERROR - rag.py:64 - generate_answer - Error in generate_answer: Test error
2024-10-25 14:22:58,668 - root - INFO - conftest.py:58 - timer - Test test_generate_answer_error_handling[Exception-Test error] took 0.00 seconds
2024-10-25 14:22:58,670 - root - INFO - rag.py:68 - rag_query - Processing query: Test question
2024-10-25 14:22:58,670 - root - ERROR - rag.py:76 - rag_query - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 70, in rag_query
    search = get_search_strategy(search_strategy, book_data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 14:22:58,671 - root - INFO - conftest.py:58 - timer - Test test_rag_query_error_handling took 0.00 seconds
2024-10-25 14:25:56,281 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 14:25:56,282 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 14:25:56,289 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 14:25:56,289 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 14:25:56,298 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 14:25:57,362 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 14:25:57,367 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 14:25:57,854 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 14:25:57,855 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 14:25:58,590 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 14:25:58,604 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 14:25:59,905 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.30 seconds
2024-10-25 14:25:59,989 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.08 seconds
2024-10-25 14:25:59,990 - root - ERROR - search.py:54 - search - Error in hybrid search: Test error
2024-10-25 14:25:59,990 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.00 seconds
2024-10-25 14:25:59,993 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 14:25:59,996 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 14:25:59,996 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 14:25:59,997 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 14:26:00,020 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.02 seconds
2024-10-25 14:26:00,021 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 14:41:28,805 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 14:41:28,808 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 14:41:28,815 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 14:41:28,815 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 14:41:28,823 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 14:41:29,208 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 14:41:29,209 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 14:41:29,508 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 14:41:29,508 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 14:41:29,734 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 14:41:29,845 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.10 seconds
2024-10-25 14:41:29,847 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 0.00 seconds
2024-10-25 14:41:29,849 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.00 seconds
2024-10-25 14:41:31,258 - root - ERROR - search.py:54 - search - Error in hybrid search: Test error
2024-10-25 14:41:31,258 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 1.41 seconds
2024-10-25 14:41:31,262 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 14:41:31,264 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 14:41:31,267 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 14:41:31,270 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 14:41:31,276 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 14:41:31,276 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 14:43:14,944 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 14:43:14,946 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 14:43:14,953 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 14:43:14,953 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 14:43:14,961 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 14:43:15,411 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 14:43:15,413 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 14:43:15,678 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 14:43:15,679 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 14:43:15,874 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 14:43:15,980 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.09 seconds
2024-10-25 14:43:15,982 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 0.00 seconds
2024-10-25 14:43:15,989 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.01 seconds
2024-10-25 14:43:17,281 - root - ERROR - search.py:54 - search - Error in hybrid search: Test error
2024-10-25 14:43:17,281 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 1.29 seconds
2024-10-25 14:43:17,285 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 14:43:17,287 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 14:43:17,289 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 14:43:17,292 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 14:43:17,297 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 14:43:17,298 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 14:44:51,683 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 14:44:51,684 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 14:44:51,691 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 14:44:51,691 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 14:44:51,699 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 14:44:52,120 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 14:44:52,122 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 14:44:52,616 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 14:44:52,616 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 14:44:52,822 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 14:44:52,836 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 14:44:54,186 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.35 seconds
2024-10-25 14:44:54,187 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.00 seconds
2024-10-25 14:44:54,188 - root - ERROR - search.py:54 - search - Error in hybrid search: Test error
2024-10-25 14:44:54,189 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.00 seconds
2024-10-25 14:44:54,252 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.06 seconds
2024-10-25 14:44:54,255 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 14:44:54,255 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 14:44:54,256 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 14:44:54,257 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 14:44:54,257 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 14:45:26,270 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 14:45:26,271 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 14:45:26,278 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 14:45:26,278 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 14:45:26,286 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 14:45:26,651 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 14:45:26,654 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 14:45:28,950 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 14:45:28,950 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 14:45:29,215 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 14:45:29,228 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 14:45:30,598 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.37 seconds
2024-10-25 14:45:30,599 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.00 seconds
2024-10-25 14:45:30,600 - root - ERROR - search.py:54 - search - Error in hybrid search: Test error
2024-10-25 14:45:30,600 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.00 seconds
2024-10-25 14:45:30,666 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.07 seconds
2024-10-25 14:45:30,668 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 14:45:30,669 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 14:45:30,669 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 14:45:30,670 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 14:45:30,670 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 14:47:36,009 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 14:47:36,010 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 14:47:36,017 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 14:47:36,017 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 14:47:36,025 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 14:47:36,779 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 14:47:36,782 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 14:47:37,497 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 14:47:37,497 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 14:47:37,789 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 14:47:37,803 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 14:47:39,105 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.30 seconds
2024-10-25 14:47:39,106 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.00 seconds
2024-10-25 14:47:39,107 - root - ERROR - search.py:54 - search - Error in hybrid search: Test error
2024-10-25 14:47:39,107 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.00 seconds
2024-10-25 14:47:39,171 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.06 seconds
2024-10-25 14:47:39,173 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 14:47:39,174 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 14:47:39,175 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 14:47:39,175 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 14:47:39,176 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 14:48:05,585 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 14:48:05,586 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 14:48:05,593 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 14:48:05,593 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 14:48:05,600 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 14:48:05,971 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 14:48:05,972 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 14:48:06,431 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 14:48:06,432 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 14:48:06,776 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 14:48:06,787 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 14:48:08,112 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.32 seconds
2024-10-25 14:48:08,113 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.00 seconds
2024-10-25 14:48:08,114 - root - ERROR - search.py:54 - search - Error in hybrid search: Test error
2024-10-25 14:48:08,114 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.00 seconds
2024-10-25 14:48:08,178 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.06 seconds
2024-10-25 14:48:08,180 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 14:48:08,181 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 14:48:08,182 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 14:48:08,185 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 14:48:08,185 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 14:56:10,943 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 14:56:10,944 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 14:56:10,951 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 14:56:10,951 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 14:56:10,959 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 14:56:11,433 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 14:56:11,434 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 14:56:13,716 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 14:56:13,717 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 14:56:14,730 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 14:56:14,743 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 14:56:16,227 - root - ERROR - search.py:50 - search - Error in hybrid search: 'HybridSearch' object has no attribute 'bm25'
2024-10-25 14:56:16,291 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.55 seconds
2024-10-25 14:56:16,292 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.00 seconds
2024-10-25 14:56:16,292 - root - ERROR - search.py:50 - search - Error in hybrid search: 'HybridSearch' object has no attribute 'bm25'
2024-10-25 14:56:16,292 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.00 seconds
2024-10-25 14:56:16,294 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 14:56:16,295 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 14:56:16,299 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 14:56:16,304 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.01 seconds
2024-10-25 14:56:16,310 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 14:56:16,310 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 15:00:54,053 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 15:00:54,054 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 15:00:54,062 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:00:54,062 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:00:54,070 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:00:54,472 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:00:54,473 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:00:54,973 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:00:54,974 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:00:55,324 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 15:00:55,338 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 15:00:56,866 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.53 seconds
2024-10-25 15:00:56,867 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.00 seconds
2024-10-25 15:00:56,868 - root - ERROR - search.py:61 - search - Error in hybrid search: Test error
2024-10-25 15:00:56,869 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.00 seconds
2024-10-25 15:00:56,870 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 15:00:56,871 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 15:00:56,872 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 15:00:56,872 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 15:00:56,873 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 15:00:56,874 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 15:01:09,924 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 15:01:09,925 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 15:01:09,931 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:01:09,931 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:01:09,935 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:01:10,262 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:01:10,262 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:01:10,902 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:01:10,903 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:01:11,141 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 15:01:11,252 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[1] took 0.10 seconds
2024-10-25 15:01:11,254 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[2] took 0.00 seconds
2024-10-25 15:01:11,256 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[3] took 0.00 seconds
2024-10-25 15:01:11,256 - root - INFO - conftest.py:58 - timer - Test test_generate_answer took 0.00 seconds
2024-10-25 15:01:11,258 - root - INFO - rag.py:68 - rag_query - Processing query: Test question
2024-10-25 15:01:11,258 - root - INFO - conftest.py:58 - timer - Test test_rag_query took 0.00 seconds
2024-10-25 15:01:11,259 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[Short query] took 0.00 seconds
2024-10-25 15:01:11,259 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[A very long query that contains multiple sentences and specific terms] took 0.00 seconds
2024-10-25 15:01:11,259 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[] took 0.00 seconds
2024-10-25 15:01:11,260 - root - INFO - rag.py:68 - rag_query - Processing query: Test query
2024-10-25 15:01:11,260 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:01:11,260 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:01:11,260 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:01:11,653 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:01:11,655 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:01:12,096 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:01:12,097 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:01:13,157 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:01:13,267 - root - INFO - conftest.py:58 - timer - Test test_rag_query_performance took 2.01 seconds
2024-10-25 15:01:13,268 - root - INFO - rag.py:68 - rag_query - Processing query: Test query
2024-10-25 15:01:13,268 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:01:13,268 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:01:13,268 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:01:13,780 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:01:13,782 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:01:14,187 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:01:14,187 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:01:15,024 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:01:15,025 - root - ERROR - rag.py:76 - rag_query - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 73, in rag_query
    answer = openai_service.generate_answer(question, context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:01:15,034 - root - INFO - conftest.py:58 - timer - Test test_rag_error_handling took 1.77 seconds
2024-10-25 15:01:15,035 - root - ERROR - rag.py:64 - generate_answer - Error in generate_answer: Test error
2024-10-25 15:01:15,036 - root - INFO - conftest.py:58 - timer - Test test_generate_answer_error_handling[Exception-Test error] took 0.00 seconds
2024-10-25 15:01:15,037 - root - INFO - rag.py:68 - rag_query - Processing query: Test question
2024-10-25 15:01:15,037 - root - ERROR - rag.py:76 - rag_query - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 70, in rag_query
    search = get_search_strategy(search_strategy, book_data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:01:15,038 - root - INFO - conftest.py:58 - timer - Test test_rag_query_error_handling took 0.00 seconds
2024-10-25 15:04:46,626 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 15:04:46,627 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 15:04:46,634 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:04:46,634 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:04:46,641 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:04:47,051 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:04:47,053 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:04:47,350 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:04:47,350 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:04:47,844 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 15:04:49,363 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:04:49,364 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:04:49,364 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:04:49,672 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:04:49,674 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:04:49,913 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:04:49,914 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:04:49,918 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x120a3fb00>, 'json_data': {'input': ['Test Test Test Test Test Test Test Test Test Test Test Test Test Test Test trial trial trial trial trial trial trial trial trial trial trial trial trial trial trial trial_run trial_run trial_run trial_run trial_run trial_run trial_run trial_run trial_run trial_run trial_run trial_run trial_run trial_run trial_run test test test test test test test test test test test test test test test tryout tryout tryout tryout tryout tryout tryout tryout tryout tryout tryout tryout tryout tryout tryout mental_test mental_test mental_test mental_test mental_test mental_test mental_test mental_test mental_test mental_test mental_test mental_test mental_testing mental_testing mental_testing mental_testing mental_testing mental_testing mental_testing mental_testing mental_testing mental_testing mental_testing mental_testing mental_testing psychometric_test psychometric_test psychometric_test psychometric_test psychometric_test psychometric_test psychometric_test psychometric_test psychometric_test psychometric_test psychometric_test psychometric_test examination examination examination examination examination examination examination examination examination examination examination examination examination examination examination exam exam exam exam exam exam exam exam exam exam exam exam exam exam exam run run run run run run run run run run run run run prove prove prove prove prove prove prove prove prove prove try try try try try try try try try try try try try try_out try_out try_out try_out try_out try_out try_out try_out try_out try_out examine examine examine examine examine examine examine examine examine examine examine examine essay essay essay essay essay essay essay essay essay essay essay essay essay essay essay screen screen screen screen screen screen screen screen screen screen screen screen screen screen screen quiz quiz quiz quiz quiz quiz quiz quiz quiz quiz quiz quiz quiz quiz quiz query query query query query query query query query query query query query query query question question question question question question question question question question question question question question question inquiry inquiry inquiry inquiry inquiry inquiry inquiry inquiry inquiry inquiry inquiry inquiry inquiry inquiry inquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation'], 'model': 'text-embedding-3-small', 'encoding_format': 'base64'}}
2024-10-25 15:04:49,965 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-25 15:04:49,966 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-25 15:04:50,019 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x1275a3e00>
2024-10-25 15:04:50,019 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.started ssl_context=<ssl.SSLContext object at 0x1205e1c50> server_hostname='api.openai.com' timeout=5.0
2024-10-25 15:04:50,059 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x1275a3d40>
2024-10-25 15:04:50,060 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-25 15:04:50,060 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-25 15:04:50,060 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-25 15:04:50,061 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-25 15:04:50,061 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-25 15:04:50,509 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 25 Oct 2024 14:04:50 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-3-small'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'90'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999353'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'7ms'), (b'x-request-id', b'req_362a15c42e8ceb79d021935db26bc3a3'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=_3VuFzkOcJoHqH7TCNqD2w15BEaNHoZFunFc0iU90rA-1729865090-1.0.1.1-_Uc39dQlxUJHLQmcQCbzZWi78dUU8WKT6mu3bUYiMlzXV1W7SuQmIDRNjXLj9k4b_X5so_xwxrECnbkWqQtQPw; path=/; expires=Fri, 25-Oct-24 14:34:50 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=hCrrK9HNyYIsA0uZzQKmS0y4izs8LHjG61PNcU5lK8Y-1729865090541-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d82c20da9604899-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-25 15:04:50,510 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-25 15:04:50,510 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-25 15:04:50,510 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-25 15:04:50,510 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-25 15:04:50,510 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-25 15:04:50,510 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers([('date', 'Fri, 25 Oct 2024 14:04:50 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-allow-origin', '*'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-model', 'text-embedding-3-small'), ('openai-organization', 'uinside'), ('openai-processing-ms', '90'), ('openai-version', '2020-10-01'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '5000000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '4999353'), ('x-ratelimit-reset-requests', '6ms'), ('x-ratelimit-reset-tokens', '7ms'), ('x-request-id', 'req_362a15c42e8ceb79d021935db26bc3a3'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=_3VuFzkOcJoHqH7TCNqD2w15BEaNHoZFunFc0iU90rA-1729865090-1.0.1.1-_Uc39dQlxUJHLQmcQCbzZWi78dUU8WKT6mu3bUYiMlzXV1W7SuQmIDRNjXLj9k4b_X5so_xwxrECnbkWqQtQPw; path=/; expires=Fri, 25-Oct-24 14:34:50 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=hCrrK9HNyYIsA0uZzQKmS0y4izs8LHjG61PNcU5lK8Y-1729865090541-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d82c20da9604899-LIS'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-25 15:04:50,511 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_362a15c42e8ceb79d021935db26bc3a3
2024-10-25 15:04:51,474 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:04:51,487 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[1] took 3.63 seconds
2024-10-25 15:04:51,494 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:04:51,494 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:04:51,494 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:04:51,835 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:04:51,837 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:04:52,327 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:04:52,327 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:04:53,261 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:04:53,269 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[2] took 1.78 seconds
2024-10-25 15:04:53,273 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:04:53,273 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:04:53,274 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:04:53,588 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:04:53,589 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:04:54,459 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:04:54,460 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:04:55,331 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:04:55,342 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[3] took 2.07 seconds
2024-10-25 15:04:55,345 - root - INFO - conftest.py:58 - timer - Test test_generate_answer took 0.00 seconds
2024-10-25 15:04:55,348 - root - INFO - rag.py:68 - rag_query - Processing query: Test question
2024-10-25 15:04:55,349 - root - INFO - conftest.py:58 - timer - Test test_rag_query took 0.00 seconds
2024-10-25 15:04:55,350 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[Short query] took 0.00 seconds
2024-10-25 15:04:55,351 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[A very long query that contains multiple sentences and specific terms] took 0.00 seconds
2024-10-25 15:04:55,352 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[] took 0.00 seconds
2024-10-25 15:04:55,354 - root - INFO - rag.py:68 - rag_query - Processing query: Test query
2024-10-25 15:04:55,354 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:04:55,355 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:04:55,355 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:04:55,681 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:04:55,681 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:04:56,059 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:04:56,060 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:04:56,883 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:04:56,991 - root - INFO - conftest.py:58 - timer - Test test_rag_query_performance took 1.64 seconds
2024-10-25 15:04:56,993 - root - INFO - rag.py:68 - rag_query - Processing query: Test query
2024-10-25 15:04:56,994 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:04:56,994 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:04:56,994 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:04:57,576 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:04:57,578 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:04:58,905 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:04:58,905 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:04:59,696 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:04:59,697 - root - ERROR - rag.py:76 - rag_query - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 73, in rag_query
    answer = openai_service.generate_answer(question, context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:04:59,702 - root - INFO - conftest.py:58 - timer - Test test_rag_error_handling took 2.71 seconds
2024-10-25 15:04:59,705 - root - ERROR - rag.py:64 - generate_answer - Error in generate_answer: Test error
2024-10-25 15:04:59,705 - root - INFO - conftest.py:58 - timer - Test test_generate_answer_error_handling[Exception-Test error] took 0.00 seconds
2024-10-25 15:04:59,708 - root - INFO - rag.py:68 - rag_query - Processing query: Test question
2024-10-25 15:04:59,708 - root - ERROR - rag.py:76 - rag_query - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 70, in rag_query
    search = get_search_strategy(search_strategy, book_data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:04:59,803 - root - INFO - conftest.py:58 - timer - Test test_rag_query_error_handling took 0.10 seconds
2024-10-25 15:05:46,530 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 15:05:46,531 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 15:05:46,538 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:05:46,538 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:05:46,546 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:05:46,902 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:05:46,905 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:05:49,268 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:05:49,268 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:05:50,089 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 15:05:51,602 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:05:51,602 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:05:51,602 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:05:52,161 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:05:52,162 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:05:52,973 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:05:52,974 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:05:53,850 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:05:53,862 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[1] took 3.76 seconds
2024-10-25 15:05:53,867 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:05:53,867 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:05:53,868 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:05:55,174 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:05:55,175 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:05:57,572 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:05:57,573 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:05:58,399 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:05:58,409 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[2] took 4.55 seconds
2024-10-25 15:05:58,414 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:05:58,415 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:05:58,415 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:05:59,602 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:05:59,603 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:06:00,103 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:06:00,104 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:06:00,940 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:06:00,945 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[3] took 2.53 seconds
2024-10-25 15:06:00,947 - root - INFO - conftest.py:58 - timer - Test test_generate_answer took 0.00 seconds
2024-10-25 15:06:00,949 - root - INFO - rag.py:68 - rag_query - Processing query: Test question
2024-10-25 15:06:00,949 - root - INFO - conftest.py:58 - timer - Test test_rag_query took 0.00 seconds
2024-10-25 15:06:00,950 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[Short query] took 0.00 seconds
2024-10-25 15:06:00,951 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[A very long query that contains multiple sentences and specific terms] took 0.00 seconds
2024-10-25 15:06:00,952 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[] took 0.00 seconds
2024-10-25 15:06:00,953 - root - INFO - rag.py:68 - rag_query - Processing query: Test query
2024-10-25 15:06:00,953 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:06:00,954 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:06:00,954 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:06:01,498 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:06:01,500 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:06:01,804 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:06:01,805 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:06:02,643 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:06:02,752 - root - INFO - conftest.py:58 - timer - Test test_rag_query_performance took 1.80 seconds
2024-10-25 15:06:02,754 - root - INFO - rag.py:68 - rag_query - Processing query: Test query
2024-10-25 15:06:02,754 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:06:02,755 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:06:02,755 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:06:03,275 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:06:03,276 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:06:03,755 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:06:03,756 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:06:04,562 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:06:04,562 - root - ERROR - rag.py:76 - rag_query - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 73, in rag_query
    answer = openai_service.generate_answer(question, context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:06:04,666 - root - INFO - conftest.py:58 - timer - Test test_rag_error_handling took 1.91 seconds
2024-10-25 15:06:04,667 - root - ERROR - rag.py:64 - generate_answer - Error in generate_answer: Test error
2024-10-25 15:06:04,667 - root - INFO - conftest.py:58 - timer - Test test_generate_answer_error_handling[Exception-Test error] took 0.00 seconds
2024-10-25 15:06:04,668 - root - INFO - rag.py:68 - rag_query - Processing query: Test question
2024-10-25 15:06:04,668 - root - ERROR - rag.py:76 - rag_query - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 70, in rag_query
    search = get_search_strategy(search_strategy, book_data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:06:04,668 - root - INFO - conftest.py:58 - timer - Test test_rag_query_error_handling took 0.00 seconds
2024-10-25 15:13:25,314 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 15:13:25,315 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 15:13:25,322 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:13:25,322 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:13:25,333 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:13:25,802 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:13:25,804 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:13:26,125 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:13:26,125 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:13:26,371 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 15:15:39,392 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 15:15:39,393 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 15:15:39,400 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:15:39,400 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:15:39,408 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:15:39,787 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:15:39,790 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:15:41,653 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:15:41,654 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:15:41,895 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 15:15:43,414 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:15:43,414 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:15:43,414 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:15:44,080 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:15:44,081 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:15:44,352 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:15:44,353 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:15:45,407 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:15:45,422 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[1] took 3.51 seconds
2024-10-25 15:15:45,427 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:15:45,428 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:15:45,428 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:15:45,888 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:15:45,889 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:15:46,236 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:15:46,236 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:15:47,122 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:15:47,130 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[2] took 1.71 seconds
2024-10-25 15:15:47,135 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:15:47,136 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:15:47,136 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:15:47,508 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:15:47,509 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:15:48,691 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:15:48,691 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:15:49,602 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:15:49,613 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[3] took 2.48 seconds
2024-10-25 15:15:49,615 - root - INFO - conftest.py:58 - timer - Test test_generate_answer took 0.00 seconds
2024-10-25 15:15:49,618 - root - INFO - rag.py:66 - rag_query - Processing query: Test question
2024-10-25 15:15:49,619 - root - INFO - conftest.py:58 - timer - Test test_rag_query took 0.00 seconds
2024-10-25 15:15:49,620 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[Short query] took 0.00 seconds
2024-10-25 15:15:49,622 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[A very long query that contains multiple sentences and specific terms] took 0.00 seconds
2024-10-25 15:15:49,623 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[] took 0.00 seconds
2024-10-25 15:15:49,624 - root - INFO - rag.py:66 - rag_query - Processing query: Test query
2024-10-25 15:15:49,625 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:15:49,625 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:15:49,626 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:15:49,925 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:15:49,926 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:15:50,672 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:15:50,672 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:15:51,548 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:15:51,664 - root - INFO - conftest.py:58 - timer - Test test_rag_query_performance took 2.04 seconds
2024-10-25 15:15:51,666 - root - INFO - rag.py:66 - rag_query - Processing query: Test query
2024-10-25 15:15:51,666 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:15:51,667 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:15:51,667 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:15:51,997 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:15:51,998 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:15:52,530 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:15:52,531 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:15:53,429 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:15:53,430 - root - ERROR - error_handler.py:17 - wrapper - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 70, in rag_query
    return openai_service.generate_answer(question, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:15:53,436 - root - INFO - conftest.py:58 - timer - Test test_rag_error_handling took 1.77 seconds
2024-10-25 15:15:53,439 - root - ERROR - error_handler.py:17 - wrapper - Error in generate_answer: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 62, in generate_answer
    return openai_service.generate_answer(query, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:15:53,440 - root - INFO - conftest.py:58 - timer - Test test_generate_answer_error_handling[Exception-Test error] took 0.00 seconds
2024-10-25 15:15:53,442 - root - INFO - rag.py:66 - rag_query - Processing query: Test question
2024-10-25 15:15:53,442 - root - ERROR - error_handler.py:17 - wrapper - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 67, in rag_query
    search = get_search_strategy(search_strategy, book_data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:15:53,443 - root - INFO - conftest.py:58 - timer - Test test_rag_query_error_handling took 0.00 seconds
2024-10-25 15:16:30,642 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 15:16:30,643 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 15:16:30,691 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:16:30,697 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:16:30,707 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:16:31,043 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:16:31,045 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:16:31,298 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:16:31,298 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:16:31,752 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 15:16:31,759 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 15:16:33,294 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.53 seconds
2024-10-25 15:16:33,295 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.00 seconds
2024-10-25 15:16:33,297 - root - ERROR - search.py:61 - search - Error in hybrid search: Test error
2024-10-25 15:16:33,297 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.00 seconds
2024-10-25 15:16:33,299 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 15:16:33,300 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 15:16:33,300 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 15:16:33,301 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 15:16:33,302 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 15:16:33,302 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 15:24:40,895 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 15:24:40,896 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 15:24:40,904 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:24:40,905 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:24:40,913 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:24:41,315 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:24:41,319 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:24:41,580 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:24:41,581 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:24:41,782 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 15:24:41,793 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 15:24:43,323 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.53 seconds
2024-10-25 15:24:43,324 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.00 seconds
2024-10-25 15:24:43,325 - root - ERROR - search.py:61 - search - Error in hybrid search: Test error
2024-10-25 15:24:43,325 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.00 seconds
2024-10-25 15:24:43,327 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 15:24:43,328 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 15:24:43,328 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 15:24:43,329 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 15:24:43,330 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 15:24:43,330 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 15:24:51,182 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 15:24:51,183 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 15:24:51,190 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:24:51,190 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:24:51,197 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:24:51,497 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:24:51,497 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:24:51,775 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:24:51,775 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:24:52,053 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 15:24:53,685 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:24:53,686 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:24:53,686 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:24:54,014 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:24:54,015 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:24:54,391 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:24:54,392 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:24:55,386 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:24:55,391 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[1] took 3.33 seconds
2024-10-25 15:24:55,395 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:24:55,395 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:24:55,395 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:24:55,684 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:24:55,684 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:24:55,949 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:24:55,950 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:24:56,859 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:24:56,864 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[2] took 1.47 seconds
2024-10-25 15:24:56,867 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:24:56,868 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:24:56,868 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:24:57,177 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:24:57,177 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:24:57,534 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:24:57,534 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:24:58,397 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:24:58,405 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[3] took 1.54 seconds
2024-10-25 15:24:58,408 - root - INFO - conftest.py:58 - timer - Test test_generate_answer took 0.00 seconds
2024-10-25 15:24:58,411 - root - INFO - rag.py:67 - rag_query - Processing query: Test question
2024-10-25 15:24:58,412 - root - INFO - conftest.py:58 - timer - Test test_rag_query took 0.00 seconds
2024-10-25 15:24:58,413 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[Short query] took 0.00 seconds
2024-10-25 15:24:58,414 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[A very long query that contains multiple sentences and specific terms] took 0.00 seconds
2024-10-25 15:24:58,415 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[] took 0.00 seconds
2024-10-25 15:24:58,416 - root - INFO - rag.py:67 - rag_query - Processing query: Test query
2024-10-25 15:24:58,417 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:24:58,418 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:24:58,418 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:24:58,738 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:24:58,739 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:24:58,966 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:24:58,966 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:24:59,819 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:24:59,908 - root - INFO - conftest.py:58 - timer - Test test_rag_query_performance took 1.49 seconds
2024-10-25 15:24:59,911 - root - INFO - rag.py:67 - rag_query - Processing query: Test query
2024-10-25 15:24:59,911 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:24:59,911 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:24:59,911 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:25:00,235 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:25:00,236 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:25:00,491 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:25:00,491 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:25:01,417 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:25:01,418 - root - ERROR - error_handler.py:17 - wrapper - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 71, in rag_query
    return openai_service.generate_answer(question, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:25:01,424 - root - INFO - conftest.py:58 - timer - Test test_rag_error_handling took 1.51 seconds
2024-10-25 15:25:01,426 - root - ERROR - error_handler.py:17 - wrapper - Error in generate_answer: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 63, in generate_answer
    return openai_service.generate_answer(query, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:25:01,428 - root - INFO - conftest.py:58 - timer - Test test_generate_answer_error_handling[Exception-Test error] took 0.00 seconds
2024-10-25 15:25:01,430 - root - INFO - rag.py:67 - rag_query - Processing query: Test question
2024-10-25 15:25:01,430 - root - ERROR - error_handler.py:17 - wrapper - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 68, in rag_query
    search = get_search_strategy(search_strategy, book_data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:25:01,432 - root - INFO - conftest.py:58 - timer - Test test_rag_query_error_handling took 0.00 seconds
2024-10-25 15:25:51,610 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 15:25:51,611 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 15:25:51,618 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:25:51,618 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:25:51,628 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:25:51,928 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:25:51,930 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:25:52,183 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:25:52,183 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:25:52,399 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 15:25:53,957 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:25:53,958 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:25:53,958 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:25:54,367 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:25:54,367 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:25:54,632 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:25:54,633 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:25:55,525 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:25:55,538 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[1] took 3.13 seconds
2024-10-25 15:25:55,543 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:25:55,544 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:25:55,544 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:25:55,837 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:25:55,838 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:25:56,135 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:25:56,135 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:25:56,948 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:25:56,958 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[2] took 1.42 seconds
2024-10-25 15:25:56,963 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:25:56,964 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:25:56,964 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:25:57,259 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:25:57,261 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:25:57,540 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:25:57,541 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:25:58,433 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:25:58,437 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[3] took 1.48 seconds
2024-10-25 15:25:58,439 - root - INFO - conftest.py:58 - timer - Test test_generate_answer took 0.00 seconds
2024-10-25 15:25:58,440 - root - INFO - rag.py:67 - rag_query - Processing query: Test question
2024-10-25 15:25:58,441 - root - INFO - conftest.py:58 - timer - Test test_rag_query took 0.00 seconds
2024-10-25 15:25:58,441 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[Short query] took 0.00 seconds
2024-10-25 15:25:58,442 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[A very long query that contains multiple sentences and specific terms] took 0.00 seconds
2024-10-25 15:25:58,442 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[] took 0.00 seconds
2024-10-25 15:25:58,443 - root - INFO - rag.py:67 - rag_query - Processing query: Test query
2024-10-25 15:25:58,443 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:25:58,444 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:25:58,444 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:25:58,792 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:25:58,793 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:25:59,162 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:25:59,162 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:26:00,029 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:26:00,134 - root - INFO - conftest.py:58 - timer - Test test_rag_query_performance took 1.69 seconds
2024-10-25 15:26:00,137 - root - INFO - rag.py:67 - rag_query - Processing query: Test query
2024-10-25 15:26:00,138 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:26:00,138 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:26:00,138 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:26:00,490 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:26:00,491 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:26:00,845 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:26:00,845 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:26:01,709 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:26:01,710 - root - ERROR - error_handler.py:17 - wrapper - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 71, in rag_query
    return openai_service.generate_answer(question, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:26:01,715 - root - INFO - conftest.py:58 - timer - Test test_rag_error_handling took 1.58 seconds
2024-10-25 15:26:01,717 - root - ERROR - error_handler.py:17 - wrapper - Error in generate_answer: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 63, in generate_answer
    return openai_service.generate_answer(query, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:26:01,717 - root - INFO - conftest.py:58 - timer - Test test_generate_answer_error_handling[Exception-Test error] took 0.00 seconds
2024-10-25 15:26:01,719 - root - INFO - rag.py:67 - rag_query - Processing query: Test question
2024-10-25 15:26:01,719 - root - ERROR - error_handler.py:17 - wrapper - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 68, in rag_query
    search = get_search_strategy(search_strategy, book_data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:26:01,719 - root - INFO - conftest.py:58 - timer - Test test_rag_query_error_handling took 0.00 seconds
2024-10-25 15:26:38,019 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 15:26:38,020 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 15:26:38,026 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:26:38,027 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:26:38,034 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:26:38,351 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:26:38,356 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:26:40,775 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:26:40,776 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:26:41,153 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 15:26:41,165 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 15:26:42,752 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.59 seconds
2024-10-25 15:26:42,753 - root - ERROR - error_handler.py:17 - wrapper - Error in get_search_strategy: Unknown search strategy: unknown
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 131, in get_search_strategy
    raise ValueError(f"Unknown search strategy: {strategy}")
ValueError: Unknown search strategy: unknown
2024-10-25 15:26:42,816 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.06 seconds
2024-10-25 15:26:42,818 - root - ERROR - error_handler.py:17 - wrapper - Error in _create_weighted_query_embedding: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 116, in _create_weighted_query_embedding
    return create_embeddings([weighted_query])[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:26:42,819 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: could not convert string to float: 'Sorry, I encountered an error while processing your request: Test error'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 95, in _get_embedding_scores
    return np.array([cosine_similarity(query_embedding, chunk_embedding) for chunk_embedding in self.embeddings])
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/embedding.py", line 72, in cosine_similarity
    a = np.array(a, dtype=np.float64)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'Sorry, I encountered an error while processing your request: Test error'
2024-10-25 15:26:42,820 - root - ERROR - error_handler.py:17 - wrapper - Error in _combine_scores: 'str' object has no attribute 'min'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 121, in _combine_scores
    embedding_scores = (embedding_scores - embedding_scores.min()) / (embedding_scores.max() - embedding_scores.min() + 1e-8)
                                           ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'min'
2024-10-25 15:26:42,820 - root - ERROR - search.py:68 - search - Error in hybrid search: could not convert string to float: 'S'
2024-10-25 15:26:42,820 - root - ERROR - error_handler.py:17 - wrapper - Error in search: could not convert string to float: 'S'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 66, in search
    return self._get_top_chunks(combined_scores, top_k)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 32, in _get_top_chunks
    return [{'chunk': self.chunks[i], 'score': float(scores[i])} for i in top_indices]
                                               ^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'S'
2024-10-25 15:26:42,822 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.01 seconds
2024-10-25 15:26:42,824 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 15:26:42,825 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 15:26:42,825 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 15:26:42,826 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 15:26:42,826 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 15:26:42,827 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 15:32:22,899 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 15:32:22,901 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 15:32:22,908 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:32:22,908 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:32:22,916 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:32:23,567 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:32:23,572 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:32:26,602 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:32:26,603 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:32:26,825 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 15:32:26,841 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 15:32:28,352 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.51 seconds
2024-10-25 15:32:28,353 - root - ERROR - error_handler.py:17 - wrapper - Error in get_search_strategy: Unknown search strategy: unknown
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 127, in get_search_strategy
    raise ValueError(f"Unknown search strategy: {strategy}")
ValueError: Unknown search strategy: unknown
2024-10-25 15:32:28,354 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.00 seconds
2024-10-25 15:32:28,355 - root - ERROR - error_handler.py:17 - wrapper - Error in _create_weighted_query_embedding: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 112, in _create_weighted_query_embedding
    return create_embeddings([weighted_query])[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:32:28,356 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: could not convert string to float: 'Sorry, I encountered an error while processing your request: Test error'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 91, in _get_embedding_scores
    return np.array([cosine_similarity(query_embedding, chunk_embedding) for chunk_embedding in self.embeddings])
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/embedding.py", line 72, in cosine_similarity
    a = np.array(a, dtype=np.float64)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'Sorry, I encountered an error while processing your request: Test error'
2024-10-25 15:32:28,357 - root - ERROR - error_handler.py:17 - wrapper - Error in _combine_scores: 'str' object has no attribute 'min'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 117, in _combine_scores
    embedding_scores = (embedding_scores - embedding_scores.min()) / (embedding_scores.max() - embedding_scores.min() + 1e-8)
                                           ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'min'
2024-10-25 15:32:28,357 - root - ERROR - error_handler.py:17 - wrapper - Error in search: could not convert string to float: 'S'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 65, in search
    return self._get_top_chunks(combined_scores, top_k)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 32, in _get_top_chunks
    return [{'chunk': self.chunks[i], 'score': float(scores[i])} for i in top_indices]
                                               ^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'S'
2024-10-25 15:32:28,421 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.07 seconds
2024-10-25 15:32:28,423 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 15:32:28,424 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 15:32:28,424 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 15:32:28,425 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 15:32:28,425 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 15:32:28,426 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 15:32:28,426 - root - INFO - conftest.py:58 - timer - Test test_simple_search_error_handling took 0.00 seconds
2024-10-25 15:32:28,426 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search_error_handling took 0.00 seconds
2024-10-25 15:33:17,428 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 15:33:17,429 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 15:33:17,436 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:33:17,436 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:33:17,445 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:33:17,763 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:33:17,765 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:33:18,072 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:33:18,073 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:33:18,252 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 15:33:19,781 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:33:19,781 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:33:19,781 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:33:20,079 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:33:20,080 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:33:20,319 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:33:20,320 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:33:21,426 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:33:21,435 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[1] took 3.17 seconds
2024-10-25 15:33:21,441 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:33:21,441 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:33:21,441 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:33:21,936 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:33:21,936 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:33:22,272 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:33:22,273 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:33:23,133 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:33:23,141 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[2] took 1.70 seconds
2024-10-25 15:33:23,146 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:33:23,147 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:33:23,147 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:33:23,685 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:33:23,686 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:33:23,983 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:33:23,983 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:33:24,947 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:33:24,955 - root - INFO - conftest.py:58 - timer - Test test_find_most_relevant_chunks[3] took 1.81 seconds
2024-10-25 15:33:24,958 - root - INFO - conftest.py:58 - timer - Test test_generate_answer took 0.00 seconds
2024-10-25 15:33:24,961 - root - INFO - rag.py:67 - rag_query - Processing query: Test question
2024-10-25 15:33:24,962 - root - INFO - conftest.py:58 - timer - Test test_rag_query took 0.00 seconds
2024-10-25 15:33:24,963 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[Short query] took 0.00 seconds
2024-10-25 15:33:24,965 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[A very long query that contains multiple sentences and specific terms] took 0.00 seconds
2024-10-25 15:33:24,966 - root - INFO - conftest.py:58 - timer - Test test_rag_query_with_different_queries[] took 0.00 seconds
2024-10-25 15:33:24,967 - root - INFO - rag.py:67 - rag_query - Processing query: Test query
2024-10-25 15:33:24,968 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:33:24,969 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:33:24,969 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:33:25,441 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:33:25,443 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:33:26,056 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:33:26,056 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:33:26,926 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:33:27,034 - root - INFO - conftest.py:58 - timer - Test test_rag_query_performance took 2.07 seconds
2024-10-25 15:33:27,036 - root - INFO - rag.py:67 - rag_query - Processing query: Test query
2024-10-25 15:33:27,037 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:33:27,037 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:33:27,037 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:33:27,382 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:33:27,383 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:33:29,646 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:33:29,646 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:33:30,465 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:33:30,466 - root - ERROR - error_handler.py:17 - wrapper - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 71, in rag_query
    return openai_service.generate_answer(question, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
src.error_handler.RAGError: Test error
2024-10-25 15:33:30,472 - root - INFO - conftest.py:58 - timer - Test test_rag_error_handling took 3.44 seconds
2024-10-25 15:33:30,474 - root - ERROR - error_handler.py:17 - wrapper - Error in generate_answer: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 63, in generate_answer
    return openai_service.generate_answer(query, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
src.error_handler.RAGError: Test error
2024-10-25 15:33:30,475 - root - INFO - conftest.py:58 - timer - Test test_generate_answer_error_handling[RAGError-Test error] took 0.00 seconds
2024-10-25 15:33:30,477 - root - ERROR - error_handler.py:17 - wrapper - Error in generate_answer: Unexpected error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 63, in generate_answer
    return openai_service.generate_answer(query, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Unexpected error
2024-10-25 15:33:30,478 - root - INFO - conftest.py:58 - timer - Test test_generate_answer_error_handling[Exception-Unexpected error] took 0.00 seconds
2024-10-25 15:33:30,480 - root - INFO - rag.py:67 - rag_query - Processing query: Test question
2024-10-25 15:33:30,481 - root - ERROR - error_handler.py:17 - wrapper - Error in rag_query: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/rag.py", line 68, in rag_query
    search = get_search_strategy(search_strategy, book_data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
src.error_handler.RAGError: Test error
2024-10-25 15:33:30,482 - root - INFO - conftest.py:58 - timer - Test test_rag_query_error_handling took 0.00 seconds
2024-10-25 15:34:01,058 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 15:34:01,059 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 15:34:01,066 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:34:01,066 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:34:01,073 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:34:01,460 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:34:01,462 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:34:02,283 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:34:02,283 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:34:02,564 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 15:34:02,572 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 15:34:04,141 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.57 seconds
2024-10-25 15:34:04,142 - root - ERROR - error_handler.py:17 - wrapper - Error in get_search_strategy: Unknown search strategy: unknown
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 127, in get_search_strategy
    raise ValueError(f"Unknown search strategy: {strategy}")
ValueError: Unknown search strategy: unknown
2024-10-25 15:34:04,144 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.00 seconds
2024-10-25 15:34:04,145 - root - ERROR - error_handler.py:17 - wrapper - Error in _create_weighted_query_embedding: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 112, in _create_weighted_query_embedding
    return create_embeddings([weighted_query])[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:34:04,147 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: could not convert string to float: 'Sorry, I encountered an error while processing your request: Test error'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 91, in _get_embedding_scores
    return np.array([cosine_similarity(query_embedding, chunk_embedding) for chunk_embedding in self.embeddings])
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/embedding.py", line 72, in cosine_similarity
    a = np.array(a, dtype=np.float64)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'Sorry, I encountered an error while processing your request: Test error'
2024-10-25 15:34:04,148 - root - ERROR - error_handler.py:17 - wrapper - Error in _combine_scores: 'str' object has no attribute 'min'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 117, in _combine_scores
    embedding_scores = (embedding_scores - embedding_scores.min()) / (embedding_scores.max() - embedding_scores.min() + 1e-8)
                                           ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'min'
2024-10-25 15:34:04,148 - root - ERROR - error_handler.py:17 - wrapper - Error in search: could not convert string to float: 'S'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 65, in search
    return self._get_top_chunks(combined_scores, top_k)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 32, in _get_top_chunks
    return [{'chunk': self.chunks[i], 'score': float(scores[i])} for i in top_indices]
                                               ^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'S'
2024-10-25 15:34:04,221 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.08 seconds
2024-10-25 15:34:04,223 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 15:34:04,224 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 15:34:04,225 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 15:34:04,225 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 15:34:04,226 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 15:34:04,227 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 15:34:04,228 - root - INFO - conftest.py:58 - timer - Test test_simple_search_error_handling took 0.00 seconds
2024-10-25 15:34:04,229 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search_error_handling took 0.00 seconds
2024-10-25 15:35:30,190 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 15:35:30,191 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 15:35:30,198 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:35:30,199 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:35:30,207 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:35:30,520 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:35:30,520 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:35:30,881 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:35:30,881 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:35:31,753 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 15:35:31,769 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 15:35:33,274 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.50 seconds
2024-10-25 15:35:33,274 - root - ERROR - error_handler.py:17 - wrapper - Error in get_search_strategy: Unknown search strategy: unknown
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 135, in get_search_strategy
    raise ValueError(f"Unknown search strategy: {strategy}")
ValueError: Unknown search strategy: unknown
2024-10-25 15:35:33,275 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.00 seconds
2024-10-25 15:35:33,276 - root - ERROR - error_handler.py:17 - wrapper - Error in _create_weighted_query_embedding: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 115, in _create_weighted_query_embedding
    return create_embeddings([weighted_query])[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:35:33,278 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: could not convert string to float: 'Sorry, I encountered an error while processing your request: Test error'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 94, in _get_embedding_scores
    return np.array([cosine_similarity(query_embedding, chunk_embedding) for chunk_embedding in self.embeddings])
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/embedding.py", line 72, in cosine_similarity
    a = np.array(a, dtype=np.float64)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'Sorry, I encountered an error while processing your request: Test error'
2024-10-25 15:35:33,279 - root - ERROR - error_handler.py:17 - wrapper - Error in _combine_scores: 'str' object has no attribute 'min'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 120, in _combine_scores
    embedding_scores = (embedding_scores - embedding_scores.min()) / (embedding_scores.max() - embedding_scores.min() + 1e-8)
                                           ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'min'
2024-10-25 15:35:33,279 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_top_chunks: could not convert string to float: 'S'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 126, in _get_top_chunks
    return [{'chunk': self.chunks[i], 'score': float(scores[i])} for i in top_indices]
                                               ^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'S'
2024-10-25 15:35:33,342 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.07 seconds
2024-10-25 15:35:33,344 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 15:35:33,345 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 15:35:33,346 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 15:35:33,346 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 15:35:33,347 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 15:35:33,347 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 15:35:33,348 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:35:33,348 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:35:33,348 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:35:34,282 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:35:34,284 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:35:34,577 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:35:34,578 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:35:34,584 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x1450e7a60>, 'json_data': {'input': ['error query'], 'model': 'text-embedding-3-small', 'encoding_format': 'base64'}}
2024-10-25 15:35:34,632 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-25 15:35:34,632 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-25 15:35:34,766 - httpcore.connection - DEBUG - _trace.py:45 - trace - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x14502f440>
2024-10-25 15:35:34,767 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.started ssl_context=<ssl.SSLContext object at 0x11f749c50> server_hostname='api.openai.com' timeout=5.0
2024-10-25 15:35:34,806 - httpcore.connection - DEBUG - _trace.py:45 - trace - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x11f4415b0>
2024-10-25 15:35:34,807 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-25 15:35:34,808 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-25 15:35:34,808 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-25 15:35:34,808 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-25 15:35:34,808 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-25 15:35:35,155 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 25 Oct 2024 14:35:35 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-3-small'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'140'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999998'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'0s'), (b'x-request-id', b'req_acf4eb8d413ef18910e3f221a83f1b90'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=TWa9kkv1fKunfW6Q.3KwIiLTuVla_Kx.cG1cwJfyBMs-1729866935-1.0.1.1-cTzWe6TeO5ELceoB22BSbAU1Zo2y84nwTlaJ6kCQ9W3MHzNHOMAVfhgh1.7PuOiwKjcY.1..dKnM.R0lK3PQsw; path=/; expires=Fri, 25-Oct-24 15:05:35 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=7vsOYdNthk.lwwQyXHbWclTHjzblNPrz.bzFXnLj8yk-1729866935204-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d82ef171f89785c-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-25 15:35:35,157 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-25 15:35:35,158 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-25 15:35:35,159 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-25 15:35:35,159 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-25 15:35:35,159 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-25 15:35:35,159 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers([('date', 'Fri, 25 Oct 2024 14:35:35 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-allow-origin', '*'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-model', 'text-embedding-3-small'), ('openai-organization', 'uinside'), ('openai-processing-ms', '140'), ('openai-version', '2020-10-01'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '5000000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '4999998'), ('x-ratelimit-reset-requests', '6ms'), ('x-ratelimit-reset-tokens', '0s'), ('x-request-id', 'req_acf4eb8d413ef18910e3f221a83f1b90'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=TWa9kkv1fKunfW6Q.3KwIiLTuVla_Kx.cG1cwJfyBMs-1729866935-1.0.1.1-cTzWe6TeO5ELceoB22BSbAU1Zo2y84nwTlaJ6kCQ9W3MHzNHOMAVfhgh1.7PuOiwKjcY.1..dKnM.R0lK3PQsw; path=/; expires=Fri, 25-Oct-24 15:05:35 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=7vsOYdNthk.lwwQyXHbWclTHjzblNPrz.bzFXnLj8yk-1729866935204-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d82ef171f89785c-LIS'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-25 15:35:35,159 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_acf4eb8d413ef18910e3f221a83f1b90
2024-10-25 15:35:36,141 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:35:36,149 - root - ERROR - error_handler.py:17 - wrapper - Error in search: shapes (1536,) and (3,) not aligned: 1536 (dim 0) != 3 (dim 0)
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 38, in search
    scores = np.array([cosine_similarity(query_embedding, chunk_embedding) for chunk_embedding in self.embeddings])
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/embedding.py", line 74, in cosine_similarity
    return np.dot(a, b) / (np.linalg.norm(a) * np.linalg.norm(b))
           ^^^^^^^^^^^^
ValueError: shapes (1536,) and (3,) not aligned: 1536 (dim 0) != 3 (dim 0)
2024-10-25 15:35:36,157 - root - INFO - conftest.py:58 - timer - Test test_simple_search_error_handling took 2.81 seconds
2024-10-25 15:35:36,162 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:35:36,162 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:35:36,163 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:35:36,482 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:35:36,484 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:35:37,147 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:35:37,148 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:35:37,151 - openai._base_client - DEBUG - _base_client.py:446 - _build_request - Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x145016e80>, 'json_data': {'input': ['error error error error error error error error error error error error error error error mistake mistake mistake mistake mistake mistake mistake mistake mistake mistake mistake mistake mistake mistake mistake fault fault fault fault fault fault fault fault fault fault fault fault fault fault fault erroneousness erroneousness erroneousness erroneousness erroneousness erroneousness erroneousness erroneousness erroneousness erroneousness erroneousness erroneousness erroneousness erroneousness erroneousness erroneous_belief erroneous_belief erroneous_belief erroneous_belief erroneous_belief erroneous_belief erroneous_belief erroneous_belief erroneous_belief erroneous_belief erroneous_belief erroneous_belief erroneous_belief erroneous_belief erroneous_belief misplay misplay misplay misplay misplay misplay misplay misplay misplay misplay misplay misplay misplay misplay misplay wrongdoing wrongdoing wrongdoing wrongdoing wrongdoing wrongdoing wrongdoing wrongdoing wrongdoing wrongdoing wrongdoing wrongdoing wrongdoing computer_error computer_error computer_error computer_error computer_error computer_error computer_error computer_error computer_error computer_error computer_error computer_error computer_error computer_error computer_error query query query query query query query query query query query query query query query question question question question question question question question question question question question question question question inquiry inquiry inquiry inquiry inquiry inquiry inquiry inquiry inquiry inquiry inquiry inquiry inquiry inquiry inquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry enquiry interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation interrogation'], 'model': 'text-embedding-3-small', 'encoding_format': 'base64'}}
2024-10-25 15:35:37,153 - openai._base_client - DEBUG - _base_client.py:980 - _request - Sending HTTP Request: POST https://api.openai.com/v1/embeddings
2024-10-25 15:35:37,153 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.started request=<Request [b'POST']>
2024-10-25 15:35:37,154 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_headers.complete
2024-10-25 15:35:37,154 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.started request=<Request [b'POST']>
2024-10-25 15:35:37,154 - httpcore.http11 - DEBUG - _trace.py:45 - trace - send_request_body.complete
2024-10-25 15:35:37,154 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.started request=<Request [b'POST']>
2024-10-25 15:35:37,425 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 25 Oct 2024 14:35:37 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-allow-origin', b'*'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-model', b'text-embedding-3-small'), (b'openai-organization', b'uinside'), (b'openai-processing-ms', b'74'), (b'openai-version', b'2020-10-01'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'5000000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'4999519'), (b'x-ratelimit-reset-requests', b'6ms'), (b'x-ratelimit-reset-tokens', b'5ms'), (b'x-request-id', b'req_8278ed17509c6a3d6fcd7af77533f536'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d82ef25ba80785c-LIS'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-25 15:35:37,427 - httpx - INFO - _client.py:1038 - _send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2024-10-25 15:35:37,427 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.started request=<Request [b'POST']>
2024-10-25 15:35:37,428 - httpcore.http11 - DEBUG - _trace.py:45 - trace - receive_response_body.complete
2024-10-25 15:35:37,429 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.started
2024-10-25 15:35:37,429 - httpcore.http11 - DEBUG - _trace.py:45 - trace - response_closed.complete
2024-10-25 15:35:37,429 - openai._base_client - DEBUG - _base_client.py:1019 - _request - HTTP Response: POST https://api.openai.com/v1/embeddings "200 OK" Headers({'date': 'Fri, 25 Oct 2024 14:35:37 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-allow-origin': '*', 'access-control-expose-headers': 'X-Request-ID', 'openai-model': 'text-embedding-3-small', 'openai-organization': 'uinside', 'openai-processing-ms': '74', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '5000000', 'x-ratelimit-remaining-requests': '9999', 'x-ratelimit-remaining-tokens': '4999519', 'x-ratelimit-reset-requests': '6ms', 'x-ratelimit-reset-tokens': '5ms', 'x-request-id': 'req_8278ed17509c6a3d6fcd7af77533f536', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d82ef25ba80785c-LIS', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-25 15:35:37,429 - openai._base_client - DEBUG - _base_client.py:1027 - _request - request_id: req_8278ed17509c6a3d6fcd7af77533f536
2024-10-25 15:35:38,283 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:35:38,284 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: shapes (1536,) and (3,) not aligned: 1536 (dim 0) != 3 (dim 0)
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 94, in _get_embedding_scores
    return np.array([cosine_similarity(query_embedding, chunk_embedding) for chunk_embedding in self.embeddings])
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/embedding.py", line 74, in cosine_similarity
    return np.dot(a, b) / (np.linalg.norm(a) * np.linalg.norm(b))
           ^^^^^^^^^^^^
ValueError: shapes (1536,) and (3,) not aligned: 1536 (dim 0) != 3 (dim 0)
2024-10-25 15:35:38,286 - root - ERROR - error_handler.py:17 - wrapper - Error in _combine_scores: 'str' object has no attribute 'min'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 120, in _combine_scores
    embedding_scores = (embedding_scores - embedding_scores.min()) / (embedding_scores.max() - embedding_scores.min() + 1e-8)
                                           ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'min'
2024-10-25 15:35:38,287 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_top_chunks: could not convert string to float: 'S'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 126, in _get_top_chunks
    return [{'chunk': self.chunks[i], 'score': float(scores[i])} for i in top_indices]
                                               ^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'S'
2024-10-25 15:35:38,295 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search_error_handling took 2.14 seconds
2024-10-25 15:38:44,927 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 15:38:44,929 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 15:38:44,936 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:38:44,936 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:38:44,945 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:38:45,367 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:38:45,368 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:38:45,657 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:38:45,657 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:38:45,865 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 15:38:45,872 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 15:38:47,524 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 94, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 15:38:47,525 - root - ERROR - error_handler.py:17 - wrapper - Error in _combine_scores: embedding_scores is a string: Sorry, I encountered an error while processing your request: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 122, in _combine_scores
    raise ValueError(f"embedding_scores is a string: {embedding_scores}")
ValueError: embedding_scores is a string: Sorry, I encountered an error while processing your request: 'list' object has no attribute 'shape'
2024-10-25 15:38:47,525 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_top_chunks: could not convert string to float: 'S'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 130, in _get_top_chunks
    return [{'chunk': self.chunks[i], 'score': float(scores[i])} for i in top_indices]
                                               ^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'S'
2024-10-25 15:38:47,588 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.72 seconds
2024-10-25 15:38:47,589 - root - ERROR - error_handler.py:17 - wrapper - Error in get_search_strategy: Unknown search strategy: unknown
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 139, in get_search_strategy
    raise ValueError(f"Unknown search strategy: {strategy}")
ValueError: Unknown search strategy: unknown
2024-10-25 15:38:47,590 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.00 seconds
2024-10-25 15:38:47,591 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 93, in _get_embedding_scores
    query_embedding = self._create_weighted_query_embedding(query)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:38:47,593 - root - ERROR - error_handler.py:17 - wrapper - Error in _combine_scores: embedding_scores is a string: Sorry, I encountered an error while processing your request: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 122, in _combine_scores
    raise ValueError(f"embedding_scores is a string: {embedding_scores}")
ValueError: embedding_scores is a string: Sorry, I encountered an error while processing your request: Test error
2024-10-25 15:38:47,593 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_top_chunks: could not convert string to float: 'S'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 130, in _get_top_chunks
    return [{'chunk': self.chunks[i], 'score': float(scores[i])} for i in top_indices]
                                               ^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'S'
2024-10-25 15:38:47,596 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.01 seconds
2024-10-25 15:38:47,597 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 15:38:47,598 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 15:38:47,598 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 15:38:47,599 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 94, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 15:38:47,601 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 15:38:47,602 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 15:38:47,603 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 15:38:47,603 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:38:47,603 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:38:47,604 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:38:47,886 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:38:47,886 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:38:48,160 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:38:48,160 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:38:49,119 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:38:49,120 - root - ERROR - error_handler.py:17 - wrapper - Error in search: shapes (1536,) and (3,) not aligned: 1536 (dim 0) != 3 (dim 0)
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 38, in search
    scores = np.array([cosine_similarity(query_embedding, chunk_embedding) for chunk_embedding in self.embeddings])
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/embedding.py", line 74, in cosine_similarity
    return np.dot(a, b) / (np.linalg.norm(a) * np.linalg.norm(b))
           ^^^^^^^^^^^^
ValueError: shapes (1536,) and (3,) not aligned: 1536 (dim 0) != 3 (dim 0)
2024-10-25 15:38:49,124 - root - INFO - conftest.py:58 - timer - Test test_simple_search_error_handling took 1.52 seconds
2024-10-25 15:38:49,126 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:38:49,126 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:38:49,126 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:38:49,405 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:38:49,405 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:38:49,666 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:38:49,666 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:38:50,609 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:38:50,609 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 94, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 15:38:50,610 - root - ERROR - error_handler.py:17 - wrapper - Error in _combine_scores: embedding_scores is a string: Sorry, I encountered an error while processing your request: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 122, in _combine_scores
    raise ValueError(f"embedding_scores is a string: {embedding_scores}")
ValueError: embedding_scores is a string: Sorry, I encountered an error while processing your request: 'list' object has no attribute 'shape'
2024-10-25 15:38:50,610 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_top_chunks: could not convert string to float: 'S'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 130, in _get_top_chunks
    return [{'chunk': self.chunks[i], 'score': float(scores[i])} for i in top_indices]
                                               ^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'S'
2024-10-25 15:38:50,613 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search_error_handling took 1.49 seconds
2024-10-25 15:55:33,890 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 15:55:33,891 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 15:55:33,898 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:55:33,898 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:55:33,906 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:55:34,322 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:55:34,323 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:55:34,593 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:55:34,593 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:55:34,806 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 15:55:34,822 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 15:55:36,327 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 94, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 15:55:36,329 - root - ERROR - error_handler.py:17 - wrapper - Error in _combine_scores: embedding_scores is a string: Sorry, I encountered an error while processing your request: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 122, in _combine_scores
    raise ValueError(f"embedding_scores is a string: {embedding_scores}")
ValueError: embedding_scores is a string: Sorry, I encountered an error while processing your request: 'list' object has no attribute 'shape'
2024-10-25 15:55:36,329 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_top_chunks: could not convert string to float: 'S'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 130, in _get_top_chunks
    return [{'chunk': self.chunks[i], 'score': float(scores[i])} for i in top_indices]
                                               ^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'S'
2024-10-25 15:55:36,390 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.57 seconds
2024-10-25 15:55:36,391 - root - ERROR - error_handler.py:17 - wrapper - Error in get_search_strategy: Unknown search strategy: unknown
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 139, in get_search_strategy
    raise ValueError(f"Unknown search strategy: {strategy}")
ValueError: Unknown search strategy: unknown
2024-10-25 15:55:36,391 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.00 seconds
2024-10-25 15:55:36,392 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 93, in _get_embedding_scores
    query_embedding = self._create_weighted_query_embedding(query)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 15:55:36,393 - root - ERROR - error_handler.py:17 - wrapper - Error in _combine_scores: embedding_scores is a string: Sorry, I encountered an error while processing your request: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 122, in _combine_scores
    raise ValueError(f"embedding_scores is a string: {embedding_scores}")
ValueError: embedding_scores is a string: Sorry, I encountered an error while processing your request: Test error
2024-10-25 15:55:36,394 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_top_chunks: could not convert string to float: 'S'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 130, in _get_top_chunks
    return [{'chunk': self.chunks[i], 'score': float(scores[i])} for i in top_indices]
                                               ^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'S'
2024-10-25 15:55:36,396 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.00 seconds
2024-10-25 15:55:36,398 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 15:55:36,399 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 15:55:36,399 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 15:55:36,400 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 94, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 15:55:36,403 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 15:55:36,404 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 15:55:36,405 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 15:55:36,405 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:55:36,405 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:55:36,406 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:55:36,751 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:55:36,752 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:55:37,027 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:55:37,027 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:55:37,985 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:55:37,986 - root - ERROR - error_handler.py:17 - wrapper - Error in search: Vectors have different shapes: (1536,) and (3,)
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 38, in search
    scores = np.array([cosine_similarity(query_embedding, chunk_embedding) for chunk_embedding in self.embeddings])
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/embedding.py", line 82, in cosine_similarity
    raise ValueError(f"Vectors have different shapes: {a.shape} and {b.shape}")
ValueError: Vectors have different shapes: (1536,) and (3,)
2024-10-25 15:55:37,996 - root - INFO - conftest.py:58 - timer - Test test_simple_search_error_handling took 1.59 seconds
2024-10-25 15:55:38,000 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 15:55:38,001 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 15:55:38,001 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 15:55:38,423 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 15:55:38,425 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 15:55:38,662 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 15:55:38,663 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 15:55:39,588 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 15:55:39,589 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 94, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 15:55:39,590 - root - ERROR - error_handler.py:17 - wrapper - Error in _combine_scores: embedding_scores is a string: Sorry, I encountered an error while processing your request: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 122, in _combine_scores
    raise ValueError(f"embedding_scores is a string: {embedding_scores}")
ValueError: embedding_scores is a string: Sorry, I encountered an error while processing your request: 'list' object has no attribute 'shape'
2024-10-25 15:55:39,590 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_top_chunks: could not convert string to float: 'S'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 130, in _get_top_chunks
    return [{'chunk': self.chunks[i], 'score': float(scores[i])} for i in top_indices]
                                               ^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'S'
2024-10-25 15:55:39,598 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search_error_handling took 1.60 seconds
2024-10-25 16:01:37,694 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 16:01:37,695 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 16:01:37,702 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:01:37,702 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:01:37,711 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:01:38,127 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:01:38,133 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:01:39,805 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:01:39,805 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:01:40,572 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 16:01:40,589 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 16:01:42,111 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 94, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 16:01:42,113 - root - ERROR - error_handler.py:17 - wrapper - Error in _combine_scores: embedding_scores is a string: Sorry, I encountered an error while processing your request: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 122, in _combine_scores
    raise ValueError(f"embedding_scores is a string: {embedding_scores}")
ValueError: embedding_scores is a string: Sorry, I encountered an error while processing your request: 'list' object has no attribute 'shape'
2024-10-25 16:01:42,113 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_top_chunks: could not convert string to float: 'S'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 130, in _get_top_chunks
    return [{'chunk': self.chunks[i], 'score': float(scores[i])} for i in top_indices]
                                               ^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'S'
2024-10-25 16:01:42,177 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.59 seconds
2024-10-25 16:01:42,178 - root - ERROR - error_handler.py:17 - wrapper - Error in get_search_strategy: Unknown search strategy: unknown
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 139, in get_search_strategy
    raise ValueError(f"Unknown search strategy: {strategy}")
ValueError: Unknown search strategy: unknown
2024-10-25 16:01:42,178 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.00 seconds
2024-10-25 16:01:42,179 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 93, in _get_embedding_scores
    query_embedding = self._create_weighted_query_embedding(query)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 16:01:42,180 - root - ERROR - error_handler.py:17 - wrapper - Error in _combine_scores: embedding_scores is a string: Sorry, I encountered an error while processing your request: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 122, in _combine_scores
    raise ValueError(f"embedding_scores is a string: {embedding_scores}")
ValueError: embedding_scores is a string: Sorry, I encountered an error while processing your request: Test error
2024-10-25 16:01:42,180 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_top_chunks: could not convert string to float: 'S'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 130, in _get_top_chunks
    return [{'chunk': self.chunks[i], 'score': float(scores[i])} for i in top_indices]
                                               ^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'S'
2024-10-25 16:01:42,182 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.00 seconds
2024-10-25 16:01:42,184 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 16:01:42,185 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 16:01:42,186 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 16:01:42,187 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 94, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 16:01:42,189 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 16:01:42,191 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 16:01:42,192 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 16:01:42,192 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:01:42,192 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:01:42,192 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:01:43,831 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:01:43,832 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:01:47,898 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:01:47,898 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:01:49,244 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:01:49,245 - root - ERROR - error_handler.py:17 - wrapper - Error in search: Vectors have different shapes: (1536,) and (3,)
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 38, in search
    scores = np.array([cosine_similarity(query_embedding, chunk_embedding) for chunk_embedding in self.embeddings])
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/embedding.py", line 82, in cosine_similarity
    raise ValueError(f"Vectors have different shapes: {a.shape} and {b.shape}")
ValueError: Vectors have different shapes: (1536,) and (3,)
2024-10-25 16:01:49,253 - root - INFO - conftest.py:58 - timer - Test test_simple_search_error_handling took 7.06 seconds
2024-10-25 16:01:49,258 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:01:49,258 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:01:49,258 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:01:49,956 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:01:49,957 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:01:50,245 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:01:50,246 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:01:51,133 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:01:51,134 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 94, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 16:01:51,136 - root - ERROR - error_handler.py:17 - wrapper - Error in _combine_scores: embedding_scores is a string: Sorry, I encountered an error while processing your request: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 122, in _combine_scores
    raise ValueError(f"embedding_scores is a string: {embedding_scores}")
ValueError: embedding_scores is a string: Sorry, I encountered an error while processing your request: 'list' object has no attribute 'shape'
2024-10-25 16:01:51,137 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_top_chunks: could not convert string to float: 'S'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 130, in _get_top_chunks
    return [{'chunk': self.chunks[i], 'score': float(scores[i])} for i in top_indices]
                                               ^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'S'
2024-10-25 16:01:51,145 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search_error_handling took 1.89 seconds
2024-10-25 16:02:06,025 - httpx - DEBUG - _config.py:82 - load_ssl_context - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-25 16:02:06,026 - httpx - DEBUG - _config.py:148 - load_ssl_context_verify - load_verify_locations cafile='/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/certifi/cacert.pem'
2024-10-25 16:02:06,032 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:02:06,033 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:02:06,040 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:02:06,449 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:02:06,454 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:02:06,872 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:02:06,872 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:02:07,710 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}'
2024-10-25 16:02:07,725 - root - INFO - conftest.py:58 - timer - Test test_simple_search took 0.00 seconds
2024-10-25 16:02:09,290 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 94, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 16:02:09,291 - root - ERROR - error_handler.py:17 - wrapper - Error in _combine_scores: embedding_scores is a string: Sorry, I encountered an error while processing your request: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 122, in _combine_scores
    raise ValueError(f"embedding_scores is a string: {embedding_scores}")
ValueError: embedding_scores is a string: Sorry, I encountered an error while processing your request: 'list' object has no attribute 'shape'
2024-10-25 16:02:09,291 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_top_chunks: could not convert string to float: 'S'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 130, in _get_top_chunks
    return [{'chunk': self.chunks[i], 'score': float(scores[i])} for i in top_indices]
                                               ^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'S'
2024-10-25 16:02:09,353 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search took 1.63 seconds
2024-10-25 16:02:09,354 - root - ERROR - error_handler.py:17 - wrapper - Error in get_search_strategy: Unknown search strategy: unknown
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 139, in get_search_strategy
    raise ValueError(f"Unknown search strategy: {strategy}")
ValueError: Unknown search strategy: unknown
2024-10-25 16:02:09,354 - root - INFO - conftest.py:58 - timer - Test test_get_search_strategy took 0.00 seconds
2024-10-25 16:02:09,355 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 93, in _get_embedding_scores
    query_embedding = self._create_weighted_query_embedding(query)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1137, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1141, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1196, in _execute_mock_call
    raise effect
Exception: Test error
2024-10-25 16:02:09,357 - root - ERROR - error_handler.py:17 - wrapper - Error in _combine_scores: embedding_scores is a string: Sorry, I encountered an error while processing your request: Test error
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 122, in _combine_scores
    raise ValueError(f"embedding_scores is a string: {embedding_scores}")
ValueError: embedding_scores is a string: Sorry, I encountered an error while processing your request: Test error
2024-10-25 16:02:09,357 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_top_chunks: could not convert string to float: 'S'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 130, in _get_top_chunks
    return [{'chunk': self.chunks[i], 'score': float(scores[i])} for i in top_indices]
                                               ^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'S'
2024-10-25 16:02:09,359 - root - INFO - conftest.py:58 - timer - Test test_search_error_handling took 0.00 seconds
2024-10-25 16:02:09,361 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[run-expected_expansion0] took 0.00 seconds
2024-10-25 16:02:09,362 - root - INFO - conftest.py:58 - timer - Test test_query_expansion[happy-expected_expansion1] took 0.00 seconds
2024-10-25 16:02:09,362 - root - INFO - conftest.py:58 - timer - Test test_bm25_scores took 0.00 seconds
2024-10-25 16:02:09,363 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 94, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 16:02:09,366 - root - INFO - conftest.py:58 - timer - Test test_embedding_scores took 0.00 seconds
2024-10-25 16:02:09,367 - root - INFO - conftest.py:58 - timer - Test test_combine_scores took 0.00 seconds
2024-10-25 16:02:09,368 - root - INFO - conftest.py:58 - timer - Test test_get_top_chunks took 0.00 seconds
2024-10-25 16:02:09,369 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:02:09,369 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:02:09,369 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:02:10,339 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:02:10,341 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:02:10,933 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:02:10,933 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:02:11,932 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:02:11,933 - root - ERROR - error_handler.py:17 - wrapper - Error in search: Vectors have different shapes: (1536,) and (3,)
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 38, in search
    scores = np.array([cosine_similarity(query_embedding, chunk_embedding) for chunk_embedding in self.embeddings])
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/embedding.py", line 82, in cosine_similarity
    raise ValueError(f"Vectors have different shapes: {a.shape} and {b.shape}")
ValueError: Vectors have different shapes: (1536,) and (3,)
2024-10-25 16:02:11,938 - root - INFO - conftest.py:58 - timer - Test test_simple_search_error_handling took 2.57 seconds
2024-10-25 16:02:11,941 - pinecone_plugin_interface.logging - INFO - discover_namespace_packages.py:12 - discover_subpackages - Discovering subpackages in _NamespacePath(['/Users/eduardizgorodin/Projects/rag_book_assistant/rag_venv/lib/python3.12/site-packages/pinecone_plugins'])
2024-10-25 16:02:11,942 - pinecone_plugin_interface.logging - INFO - discover_plugins.py:9 - discover_plugins - Looking for plugins in pinecone_plugins.inference
2024-10-25 16:02:11,942 - pinecone_plugin_interface.logging - INFO - installation.py:10 - install_plugins - Installing plugin inference into Pinecone
2024-10-25 16:02:12,328 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"indexes":[{"name":"book-embeddings","metric":"cosine","dimension":1536,"status":{"ready":true,"state":"Ready"},"host":"book-embeddings-uoy9ovm.svc.aped-4627-b74a.pinecone.io","spec":{"serverless":{"region":"us-east-1","cloud":"aws"}},"deletion_protection":"disabled"}]}'
2024-10-25 16:02:12,329 - root - INFO - pinecone_manager.py:72 - _initialize - Creating new Pinecone index: book-embeddings
2024-10-25 16:02:14,436 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"error":{"code":"ALREADY_EXISTS","message":"Resource  already exists"},"status":409}'
2024-10-25 16:02:14,437 - root - INFO - pinecone_manager.py:86 - _initialize - Index book-embeddings already exists. Using existing index.
2024-10-25 16:02:15,308 - pinecone.core.openapi.shared.rest - DEBUG - rest.py:264 - request - response body: b'{"upsertedCount":1}'
2024-10-25 16:02:15,309 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_embedding_scores: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 94, in _get_embedding_scores
    if query_embedding.shape != self.embeddings[0].shape:
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'shape'
2024-10-25 16:02:15,311 - root - ERROR - error_handler.py:17 - wrapper - Error in _combine_scores: embedding_scores is a string: Sorry, I encountered an error while processing your request: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 122, in _combine_scores
    raise ValueError(f"embedding_scores is a string: {embedding_scores}")
ValueError: embedding_scores is a string: Sorry, I encountered an error while processing your request: 'list' object has no attribute 'shape'
2024-10-25 16:02:15,312 - root - ERROR - error_handler.py:17 - wrapper - Error in _get_top_chunks: could not convert string to float: 'S'
Traceback (most recent call last):
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/error_handler.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eduardizgorodin/Projects/rag_book_assistant/src/search.py", line 130, in _get_top_chunks
    return [{'chunk': self.chunks[i], 'score': float(scores[i])} for i in top_indices]
                                               ^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'S'
2024-10-25 16:02:15,320 - root - INFO - conftest.py:58 - timer - Test test_hybrid_search_error_handling took 3.38 seconds
